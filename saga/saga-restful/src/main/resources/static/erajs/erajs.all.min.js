/*!
 * erajs v2.1.0 (http://192.168.10.127/docs/erajs/docs/index.html) 
 * Copyright 2014-2016 Erayt, Inc. 
 * Licensed under the MIT license
 *
 * Last update at : 2016-04-15 09:48:31
 * If you have some questions please contact :SCM(chengqiuhua@erayt.com)
 */
var erajs=erajs||{};!function(){var a=this,b=Object.prototype,c=b.toString,d=!0,e={toString:1},f=function(){},g=/\[object\s*(?:Array|Arguments|\w*Collection|\w*List|HTML\s+document\.all\s+class)\]/;Function.prototype.$erajsIsFunction=!0,erajs.global=a;for(i in e)d=null;d&&(d=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]),erajs.enumerables=d,erajs.apply=function(a,b,c){if(c&&erajs.apply(a,c),a&&b&&"object"==typeof b){var e,f,g;for(e in b)a[e]=b[e];if(d)for(f=d.length;f--;)g=d[f],b.hasOwnProperty(g)&&(a[g]=b[g])}return a},erajs.apply(erajs,{name:"erajs",zIndex:9e3,core:{},ui:{},util:{},framework:{},debug:!1,localize:!0,focusValidate:!0,emptyFn:f,identityFn:function(a){return a},emptyString:new String,applyIf:function(a,b){var c;if(a)for(c in b)void 0===a[c]&&(a[c]=b[c]);return a}}),erajs.apply(erajs,{isIterable:function(a){return!a||"number"!=typeof a.length||"string"==typeof a||a.$erajsIsFunction?!1:a.propertyIsEnumerable?a.hasOwnProperty("length")&&!a.propertyIsEnumerable("length")?!0:g.test(c.call(a)):!!a.item},extend:function(){var a=b.constructor,c=function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};return function(b,d,e){erajs.isObject(d)&&(e=d,d=b,b=e.constructor!==a?e.constructor:function(){d.apply(this,arguments)}),d||alert("Attempting to erajsend from a class which has not been loaded on the page.");var f,g=function(){},h=d.prototype;return g.prototype=h,f=b.prototype=new g,f.constructor=b,b.superclass=h,h.constructor===a&&(h.constructor=d),b.override=function(a){erajs.override(b,a)},f.override=c,f.proto=f,b.override(e),b.extend=function(a){return erajs.extend(b,a)},b}}(),override:function(a,b){return"function"==typeof a?erajs.apply(a.prototype,b):erajs.apply(a,b),a}}),erajs.apply(erajs,{isBoolean:function(a){return"boolean"==typeof a},isObject:"[object Object]"===c.call(null)?function(a){return null!==a&&void 0!==a&&"[object Object]"===c.call(a)&&void 0===a.ownerDocument}:function(a){return"[object Object]"===c.call(a)},isEmpty:function(a,b){return null===a||void 0===a||(b?!1:""===a)||erajs.isArray(a)&&0===a.length},isArray:"isArray"in Array?Array.isArray:function(a){return"[object Array]"===c.call(a)},isDate:function(a){return"[object Date]"===c.call(a)},isSimpleObject:function(a){return a instanceof Object&&a.constructor===Object},isPrimitive:function(a){var b=typeof a;return"string"===b||"number"===b||"boolean"===b},isPrimitiveArray:function(a){return 0==a.length||erajs.Array.some(a,function(a){return erajs.isPrimitive(a)})},isFunction:function(a){return!(!a||!a.$erajsIsFunction)},isNumber:function(a){return"number"==typeof a&&isFinite(a)},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isString:function(a){return"string"==typeof a},isBoolean:function(a){return"boolean"==typeof a},isDefined:function(a){return"undefined"!=typeof a},encodeToJsonStr:function(a){return"{"+a+"}"}}),erajs.apply(erajs,{USE_NATIVE_JSON:!1,clone:function(a){var b,e,f,g,h,i;if(null===a||void 0===a)return a;if(a.nodeType&&a.cloneNode)return a.cloneNode(!0);if(b=c.call(a),"[object Date]"===b)return new Date(a.getTime());if("[object Array]"===b)for(e=a.length,h=[];e--;)h[e]=erajs.clone(a[e]);else if("[object Object]"===b&&a.constructor===Object){h={};for(i in a)h[i]=erajs.clone(a[i]);if(d)for(f=d.length;f--;)g=d[f],a.hasOwnProperty(g)&&(h[g]=a[g])}return h||a},functionFactory:function(){var a=Array.prototype.slice.call(arguments);return Function.prototype.constructor.apply(Function.prototype,a)}})}(),window.$$=erajs,erajs.String=function(){var a,b,c,d,e=/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,f=/('|\\)/g,g=/\{(\d+)\}/g,h=/([-.*+?\^${}()|\[\]\/\\])/g,i=/^\s+|\s+$/g,j=/\s+/,k=/(^[^a-z]*|[^\w])/gi,l=function(b,c){return a[c]},m=function(a,c){return c in b?b[c]:String.fromCharCode(parseInt(c.substr(2),10))},n=function(a,b){return null===a||void 0===a||null===b||void 0===b?!1:b.length<=a.length};return{insert:function(a,b,c){if(!a)return b;if(!b)return a;var d=a.length;return c||0===c||(c=d),0>c&&(c*=-1,c=c>=d?0:d-c),0===c?a=b+a:c>=a.length?a+=b:a=a.substr(0,c)+b+a.substr(c),a},startsWith:function(a,b,c){var d=n(a,b);return d&&(c&&(a=a.toLowerCase(),b=b.toLowerCase()),d=0===a.lastIndexOf(b,0)),d},endsWith:function(a,b,c){var d=n(a,b);return d&&(c&&(a=a.toLowerCase(),b=b.toLowerCase()),d=-1!==a.indexOf(b,a.length-b.length)),d},createVarName:function(a){return a.replace(k,"")},htmlEncode:function(a){return a?String(a).replace(c,l):a},htmlDecode:function(a){return a?String(a).replace(d,m):a},addCharacterEntities:function(e){var f,g,h=[],i=[];for(f in e)g=e[f],b[f]=g,a[g]=f,h.push(g),i.push(f);c=new RegExp("("+h.join("|")+")","g"),d=new RegExp("("+i.join("|")+"|&#[0-9]{1,5};)","g")},resetCharacterEntities:function(){a={},b={},this.addCharacterEntities({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'"})},urlAppend:function(a,b){return erajs.isEmpty(b)?a:a+(-1===a.indexOf("?")?"?":"&")+b},trim:function(a){return a.replace(e,"")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},uncapitalize:function(a){return a.charAt(0).toLowerCase()+a.substr(1)},ellipsis:function(a,b,c){if(a&&a.length>b){if(c){var d=a.substr(0,b-2),e=Math.max(d.lastIndexOf(" "),d.lastIndexOf("."),d.lastIndexOf("!"),d.lastIndexOf("?"));if(-1!==e&&e>=b-15)return d.substr(0,e)+"..."}return a.substr(0,b-3)+"..."}return a},escapeRegex:function(a){return a.replace(h,"\\$1")},escape:function(a){return a.replace(f,"\\$1")},toggle:function(a,b,c){return a===b?c:b},leftPad:function(a,b,c){var d=String(a);for(c=c||" ";d.length<b;)d=c+d;return d},format:function(a){var b=erajs.Array.toArray(arguments,1);return a.replace(g,function(a,c){return b[c]})},repeat:function(a,b,c){1>b&&(b=0);for(var d=[],e=b;e--;)d.push(a);return d.join(c||"")},splitWords:function(a){return a&&"string"==typeof a?a.replace(i,"").split(j):a||[]}}}(),erajs.String.resetCharacterEntities(),erajs.htmlEncode=erajs.String.htmlEncode,erajs.htmlDecode=erajs.String.htmlDecode,erajs.urlAppend=erajs.String.urlAppend,erajs.apply(erajs,{userAgent:navigator.userAgent.toLowerCase(),cache:{},idSeed:1e3,windowId:"erajs-window",documentId:"erajs-document",id:function(a,b){var c=this,a=erajs.getDom(a,!0)||{};return a===document?a.id=c.documentId:a===window&&(a.id=c.windowId),a.id||(a.id=(b||"erajs-gen")+ ++erajs.idSeed),a.id},getElementById:function(a){var b=document.getElementById(a);return b},htmlEncode:function(a){return erajs.String.htmlEncode(a)},htmlDecode:function(a){return erajs.String.htmlDecode(a)},urlAppend:function(a,b){return erajs.String.urlAppend(a,b)}}),erajs.ns=erajs.namespace,window.undefined=window.undefined,function(){var a=function(a){return a.test(erajs.userAgent)},b="CSS1Compat"==document.compatMode,c=function(a,b){var c;return a&&(c=b.exec(erajs.userAgent))?parseFloat(c[1]):0},d=document.documentMode,e=a(/opera/),f=e&&a(/version\/10\.5/),g=a(/\bchrome\b/),h=a(/webkit/),i=!g&&a(/safari/),j=i&&a(/applewebkit\/4/),k=i&&a(/version\/3/),l=i&&a(/version\/4/),m=i&&a(/version\/5\.0/),n=i&&a(/version\/5/),o=!e&&a(/msie/),p=o&&(a(/msie 7/)&&8!=d&&9!=d&&10!=d||7==d),q=o&&(a(/msie 8/)&&7!=d&&9!=d&&10!=d||8==d),r=o&&(a(/msie 9/)&&7!=d&&8!=d&&10!=d||9==d),s=o&&(a(/msie 10/)&&7!=d&&8!=d&&9!=d||10==d),t=o&&a(/msie 6/),u=!h&&a(/gecko/),v=u&&a(/rv:1\.9/),w=u&&a(/rv:2\.0/),x=u&&a(/rv:5\./),y=u&&a(/rv:10\./),z=v&&a(/rv:1\.9\.0/),A=v&&a(/rv:1\.9\.1/),B=v&&a(/rv:1\.9\.2/),C=a(/windows|win32/),D=a(/macintosh|mac os x/),E=a(/linux/),F=c(!0,/\bchrome\/(\d+\.\d+)/),G=c(!0,/\bfirefox\/(\d+\.\d+)/),H=c(o,/msie (\d+\.\d+)/),I=c(e,/version\/(\d+\.\d+)/),J=c(i,/version\/(\d+\.\d+)/),K=c(h,/webkit\/(\d+\.\d+)/),L=/^https/i.test(window.location.protocol);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(M){}erajs.apply(erajs,{SSL_SECURE_URL:L&&o?"javascript:''":"about:blank",getDom:function(a,b){if(!a||!document)return null;if(a.dom)return a.dom;if("string"==typeof a){var c=document.getElementById(a);return c&&o&&b?a==c.getAttribute("id")?c:null:c}return a},isStrict:b,isIEQuirks:o&&!b&&(t||p||q||r),isOpera:e,isOpera10_5:f,isWebKit:h,isChrome:g,isSafari:i,isSafari3:k,isSafari4:l,isSafari5:n,isSafari5_0:m,isSafari2:j,isIE:o,isIE6:t,isIE7:p,isIE7m:t||p,isIE7p:o&&!t,isIE8:q,isIE8m:t||p||q,isIE8p:o&&!(t||p),isIE9:r,isIE9m:t||p||q||r,isIE9p:o&&!(t||p||q),isIE10:s,isIE10m:t||p||q||r||s,isIE10p:o&&!(t||p||q||r),isGecko:u,isGecko3:v,isGecko4:w,isGecko5:x,isGecko10:y,isFF3_0:z,isFF3_5:A,isFF3_6:B,isFF4:G>=4&&5>G,isFF5:G>=5&&6>G,isFF10:G>=10&&11>G,isLinux:E,isWindows:C,isMac:D,chromeVersion:F,firefoxVersion:G,ieVersion:H,operaVersion:I,safariVersion:J,webKitVersion:K,isSecure:L,value:function(a,b,c){return erajs.isEmpty(a,c)?b:a},escapeRe:function(a){return a.replace(/([-.*+?\^${}()|\[\]\/\\])/g,"\\$1")},copyTo:function(a,b,c,d){"string"==typeof c&&(c=c.split(/[,;\s]/));var e,f,g=c?c.length:0;for(e=0;g>e;e++)f=c[e],(d||b.hasOwnProperty(f))&&(a[f]=b[f]);return a},partition:function(a,b){var c,d,e=[[],[]],f=a.length;for(c=0;f>c;c++)d=a[c],e[b&&b(d,c,a)||!b&&d?0:1].push(d);return e},invoke:function(a,b){var c,d,e=[],f=Array.prototype.slice.call(arguments,2),g=a.length;for(c=0;g>c;c++)d=a[c],e.push(d&&"function"==typeof d[b]?d[b].apply(d,f):void 0);return e},zip:function(){var a,b,c,d=erajs.partition(arguments,function(a){return"function"!=typeof a}),e=d[0],f=d[1][0],g=erajs.max(erajs.pluck(e,"length")),h=[];for(a=0;g>a;a++)if(h[a]=[],f)h[a]=f.apply(f,erajs.pluck(e,a));else for(b=0,c=e.length;c>b;b++)h[a].push(e[b][a]);return h},toSentence:function(a,b){var c,d,e=a.length;return 1>=e?a[0]:(c=a.slice(0,e-1),d=a[e-1],erajs.util.Format.format("{0} {1} {2}",c.join(", "),b||"and",d))},isFormSetValue:!1,isFormInit:function(){return erajs.isFormSetValue},shouldTriggerUiChangeE:function(a){var b=this;return!b.isFormSetValue||a},customDatePatterns:{YearMonth:"Ym",ISO8601ShortMonth:"Ynd",ISO8601ShortDay:"Ymj",ISO8601Short:"Ymd",ShortDate:"mdY",ISO8601Long:"Ymd His"},validStringDate:function(a,b){var c,d=this,e=$.extend({CurrentFormat:b},d.customDatePatterns);return erajs.Object.each(e,function(b,d){return c=erajs.Date.parse(a,d,!0),c?!1:void 0}),c}})}(),function(){var a,b=erajs.util.Format={},c=/<\/?[^>]+>/gi,d=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,e=/\r?\n/g,f=/^#+$/,g=/[\d,\.#]+/,h=/[^\d\.#]/g,i={};erajs.apply(b,{thousandSeparator:",",decimalSeparator:".",currencyPrecision:2,currencySign:"$",currencyAtEnd:!1,undef:function(a){return void 0!==a?a:""},defaultValue:function(a,b){return void 0!==a&&""!==a?a:b},substr:"b"!="ab".substr(-1)?function(a,b,c){var d=String(a);return 0>b?d.substr(Math.max(d.length+b,0),c):d.substr(b,c)}:function(a,b,c){return String(a).substr(b,c)},lowercase:function(a){return String(a).toLowerCase()},uppercase:function(a){return String(a).toUpperCase()},usMoney:function(a){return b.currency(a,"$",2)},currency:function(a,c,d,e){var f="",g=",0",h=0;for(a-=0,0>a&&(a=-a,f="-"),d=erajs.isDefined(d)?d:b.currencyPrecision,g+=d>0?".":"";d>h;h++)g+="0";return a=b.number(a,g),(e||b.currencyAtEnd)===!0?erajs.String.format("{0}{1}{2}",f,a,c||b.currencySign):erajs.String.format("{0}{1}{2}",f,c||b.currencySign,a)},date:function(a,b){return a?(erajs.isDate(a)||(a=new Date(Date.parse(a))),erajs.Date.dateFormat(a,b||erajs.Date.defaultFormat)):""},dateRenderer:function(a){return function(c){return b.date(c,a)}},stripTags:function(a){return a?String(a).replace(c,""):a},stripScripts:function(a){return a?String(a).replace(d,""):a},fileSize:function(){var a=1024,b=1048576,c=1073741824;return function(d){var e;return e=a>d?1===d?"1 byte":d+" bytes":b>d?Math.round(10*d/a)/10+" KB":c>d?Math.round(10*d/b)/10+" MB":Math.round(10*d/c)/10+" GB"}}(),math:function(){var a={};return function(b,c){return a[c]||(a[c]=erajs.functionFactory("v","return v "+c+";")),a[c](b)}}(),round:function(a,b){var c=Number(a);return"number"==typeof b&&(b=Math.pow(10,b),c=Math.round(a*b)/b),c},number:function(c,d){if(!d)return c;var e=i[d];if(!e){var j,k,l,m,n,o=d,p=b.thousandSeparator,q=b.decimalSeparator,r=0;"/i"==d.substr(d.length-2)?(a||(a=new RegExp("[^\\d\\"+b.decimalSeparator+"]","g")),d=d.substr(0,d.length-2),j=-1!=d.indexOf(p),k=d.replace(a,"").split(q)):(j=-1!=d.indexOf(","),k=d.replace(h,"").split(".")),l=d.replace(g,""),k.length>2||2===k.length&&(r=k[1].length,m=f.test(k[1])),n=["var utilFormat=erajs.util.Format,extNumber=erajs.Number,neg,fnum,parts"+(j?",thousandSeparator,thousands=[],j,n,i":"")+(l?',formatString="'+d+'",formatPattern=/[\\d,\\.#]+/':"")+(m?",trailingZeroes=/\\.?0+$/;":";")+'return function(v){if(typeof v!=="number"&&isNaN(v=extNumber.from(v,NaN)))return"";neg=v<0;',"fnum=erajs.Number.toFixed(Math.abs(v), "+r+");"],j?(r&&(n[n.length]='parts=fnum.split(".");',n[n.length]="fnum=parts[0];"),n[n.length]="if(v>=1000) {",n[n.length]="thousandSeparator=utilFormat.thousandSeparator;thousands.length=0;j=fnum.length;n=fnum.length%3||3;for(i=0;i<j;i+=n){if(i!==0){n=3;}thousands[thousands.length]=fnum.substr(i,n);}fnum=thousands.join(thousandSeparator);}",r&&(n[n.length]="fnum += utilFormat.decimalSeparator+parts[1];")):r&&(n[n.length]='if(utilFormat.decimalSeparator!=="."){parts=fnum.split(".");fnum=parts[0]+utilFormat.decimalSeparator+parts[1];}'),m&&(n[n.length]='fnum=fnum.replace(trailingZeroes,"");'),n[n.length]='if(neg&&fnum!=="'+(r?"0."+erajs.String.repeat("0",r):"0")+'")fnum="-"+fnum;',n[n.length]="return ",n[n.length]=l?"formatString.replace(formatPattern, fnum);":"fnum;",n[n.length]="};",e=i[o]=erajs.functionFactory("erajs",n.join(""))(erajs)}return e(c)},numberRenderer:function(a){return function(c){return b.number(c,a)}},attributes:function(a){if("object"==typeof a){var b,c=[];for(b in a)c.push(b,'="',"style"===b?erajs.DomHelper.generateStyles(a[b]):erajs.htmlEncode(a[b]),'"');a=c.join("")}return a||""},plural:function(a,b,c){return a+" "+(1==a?b:c?c:b+"s")},nl2br:function(a){return erajs.isEmpty(a)?"":a.replace(e,"<br/>")},capitalize:erajs.String.capitalize,ellipsis:erajs.String.ellipsis,format:erajs.String.format,htmlDecode:erajs.String.htmlDecode,htmlEncode:erajs.String.htmlEncode,leftPad:erajs.String.leftPad,trim:erajs.String.trim,parseBox:function(a){if(a=a||0,"number"==typeof a)return{top:a,right:a,bottom:a,left:a};var b=a.split(" "),c=b.length;return 1==c?b[1]=b[2]=b[3]=b[0]:2==c?(b[2]=b[0],b[3]=b[1]):3==c&&(b[3]=b[1]),{top:parseInt(b[0],10)||0,right:parseInt(b[1],10)||0,bottom:parseInt(b[2],10)||0,left:parseInt(b[3],10)||0}},escapeRegex:function(a){return a.replace(/([\-.*+?\^${}()|\[\]\/\\])/g,"\\$1")}})}(),erajs.JSON=new function(){var me=this,encodingFunction,decodingFunction,useNative=null,useHasOwn=!!{}.hasOwnProperty,isNative=function(){return null===useNative&&(useNative=erajs.USE_NATIVE_JSON&&window.JSON&&"[object JSON]"==JSON.toString()),useNative},pad=function(a){return 10>a?"0"+a:a},doDecode=function(json){return eval("("+json+")")},doEncode=function(a,b){return null===a||void 0===a?"null":erajs.isDate(a)?erajs.JSON.encodeDate(a):erajs.isString(a)?erajs.JSON.encodeString(a):"number"==typeof a?isFinite(a)?String(a):"null":erajs.isBoolean(a)?String(a):a.toJSON?a.toJSON():erajs.isArray(a)?encodeArray(a,b):erajs.isObject(a)?encodeObject(a,b):"function"==typeof a?"null":"undefined"},m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","":"\\u000b"},charToReplace=/[\\\"\x00-\x1f\x7f-\uffff]/g,encodeString=function(a){return'"'+a.replace(charToReplace,function(a){var b=m[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},encodeArrayPretty=function(a,b){var c,d=a.length,e=b+"   ",f=","+e,g=["[",e];for(c=0;d>c;c+=1)g.push(erajs.JSON.encodeValue(a[c],e),f);return g[g.length-1]=b+"]",g.join("")},encodeObjectPretty=function(a,b){var c,d,e=b+"   ",f=","+e,g=["{",e];for(c in a)if(d=a[c],!useHasOwn||a.hasOwnProperty(c)){if("function"==typeof d||void 0===d)continue;g.push(erajs.JSON.encodeValue(c)+": "+erajs.JSON.encodeValue(d,e),f)}return g[g.length-1]=b+"}",g.join("")},encodeArray=function(a,b){if(b)return encodeArrayPretty(a,b);var c,d=["[",""],e=a.length;for(c=0;e>c;c+=1)d.push(erajs.JSON.encodeValue(a[c]),",");return d[d.length-1]="]",d.join("")},encodeObject=function(a,b){if(b)return encodeObjectPretty(a,b);var c,d,e=["{",""];for(c in a)if(d=a[c],!useHasOwn||a.hasOwnProperty(c)){if("function"==typeof d||void 0===d)continue;e.push(erajs.JSON.encodeValue(c),":",erajs.JSON.encodeValue(d),",")}return e[e.length-1]="}",e.join("")};me.encodeString=encodeString,me.encodeValue=doEncode,me.encodeDate=function(a){return'"'+a.getFullYear()+"-"+pad(a.getMonth()+1)+"-"+pad(a.getDate())+"T"+pad(a.getHours())+":"+pad(a.getMinutes())+":"+pad(a.getSeconds())+'"'},me.encode=function(a){return encodingFunction||(encodingFunction=isNative()?JSON.stringify:me.encodeValue),encodingFunction(a)},me.decode=function(a,b){decodingFunction||(decodingFunction=isNative()?JSON.parse:doDecode);try{return decodingFunction(a)}catch(c){if(b===!0)return null}}},erajs.encode=erajs.JSON.encode,erajs.decode=erajs.JSON.decode,function(){erajs.util.HashMap=function(a){a=a||{};var b=this,c=a.keyFn;b.initialConfig=a,b.clear(!0),c&&(b.getKey=c)},erajs.util.HashMap.prototype={generajstion:0,map:{},length:0,getCount:function(){return this.length},getData:function(a,b){return void 0===b&&(b=a,a=this.getKey(b)),[a,b]},getKey:function(a){return a.id},add:function(a,b){var c=this;return 1===arguments.length&&(b=a,a=c.getKey(b)),c.containsKey(a)?c.replace(a,b):(c.map[a]=b,++c.length,c.generajstion++,b)},replace:function(a,b){var c,d=this,e=d.map;return 1===arguments.length&&(b=a,a=d.getKey(b)),d.containsKey(a)||d.add(a,b),c=e[a],e[a]=b,d.generajstion++,b},remove:function(a){var b=this.findKey(a);return void 0!==b?this.removeAtKey(b):!1},removeAtKey:function(a){var b,c=this;return c.containsKey(a)?(b=c.map[a],delete c.map[a],--c.length,c.generajstion++,!0):!1},get:function(a){var b=this.map;return b.hasOwnProperty(a)?b[a]:void 0},clear:function(a){var b=this;return(a||b.generajstion)&&(b.map={},b.length=0,b.generajstion=a?0:b.generajstion+1),b},containsKey:function(a){var b=this.map;return b.hasOwnProperty(a)&&void 0!==b[a]},contains:function(a){return this.containsKey(this.findKey(a))},getKeys:function(){return this.getArray(!0)},getValues:function(){return this.getArray(!1)},getArray:function(a){var b,c=[],d=this.map;for(b in d)d.hasOwnProperty(b)&&c.push(a?b:d[b]);return c},each:function(a,b){var c,d=erajs.apply({},this.map),e=this.length;b=b||this;for(c in d)if(d.hasOwnProperty(c)&&a.call(b,c,d[c],e)===!1)break;return this},clone:function(){var a,b=new this.self(this.initialConfig),c=this.map;b.suspendEvents();for(a in c)c.hasOwnProperty(a)&&b.add(a,c[a]);return b.resumeEvents(),b},findKey:function(a){var b,c=this.map;for(b in c)if(c.hasOwnProperty(b)&&c[b]===a)return b;return void 0}}}(),erajs.Number=new function(){var a=this,b="1"!==.9.toFixed(),c=Math;erajs.apply(this,{constrain:function(a,b,c){var d=parseFloat(a);return b>d?b:d>c?c:d},snap:function(b,c,d,e){var f;return void 0===b||d>b?d||0:(c&&(f=b%c,0!==f&&(b-=f,2*f>=c?b+=c:-c>2*f&&(b-=c))),a.constrain(b,d,e))},snapInRange:function(b,c,d,e){var f;return d=d||0,void 0===b||d>b?d:(c&&(f=(b-d)%c)&&(b-=f,f*=2,f>=c&&(b+=c)),void 0!==e&&b>(e=a.snapInRange(e,c,d))&&(b=e),b)},toFixed:b?function(a,b){b=b||0;var d=c.pow(10,b);return(c.round(a*d)/d).toFixed(b)}:function(a,b){return a.toFixed(b)},from:function(a,b){return isFinite(a)&&(a=parseFloat(a)),isNaN(a)?b:a},randomInt:function(a,b){return c.floor(c.random()*(b-a+1)+a)},correctFloat:function(a){return parseFloat(a.toPrecision(14))}}),erajs.num=function(){return a.from.apply(this,arguments)}},function(){function a(a,b){return 0>b?Math.max(0,a.length+b):Math.min(a.length,b)}function b(b,c,d,e){var f,g,h,i,j,k,l=e?e.length:0,m=b.length,n=a(b,c);if(n===m)l&&b.push.apply(b,e);else{if(f=Math.min(d,m-n),g=n+f,h=g+l-f,i=m-g,j=m-f,g>h)for(k=0;i>k;++k)b[h+k]=b[g+k];else if(h>g)for(k=i;k--;)b[h+k]=b[g+k];if(l&&n===j)b.length=j,b.push.apply(b,e);else for(b.length=j+l,k=0;l>k;++k)b[n+k]=e[k]}return b}function c(a,b,c,d){return d&&d.length?0!==b||c?b<a.length?a.splice.apply(a,[b,c].concat(d)):a.push.apply(a,d):a.unshift.apply(a,d):a.splice(b,c),a}function d(a,c,d){return b(a,c,d)}function e(a,b,c){return a.splice(b,c),a}function f(c,d,e){var f=a(c,d),g=c.slice(d,a(c,f+e));return arguments.length<4?b(c,f,e):b(c,f,e,m.call(arguments,3)),g}function g(a){return a.splice.apply(a,m.call(arguments,1))}var h,i,j,k,l=Array.prototype,m=l.slice,n=function(){var a,b=[],c=20;if(!b.splice)return!1;for(;c--;)b.push("A");return b.splice(15,0,"F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F"),a=b.length,b.splice(13,0,"XXX"),a+1!=b.length?!1:!0}(),o="forEach"in l,p="map"in l,q="indexOf"in l,r="every"in l,s="some"in l,t="filter"in l,u=function(){var a=[1,2,3,4,5].sort(function(){return 0});return 1===a[0]&&2===a[1]&&3===a[2]&&4===a[3]&&5===a[4]}(),v=!0;try{"undefined"!=typeof document&&m.call(document.getElementsByTagName("body"))}catch(w){v=!1}i=n?e:d,j=n?c:b,k=n?g:f,h=erajs.Array={each:function(a,b,c,d){a=h.from(a);var e,f=a.length;if(d!==!0){for(e=0;f>e;e++)if(b.call(c||a[e],a[e],e,a)===!1)return e}else for(e=f-1;e>-1;e--)if(b.call(c||a[e],a[e],e,a)===!1)return e;return!0},forEach:o?function(a,b,c){a.forEach(b,c)}:function(a,b,c){for(var d=0,e=a.length;e>d;d++)b.call(c,a[d],d,a)},indexOf:q?function(a,b,c){return l.indexOf.call(a,b,c)}:function(a,b,c){var d,e=a.length;for(d=0>c?Math.max(0,e+c):c||0;e>d;d++)if(a[d]===b)return d;return-1},contains:q?function(a,b){return-1!==l.indexOf.call(a,b)}:function(a,b){var c,d;for(c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1},toArray:function(a,b,c){if(!a||!a.length)return[];if("string"==typeof a&&(a=a.split("")),v)return m.call(a,b||0,c||a.length);var d,e=[];for(b=b||0,c=c?0>c?a.length+c:c:a.length,d=b;c>d;d++)e.push(a[d]);return e},pluck:function(a,b){var c,d,e,f=[];for(c=0,d=a.length;d>c;c++)e=a[c],f.push(e[b]);return f},map:p?function(a,b,c){return a.map(b,c)}:function(a,b,c){for(var d=[],e=0,f=a.length;f>e;e++)d[e]=b.call(c,a[e],e,a);return d},every:r?function(a,b,c){return a.every(b,c)}:function(a,b,c){for(var d=0,e=a.length;e>d;++d)if(!b.call(c,a[d],d,a))return!1;return!0},some:s?function(a,b,c){return a.some(b,c)}:function(a,b,c){for(var d=0,e=a.length;e>d;++d)if(b.call(c,a[d],d,a))return!0;return!1},equals:function(a,b){var c,d=a.length,e=b.length;if(a===b)return!0;if(d!==e)return!1;for(c=0;d>c;++c)if(a[c]!==b[c])return!1;return!0},clean:function(a){for(var b,c=[],d=0,e=a.length;e>d;d++)b=a[d],erajs.isEmpty(b)||c.push(b);return c},unique:function(a){for(var b,c=[],d=0,e=a.length;e>d;d++)b=a[d],-1===h.indexOf(c,b)&&c.push(b);return c},filter:t?function(a,b,c){return a.filter(b,c)}:function(a,b,c){for(var d=[],e=0,f=a.length;f>e;e++)b.call(c,a[e],e,a)&&d.push(a[e]);return d},findBy:function(a,b,c){for(var d=0,e=a.length;e>d;d++)if(b.call(c||a,a[d],d))return a[d];return null},from:function(a,b){if(void 0===a||null===a)return[];if(erajs.isArray(a))return b?m.call(a):a;var c=typeof a;return!a||void 0===a.length||"string"===c||"function"===c&&a.apply?[a]:h.toArray(a)},remove:function(a,b){var c=h.indexOf(a,b);return-1!==c&&i(a,c,1),a},include:function(a,b){h.contains(a,b)||a.push(b)},clone:function(a){return m.call(a)},merge:function(){var a,b,c=m.call(arguments),d=[];for(a=0,b=c.length;b>a;a++)d=d.concat(c[a]);return h.unique(d)},intersect:function(){var a,b,c,d,e,f,g,j,k,l,n,o,p,q=[],r=m.call(arguments);if(!r.length)return q;for(a=r.length,n=e=0;a>n;n++)f=r[n],(!d||f.length<d.length)&&(d=f,e=n);for(d=h.unique(d),i(r,e,1),g=d.length,a=r.length,n=0;g>n;n++){for(j=d[n],l=0,o=0;a>o;o++)for(b=r[o],c=b.length,p=0;c>p;p++)if(k=b[p],j===k){l++;break}l===a&&q.push(j)}return q},difference:function(a,b){var c,d,e,f=m.call(a),g=f.length;for(c=0,e=b.length;e>c;c++)for(d=0;g>d;d++)f[d]===b[c]&&(i(f,d,1),d--,g--);return f},slice:[1,2].slice(1,void 0).length?function(a,b,c){return m.call(a,b,c)}:function(a,b,c){return"undefined"==typeof b?m.call(a):"undefined"==typeof c?m.call(a,b):m.call(a,b,c)},sort:u?function(a,b){return b?a.sort(b):a.sort()}:function(a,b){for(var c,d,e,f,g=a.length,h=0;g>h;h++){for(e=h,d=h+1;g>d;d++)b?(c=b(a[d],a[e]),0>c&&(e=d)):a[d]<a[e]&&(e=d);e!==h&&(f=a[h],a[h]=a[e],a[e]=f)}return a},flatten:function(a){function b(a){var d,e,f;for(d=0,e=a.length;e>d;d++)f=a[d],erajs.isArray(f)?b(f):c.push(f);return c}var c=[];return b(a)},min:function(a,b){var c,d,e,f=a[0];for(c=0,d=a.length;d>c;c++)e=a[c],b?1===b(f,e)&&(f=e):f>e&&(f=e);return f},max:function(a,b){var c,d,e,f=a[0];for(c=0,d=a.length;d>c;c++)e=a[c],b?-1===b(f,e)&&(f=e):e>f&&(f=e);return f},mean:function(a){return a.length>0?h.sum(a)/a.length:void 0},sum:function(a){var b,c,d,e=0;for(b=0,c=a.length;c>b;b++)d=a[b],e+=d;return e},toMap:function(a,b,c){var d={},e=a.length;if(b)if("string"==typeof b)for(;e--;)d[a[e][b]]=e+1;else for(;e--;)d[b.call(c,a[e])]=e+1;else for(;e--;)d[a[e]]=e+1;return d},toValueMap:function(a,b,c){var d={},e=a.length;if(b)if("string"==typeof b)for(;e--;)d[a[e][b]]=a[e];else for(;e--;)d[b.call(c,a[e])]=a[e];else for(;e--;)d[a[e]]=a[e];return d},_replaceSim:b,_spliceSim:f,erase:i,insert:function(a,b,c){return j(a,b,0,c)},replace:j,splice:k,push:function(a){var b,c=arguments.length,d=1;for(void 0===a?a=[]:erajs.isArray(a)||(a=[a]);c>d;d++)b=arguments[d],Array.prototype.push[erajs.isIterajsble(b)?"apply":"call"](a,b);return a}},erajs.each=h.each,h.union=h.merge,erajs.min=h.min,erajs.max=h.max,erajs.sum=h.sum,erajs.mean=h.mean,erajs.flatten=h.flatten,erajs.clean=h.clean,erajs.unique=h.unique,erajs.pluck=h.pluck,erajs.toArray=function(){return h.toArray.apply(h,arguments)}}(),erajs.Function={flexSetter:function(a){return function(b,c){var d,e;if(null===b)return this;if("string"!=typeof b){for(d in b)b.hasOwnProperty(d)&&a.call(this,d,b[d]);if(erajs.enumerajsbles)for(e=erajs.enumerables.length;e--;)d=erajs.enumerables[e],b.hasOwnProperty(d)&&a.call(this,d,b[d])}else a.call(this,b,c);return this}},bind:function(a,b,c,d){if(2===arguments.length)return function(){return a.apply(b,arguments)};var e=a,f=Array.prototype.slice;return function(){var a=c||arguments;return d===!0?(a=f.call(arguments,0),a=a.concat(c)):"number"==typeof d&&(a=f.call(arguments,0),erajs.Array.insert(a,d,c)),e.apply(b||erajs.global,a)}},pass:function(a,b,c){return erajs.isArray(b)||(b=erajs.isIterable(b)?erajs.Array.clone(b):void 0!==b?[b]:[]),function(){var d=[].concat(b);return d.push.apply(d,arguments),a.apply(c||this,d)}},alias:function(a,b){return function(){return a[b].apply(a,arguments)}},clone:function(a){return function(){return a.apply(this,arguments)}},createInterceptor:function(a,b,c,d){return erajs.isFunction(b)?(d=erajs.isDefined(d)?d:null,function(){var e=this,f=arguments;return b.target=e,b.method=a,b.apply(c||e||erajs.global,f)!==!1?a.apply(e||erajs.global,f):d}):a},createDelayed:function(a,b,c,d,e){return(c||d)&&(a=erajs.Function.bind(a,c,d,e)),function(){var c=this,d=Array.prototype.slice.call(arguments);setTimeout(function(){a.apply(c,d)},b)}},defer:function(a,b,c,d,e){return a=erajs.Function.bind(a,c,d,e),b>0?setTimeout(erajs.supports.TimeoutActualLateness?function(){a()}:a,b):(a(),0)},createSequence:function(a,b,c){return b?function(){var d=a.apply(this,arguments);return b.apply(c||this,arguments),d}:a},createBuffered:function(a,b,c,d){var e;return function(){var f=d||Array.prototype.slice.call(arguments,0),g=c||this;e&&clearTimeout(e),e=setTimeout(function(){a.apply(g,f)},b)}},createThrottled:function(a,b,c){var d,e,f,g,h=function(){a.apply(c||this,f),d=erajs.Date.now()};return function(){e=erajs.Date.now()-d,f=arguments,clearTimeout(g),!d||e>=b?h():g=setTimeout(h,b-e)}},interceptBefore:function(a,b,c,d){var e=a[b]||erajs.emptyFn;return a[b]=function(){var a=c.apply(d||this,arguments);return e.apply(this,arguments),a}},interceptAfter:function(a,b,c,d){var e=a[b]||erajs.emptyFn;return a[b]=function(){return e.apply(this,arguments),c.apply(d||this,arguments)}}},erajs.defer=erajs.Function.alias(erajs.Function,"defer"),erajs.pass=erajs.Function.alias(erajs.Function,"pass"),erajs.bind=erajs.Function.alias(erajs.Function,"bind"),function(){var a=function(){},b=erajs.Object={chain:Object.create||function(b){a.prototype=b;var c=new a;return a.prototype=null,c},toQueryObjects:function(a,c,d){var e,f,g=b.toQueryObjects,h=[];if(erajs.isArray(c))for(e=0,f=c.length;f>e;e++)d?h=h.concat(g(a+"["+e+"]",c[e],!0)):h.push({name:a,value:c[e]});else if(erajs.isObject(c))for(e in c)c.hasOwnProperty(e)&&(d?h=h.concat(g(a+"["+e+"]",c[e],!0)):h.push({name:a,value:c[e]}));else h.push({name:a,value:c});return h},toQueryString:function(a,c){var d,e,f,g,h,i=[],j=[];for(d in a)a.hasOwnProperty(d)&&(i=i.concat(b.toQueryObjects(d,a[d],c)));for(e=0,f=i.length;f>e;e++)g=i[e],h=g.value,erajs.isEmpty(h)?h="":erajs.isDate(h)&&(h=erajs.Date.toString(h)),j.push(encodeURIComponent(g.name)+"="+encodeURIComponent(String(h)));return j.join("&")},fromQueryString:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=a.replace(/^\?/,"").split("&"),r={};for(g=0,h=q.length;h>g;g++)if(i=q[g],i.length>0)if(d=i.split("="),e=decodeURIComponent(d[0]),f=void 0!==d[1]?decodeURIComponent(d[1]):"",b){if(l=e.match(/(\[):?([^\]]*)\]/g),m=e.match(/^([^\[]+)/),!m)throw new Error('[erajs.Object.fromQueryString] Malformed query string given, failed parsing name from "'+i+'"');if(e=m[0],n=[],null===l){r[e]=f;continue}for(j=0,k=l.length;k>j;j++)o=l[j],o=2===o.length?"":o.substring(1,o.length-1),n.push(o);for(n.unshift(e),c=r,j=0,k=n.length;k>j;j++)o=n[j],j===k-1?erajs.isArray(c)&&""===o?c.push(f):c[o]=f:((void 0===c[o]||"string"==typeof c[o])&&(p=n[j+1],c[o]=erajs.isNumeric(p)||""===p?[]:{}),c=c[o])}else r.hasOwnProperty(e)?(erajs.isArray(r[e])||(r[e]=[r[e]]),r[e].push(f)):r[e]=f;return r},each:function(a,b,c){for(var d in a)if(a.hasOwnProperty(d)&&b.call(c||a,d,a[d],a)===!1)return},merge:function(a){for(var c,d,e,f,g=1,h=arguments.length,i=b.merge,j=erajs.clone;h>g;g++){c=arguments[g];for(d in c)e=c[d],e&&e.constructor===Object?(f=a[d],f&&f.constructor===Object?i(f,e):a[d]=j(e)):a[d]=e}return a},mergeIf:function(a){for(var b,c,d,e=1,f=arguments.length,g=erajs.clone;f>e;e++){b=arguments[e];for(c in b)c in a||(d=b[c],a[c]=d&&d.constructor===Object?g(d):d)}return a},getKey:function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c;return null},getValues:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c},getKeys:"function"==typeof Object.keys?function(a){return a?Object.keys(a):[]}:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c},getSize:function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},equals:function(){var a=function(a,b){var c;for(c in a)if(a.hasOwnProperty(c)&&a[c]!==b[c])return!1;return!0};return function(b,c){return b===c?!0:b&&c?a(b,c)&&a(c,b):b||c?!1:b===c}}(),classify:function(a){var c,d,e=a,f=[],g={},h=function(){for(var a,b=0,c=f.length;c>b;b++)a=f[b],this[a]=new g[a]};for(c in a)a.hasOwnProperty(c)&&(d=a[c],d&&d.constructor===Object&&(f.push(c),g[c]=b.classify(d)));return h.prototype=e,h}};erajs.merge=erajs.Object.merge,erajs.mergeIf=erajs.Object.mergeIf,erajs.urlEncode=function(){var a=erajs.Array.from(arguments),c="";return"string"==typeof a[1]&&(c=a[1]+"&",a[1]=!1),c+b.toQueryString.apply(b,a)},erajs.urlDecode=function(){return b.fromQueryString.apply(b,arguments)}}(),erajs.Date=new function(){function a(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(g,function(a,c){return b[c]})}var b=this,c=/(\\.)/g,d=/([gGhHisucUOPZ]|MS)/,e=/([djzmnYycU]|MS)/,f=/\\/gi,g=/\{(\d+)\}/g,h=new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/"),i=["var me = this, dt, y, m, d, h, i, s, ms, o, O, z, zz, u, v, W, year, jan4, week1monday, daysInMonth, dayMatched,","def = me.defaults,","from = erajs.Number.from,","results = String(input).match(me.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = me.clearTime(new Date);","y = from(y, from(def.y, dt.getFullYear()));","m = from(m, from(def.m - 1, dt.getMonth()));","dayMatched = d !== undefined;","d = from(d, from(def.d, dt.getDate()));","if (!dayMatched) {","dt.setDate(1);","dt.setMonth(m);","dt.setFullYear(y);","daysInMonth = me.getDaysInMonth(dt);","if (d > daysInMonth) {","d = daysInMonth;","}","}","h  = from(h, from(def.h, dt.getHours()));","i  = from(i, from(def.i, dt.getMinutes()));","s  = from(s, from(def.s, dt.getSeconds()));","ms = from(ms, from(def.ms, dt.getMilliseconds()));","if(z >= 0 && y >= 0){","v = me.add(new Date(y < 100 ? 100 : y, 0, 1, h, i, s, ms), me.YEAR, y < 100 ? y - 100 : 0);","v = !strict? v : (strict === true && (z <= 364 || (me.isLeapYear(v) && z <= 365))? me.add(v, me.DAY, z) : null);","}else if(strict === true && !me.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","if (W) {","year = y || (new Date()).getFullYear(),","jan4 = new Date(year, 0, 4, 0, 0, 0),","week1monday = new Date(jan4.getTime() - ((jan4.getDay() - 1) * 86400000));","v = erajs.Date.clearTime(new Date(week1monday.getTime() + ((W - 1) * 604800000)));","} else {","v = me.add(new Date(y < 100 ? 100 : y, m, d, h, i, s, ms), me.YEAR, y < 100 ? y - 100 : 0);","}","}","}","}","if(v){","if(zz != null){","v = me.add(v, me.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = me.add(v, me.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");
erajs.apply(b,{now:Date.now||function(){return+new Date},toString:function(a){var b=erajs.String.leftPad;return a.getFullYear()+"-"+b(a.getMonth()+1,2,"0")+"-"+b(a.getDate(),2,"0")+"T"+b(a.getHours(),2,"0")+":"+b(a.getMinutes(),2,"0")+":"+b(a.getSeconds(),2,"0")},getElapsed:function(a,c){return Math.abs(a-(c||b.now()))},useStrict:!1,formatCodeToRegex:function(c,d){var e=b.parseCodes[c];return e&&(e="function"==typeof e?e():e,b.parseCodes[c]=e),e?erajs.applyIf({c:e.c?a(e.c,d||"{0}"):e.c},e):{g:0,c:null,s:erajs.String.escapeRegex(c)}},parseFunctions:{MS:function(a){var b=(a||"").match(h);return b?new Date(1*((b[1]||"")+b[2])):null},time:function(a){var b=parseInt(a,10);return b||0===b?new Date(b):null},timestamp:function(a){var b=parseInt(a,10);return b||0===b?new Date(1e3*b):null}},parseRegexes:[],formatFunctions:{MS:function(){return"\\/Date("+this.getTime()+")\\/"},time:function(){return this.getTime().toString()},timestamp:function(){return b.format(this,"U")}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{January:0,Jan:0,February:1,Feb:1,March:2,Mar:2,April:3,Apr:3,May:4,June:5,Jun:5,July:6,Jul:6,August:7,Aug:7,September:8,Sep:8,October:9,Oct:9,November:10,Nov:10,December:11,Dec:11},defaultFormat:"m/d/Y",getShortMonthName:function(a){return erajs.Date.monthNames[a].substring(0,3)},getShortDayName:function(a){return erajs.Date.dayNames[a].substring(0,3)},getMonthNumber:function(a){return erajs.Date.monthNumbers[a.substring(0,1).toUpperCase()+a.substring(1,3).toLowerCase()]},formatContainsHourInfo:function(a){return d.test(a.replace(c,""))},formatContainsDateInfo:function(a){return e.test(a.replace(c,""))},unescapeFormat:function(a){return a.replace(f,"")},formatCodes:{d:"erajs.String.leftPad(this.getDate(), 2, '0')",D:"erajs.Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"erajs.Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"erajs.Date.getSuffix(this)",w:"this.getDay()",z:"erajs.Date.getDayOfYear(this)",W:"erajs.String.leftPad(erajs.Date.getWeekOfYear(this), 2, '0')",F:"erajs.Date.monthNames[this.getMonth()]",m:"erajs.String.leftPad(this.getMonth() + 1, 2, '0')",M:"erajs.Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"erajs.Date.getDaysInMonth(this)",L:"(erajs.Date.isLeapYear(this) ? 1 : 0)",o:"(this.getFullYear() + (erajs.Date.getWeekOfYear(this) == 1 && this.getMonth() > 0 ? +1 : (erajs.Date.getWeekOfYear(this) >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"erajs.String.leftPad(this.getFullYear(), 4, '0')",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"erajs.String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"erajs.String.leftPad(this.getHours(), 2, '0')",i:"erajs.String.leftPad(this.getMinutes(), 2, '0')",s:"erajs.String.leftPad(this.getSeconds(), 2, '0')",u:"erajs.String.leftPad(this.getMilliseconds(), 3, '0')",O:"erajs.Date.getGMTOffset(this)",P:"erajs.Date.getGMTOffset(this, true)",T:"erajs.Date.getTimezone(this)",Z:"(this.getTimezoneOffset() * -60)",c:function(){var a,c,d,e,f;for(a="Y-m-dTH:i:sP",c=[],d=0,e=a.length;e>d;++d)f=a.charAt(d),c.push("T"==f?"'T'":b.getFormatCode(f));return c.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(a,c,d,e,f,g,h){e=e||0,f=f||0,g=g||0,h=h||0;var i=b.add(new Date(100>a?100:a,c-1,d,e,f,g,h),b.YEAR,100>a?a-100:0);return a==i.getFullYear()&&c==i.getMonth()+1&&d==i.getDate()&&e==i.getHours()&&f==i.getMinutes()&&g==i.getSeconds()&&h==i.getMilliseconds()},parse:function(a,c,d){var e=b.parseFunctions;return null==e[c]&&b.createParser(c),e[c].call(b,a,erajs.isDefined(d)?d:b.useStrict)},parseDate:function(a,c,d){return b.parse(a,c,d)},getFormatCode:function(a){var c=b.formatCodes[a];return c&&(c="function"==typeof c?c():c,b.formatCodes[a]=c),c||"'"+erajs.String.escape(a)+"'"},createFormat:function(a){var c,d=[],e=!1,f="";for(c=0;c<a.length;++c)f=a.charAt(c),e||"\\"!=f?e?(e=!1,d.push("'"+erajs.String.escape(f)+"'")):d.push(b.getFormatCode(f)):e=!0;b.formatFunctions[a]=erajs.functionFactory("return "+d.join("+"))},createParser:function(c){for(var d,e=b.parseRegexes.length,f=1,g=[],h=[],j=!1,k="",l=0,m=c.length,n=[];m>l;++l)k=c.charAt(l),j||"\\"!=k?j?(j=!1,h.push(erajs.String.escape(k))):(d=b.formatCodeToRegex(k,f),f+=d.g,h.push(d.s),d.g&&d.c&&(d.calcAtEnd?n.push(d.c):g.push(d.c))):j=!0;g=g.concat(n),b.parseRegexes[e]=new RegExp("^"+h.join("")+"$","i"),b.parseFunctions[c]=erajs.functionFactory("input","strict",a(i,e,g.join("")))},parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|0[1-9])"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|[1-9])"},D:function(){for(var a=[],c=0;7>c;a.push(b.getShortDayName(c)),++c);return{g:0,c:null,s:"(?:"+a.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+b.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:1,c:"W = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},F:function(){return{g:1,c:"m = parseInt(me.getMonthNumber(results[{0}]), 10);\n",s:"("+b.monthNames.join("|")+")"}},M:function(){for(var a=[],c=0;12>c;a.push(b.getShortMonthName(c)),++c);return erajs.applyIf({s:"("+a.join("|")+")"},b.formatCodeToRegex("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|0[1-9])"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|[1-9])"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > me.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(am|pm|AM|PM)",calcAtEnd:!0},A:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(AM|PM|am|pm)",calcAtEnd:!0},g:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|[0-9])"},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|1[0-9]|[0-9])"},h:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|0[1-9])"},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|[0-1][0-9])"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + erajs.String.leftPad(hr, 2, '0') + erajs.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + erajs.String.leftPad(hr, 2, '0') + erajs.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,5}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){var a,c,d=[],e=[b.formatCodeToRegex("Y",1),b.formatCodeToRegex("m",2),b.formatCodeToRegex("d",3),b.formatCodeToRegex("H",4),b.formatCodeToRegex("i",5),b.formatCodeToRegex("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",b.formatCodeToRegex("P",8).c,"}else{",b.formatCodeToRegex("O",8).c,"}","}"].join("\n")}];for(a=0,c=e.length;c>a;++a)d.push(e[a].c);return{g:1,c:d.join(""),s:[e[0].s,"(?:","-",e[1].s,"(?:","-",e[2].s,"(?:","(?:T| )?",e[3].s,":",e[4].s,"(?::",e[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}},dateFormat:function(a,c){return b.format(a,c)},isEqual:function(a,b){return a&&b?a.getTime()===b.getTime():!(a||b)},format:function(a,c){var d=b.formatFunctions;return erajs.isDate(a)?(null==d[c]&&b.createFormat(c),d[c].call(a)+""):""},getTimezone:function(a){return a.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,5})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(a,b){var c=a.getTimezoneOffset();return(c>0?"-":"+")+erajs.String.leftPad(Math.floor(Math.abs(c)/60),2,"0")+(b?":":"")+erajs.String.leftPad(Math.abs(c%60),2,"0")},getDayOfYear:function(a){var c,d=0,e=erajs.Date.clone(a),f=a.getMonth();for(c=0,e.setDate(1),e.setMonth(0);f>c;e.setMonth(++c))d+=b.getDaysInMonth(e);return d+a.getDate()-1},getWeekOfYear:function(){var a=864e5,b=7*a;return function(c){var d=Date.UTC(c.getFullYear(),c.getMonth(),c.getDate()+3)/a,e=Math.floor(d/7),f=new Date(e*b).getUTCFullYear();return e-Math.floor(Date.UTC(f,0,7)/b)+1}}(),isLeapYear:function(a){var b=a.getFullYear();return!(0!=(3&b)||!(b%100||b%400==0&&b))},getFirstDayOfMonth:function(a){var b=(a.getDay()-(a.getDate()-1))%7;return 0>b?b+7:b},getLastDayOfMonth:function(a){return b.getLastDateOfMonth(a).getDay()},getFirstDateOfMonth:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},getLastDateOfMonth:function(a){return new Date(a.getFullYear(),a.getMonth(),b.getDaysInMonth(a))},getDaysInMonth:function(){var a=[31,28,31,30,31,30,31,31,30,31,30,31];return function(c){var d=c.getMonth();return 1==d&&b.isLeapYear(c)?29:a[d]}}(),getSuffix:function(a){switch(a.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(a){return new Date(a.getTime())},isDST:function(a){return new Date(a.getFullYear(),0,1).getTimezoneOffset()!=a.getTimezoneOffset()},clearTime:function(a,c){if(c)return erajs.Date.clearTime(erajs.Date.clone(a));var d,e,f=a.getDate();if(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.getDate()!=f){for(d=1,e=b.add(a,erajs.Date.HOUR,d);e.getDate()!=f;d++,e=b.add(a,erajs.Date.HOUR,d));a.setDate(f),a.setHours(e.getHours())}return a},add:function(a,c,d){var e,f,g=erajs.Date.clone(a),h=(erajs.Date,0);if(!c||0===d)return g;if(f=d-parseInt(d,10),d=parseInt(d,10))switch(c.toLowerCase()){case erajs.Date.MILLI:g.setTime(g.getTime()+d);break;case erajs.Date.SECOND:g.setTime(g.getTime()+1e3*d);break;case erajs.Date.MINUTE:g.setTime(g.getTime()+60*d*1e3);break;case erajs.Date.HOUR:g.setTime(g.getTime()+60*d*60*1e3);break;case erajs.Date.DAY:g.setDate(g.getDate()+d);break;case erajs.Date.MONTH:e=a.getDate(),e>28&&(e=Math.min(e,erajs.Date.getLastDateOfMonth(erajs.Date.add(erajs.Date.getFirstDateOfMonth(a),erajs.Date.MONTH,d)).getDate())),g.setDate(e),g.setMonth(a.getMonth()+d);break;case erajs.Date.YEAR:e=a.getDate(),e>28&&(e=Math.min(e,erajs.Date.getLastDateOfMonth(erajs.Date.add(erajs.Date.getFirstDateOfMonth(a),erajs.Date.YEAR,d)).getDate())),g.setDate(e),g.setFullYear(a.getFullYear()+d)}if(f){switch(c.toLowerCase()){case erajs.Date.MILLI:h=1;break;case erajs.Date.SECOND:h=1e3;break;case erajs.Date.MINUTE:h=6e4;break;case erajs.Date.HOUR:h=36e5;break;case erajs.Date.DAY:h=864e5;break;case erajs.Date.MONTH:e=b.getDaysInMonth(g),h=864e5*e;break;case erajs.Date.YEAR:e=b.isLeapYear(g)?366:365,h=864e5*e}h&&g.setTime(g.getTime()+h*f)}return g},subtract:function(a,c,d){return b.add(a,c,-d)},between:function(a,b,c){var d=a.getTime();return b.getTime()<=d&&d<=c.getTime()},compat:function(){var a,c,d,e,f=window.Date,g=["useStrict","formatCodeToRegex","parseFunctions","parseRegexes","formatFunctions","y2kYear","MILLI","SECOND","MINUTE","HOUR","DAY","MONTH","YEAR","defaults","dayNames","monthNames","monthNumbers","getShortMonthName","getShortDayName","getMonthNumber","formatCodes","isValid","parseDate","getFormatCode","createFormat","createParser","parseCodes"],h=["dateFormat","format","getTimezone","getGMTOffset","getDayOfYear","getWeekOfYear","isLeapYear","getFirstDayOfMonth","getLastDayOfMonth","getDaysInMonth","getSuffix","clone","isDST","clearTime","add","between"],i=g.length,j=h.length;for(e=0;i>e;e++)c=g[e],f[c]=b[c];for(a=0;j>a;a++)d=h[a],f.prototype[d]=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(this),b[d].apply(b,a)}}})},erajs.Date.patterns={ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"},function(alias,arraySlice,global){function makeCtor(){function a(){return this.constructor.apply(this,arguments)||null}return a}var Manager=erajs.Manager={typeName:"xtype",uiNamespacePrefix:"erajs.ui.",all:new erajs.util.HashMap,types:{},get:function(a){return this.all.get(a)},register:function(a){var b=this.all,c=b.getKey(a);b.containsKey(c)||this.all.add(a)},unregister:function(a){"string"==typeof a?this.all.removeAtKey(a):this.all.remove(a)},registerType:function(a,b){b[this.typeName]=a,this.isRegistered(a)||(this.types[a]=this.uiNamespacePrefix+erajs.String.capitalize(a))},isRegistered:function(a){return void 0!==this.types[a]},getCount:function(){return this.all.getCount()},instantiate:function(){var self=this,args=arguments,xtype,cls,alias=xtype=args[0];xtype&&erajs.isString(xtype)&&(xtype=erajs.String.capitalize(xtype)),cls=self.uiNamespacePrefix+xtype;var instantiate=eval("new "+cls+"(arguments[1],arguments[2])");return self.registerType(alias,instantiate),erajs.isEmpty(instantiate.id)||self.register(instantiate),"Window"==xtype&&(erajs.lastWindow=instantiate),instantiate},isInstantiate:function(a){var b=this.all;return b.containsKey(a)},destroy:function(a){this.unregister(a)}};erajs.apply(erajs,{create:alias(Manager,"instantiate"),destroy:alias(Manager,"destroy"),isInstantiate:alias(Manager,"isInstantiate"),isRegistered:alias(Manager,"isRegistered"),getCmp:function(a){return erajs.Manager.get(a)}})}(erajs.Function.alias,Array.prototype.slice,erajs.global),function(){function a(a,b,c,d){var e=b,f=erajs.ui.parser.getOptionsObject(a.getAttribute("data-options"));if(f.hasOwnProperty("formatter")){var g=f.formatter;if(g){var h=erajs.Object.getSize(f);if(h>1&&(delete f.formatter,e=$.extend(f,{value:b})),erajs.isString(g)){var i=erajs.Extra.executeFormatter(g,e,a,c,d);if(i)return i}else if("function"==typeof g)return g(e,a,c,d)}}return e}function b(a){var b=a.data;a.isDefaultPrevented()||(a.preventDefault(),$(a.target).ajaxSubmit(b))}function c(a){var b=a.target,c=$(b);if(!c.is("[type=submit],[type=image]")){var d=c.closest("[type=submit]");if(0===d.length)return;b=d[0]}var e=this;if(e.clk=b,"image"==b.type)if(void 0!==a.offsetX)e.clk_x=a.offsetX,e.clk_y=a.offsetY;else if("function"==typeof $.fn.offset){var f=c.offset();e.clk_x=a.pageX-f.left,e.clk_y=a.pageY-f.top}else e.clk_x=a.pageX-b.offsetLeft,e.clk_y=a.pageY-b.offsetTop;setTimeout(function(){e.clk=e.clk_x=e.clk_y=null},100)}function d(){if($.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}$.fn._outerWidth=function(a){return void 0==a?this[0]==window?this.width()||document.body.clientWidth:this.outerWidth()||0:this.each(function(){var b=$(this);b.width($._boxModel?a-(b.outerWidth()-b.width()):a)})},$.fn._outerHeight=function(a){return void 0==a?this[0]==window?this.height()||document.body.clientHeight:this.outerHeight()||0:this.each(function(){var b=$(this);b.height($._boxModel?a-(b.outerHeight()-b.height()):a)})},$.fn._scrollLeft=function(a){return void 0==a?this.scrollLeft():this.each(function(){$(this).scrollLeft(a)})},$.fn._propAttr=$.fn.prop||$.fn.attr,$.fn._fit=function(a){a=void 0==a?!0:a;var b=this[0],c="BODY"==b.tagName?b:this.parent()[0];if(c){var d=c.fcount||0;return a?b.fitted||(b.fitted=!0,c.fcount=d+1,$(c).addClass("panel-noscroll"),"BODY"==c.tagName&&$("html").addClass("panel-fit")):b.fitted&&(b.fitted=!1,c.fcount=d-1,0==c.fcount&&($(c).removeClass("panel-noscroll"),"BODY"==c.tagName&&$("html").removeClass("panel-fit"))),{width:$(c).width(),height:$(c).height()}}},$.fn._size=function(a,b){function c(a,b,c){var d=$(a)[0],e=b[0],f=e.fcount||0;return c?(d.fitted||(d.fitted=!0,e.fcount=f+1,$(e).addClass("panel-noscroll"),"BODY"==e.tagName&&$("html").addClass("panel-fit")),{width:$(e).width()||1,height:$(e).height()||1}):(d.fitted&&(d.fitted=!1,e.fcount=f-1,0==e.fcount&&($(e).removeClass("panel-noscroll"),"BODY"==e.tagName&&$("html").removeClass("panel-fit"))),!1)}function d(a,b,c,d){var e=$(a),f=b,g=f.substr(0,1).toUpperCase()+f.substr(1),h=erajs.ui.parser.parseValue("min"+g,d["min"+g],c),i=erajs.ui.parser.parseValue("max"+g,d["max"+g],c),j=erajs.ui.parser.parseValue(f,d[f],c),k=String(d[f]||"").indexOf("%")>=0?!0:!1;if(isNaN(j))e._size(f,""),e._size("min"+g,h),e._size("max"+g,i);else{var l=Math.min(Math.max(j,h||0),i||99999);k||(d[f]=l),e._size("min"+g,""),e._size("max"+g,""),e._size(f,l)}return k||d.fit}function e(a,b,c){function d(){return b.toLowerCase().indexOf("width")>=0?e.outerWidth()-e.width():e.outerHeight()-e.height()}var e=$(a);return void 0==c?(c=parseInt(a.style[b]),isNaN(c)?void 0:($._boxModel&&(c+=d()),c)):void(""===c?e.css(b,""):($._boxModel&&(c-=d(),0>c&&(c=0)),e.css(b,c+"px")))}return"string"==typeof a?"clear"==a?this.each(function(){$(this).css({width:"",minWidth:"",maxWidth:"",height:"",minHeight:"",maxHeight:""})}):"unfit"==a?this.each(function(){c(this,$(this).parent(),!1)}):void 0==b?e(this[0],a):this.each(function(){e(this,a,b)}):this.each(function(){b=b||$(this).parent(),$.extend(a,c(this,b,a.fit)||{});var e=d(this,"width",b,a),f=d(this,"height",b,a);e||f?$(this).addClass("erajs-fluid"):$(this).removeClass("erajs-fluid")})},$.fn.setSpanTagValue=function(b){return 0 in arguments?this.each(function(c){var d=this.innerHTML,e=a(this,b,c,d),f=$(this),g=!1;f.empty().append(e);var h=f.attr("tip-options"),i={};void 0!=h&&(i=erajs.ui.parser.getOptionsObject(h),i.always&&(erajs.Extra.showTipsy(f,$.extend({fallback:e},i)),g=!0)),g||f.map(function(){if(this.offsetWidth<this.scrollWidth){var a=$.extend({fallback:e},i);erajs.Extra.showTipsy(f,a)}else erajs.hideTipsy(f)})}):0 in this?this[0].innerHTML:null},$.fn.setValues=function(a){function b(a){return!l||k.hasOwnProperty(a)}function c(a){return k.hasOwnProperty(a)?k[a]:""}function d(){h.find(":radio[name], :checkbox[name]").each(function(){var a=this.name;if(a&&b(a)){var d=$(this),e=c(a),f=d.val();d._propAttr("checked",!1),(f==String(e)||$.inArray(f,$.isArray(e)?e:[e])>=0)&&d._propAttr("checked",!0)}})}function e(){h.find("input[name][type]:not(:file,:radio,:checkbox,[uihidden]),textarea[name],select[name]:not([xtype])").each(function(){var a=this.name;a&&b(a)&&$(this).val(c(a))})}function f(){h.find("span[initname]").each(function(){var a=$(this),d=a.attr("initname");d&&b(d)&&a.setSpanTagValue(c(d))})}function g(){var a=erajs.formUiXtypes;h.find("[xtype]").each(function(){var d,e=$(this),f=this.id,g=e.attr("xtype");if(erajs.Array.contains(a,g)){if(!erajs.isInstantiate(f))return void(erajs.debug&&erajs.Extra.showAutoSlideMsg(erajs.String.format("The component is not register, id is '{0}' and xtype is '{1}'.",f,g)));d=erajs.getCmp(f);var h=d.options;if(h&&h.hasOwnProperty("name")){var i=h.name;if(i&&b(i)){var j=c(i),k=h.multiple;try{if(k){var l=erajs.isArray(j)?j:[];erajs.isString(j)&&""!=j&&(l=j.split(",")),d.setValues(l)}else d.setValue(j)}catch(m){erajs.debug&&erajs.Extra.showAutoSlideMsg(erajs.String.format("There are some exception occurred when execute 'setValue' function,the ui xtype is '{0}',name is '{1}'!",d.xtype,i))}}}}})}var h=this,i=arguments,j=i.length,k=a||{},l=!0;return erajs.isObject(k)?(2==j&&(l=i[1]),void(l&&erajs.Object.isEmpty(k)||(erajs.isFormSetValue=!0,d(),f(),e(),g(),erajs.isFormSetValue=!1))):void erajs.Extra.showAutoSlideMsg("The param must be a JavaScript Object type!")},$.fn.countdown=function(a){var b={stepTime:60,format:"dd:hh:mm:ss",startTime:"01:12:32:55",digitImages:6,digitWidth:67,digitHeight:90,timerEnd:function(){},image:"digits.png"};b.target=this;var c=[],d=[],e=function(a){for(var d=0,e=0;e<b.startTime.length;e++){if(parseInt(b.startTime[e])>=0){switch(elem=$('<div id="cnt_'+d+'" class="cntDigit" />').css({height:b.digitHeight,"float":"left",background:"url('"+b.image+"')",width:b.digitWidth}),elem.current=parseInt(b.startTime[e]),c.push(elem),f(d,-elem.current*b.digitHeight*b.digitImages),b.format[e]){case"h":c[d]._max=function(a,b){return a%2==0?2:b?3:9};break;case"d":c[d]._max=function(){return 9};break;case"m":case"s":c[d]._max=function(a){return a%2==0?5:9}}++d}else elem=$('<div class="cntSeparator"/>').css({"float":"left"}).text(b.startTime[e]);a.append(elem)}},f=function(a,b){return void 0!==b?(c[a].margin=b,c[a].css({backgroundPosition:"0 "+b+"px"})):c[a].margin||0},g=function(a,e,g){d[a]&&window.clearInterval(d[a]);var h=-(b.digitHeight*b.digitImages*c[a].current);f(a,h),c[a].current=c[a].current+(g?e:-e);var i=0;d[a]=setInterval(function(){if(i++===b.digitImages*e)return window.clearInterval(d[a]),void delete d[a];var c=g?-b.digitHeight:b.digitHeight;f(a,h+i*c)},b.stepTime/e)},h=function(a){if(0!=c[a].current)g(a,1);else if(a>0){var e=0==c[a-1].current;g(a,c[a]._max(a,e),!0),h(a-1)}else{for(var i=0;i<c.length;i++)clearInterval(d[i]),f(i,0);clearInterval(d.main),b.timerEnd()}};$.extend(b,a);var i=function(a){var b=[],c=[],d=function(a){return a>9?a:"0"+a},e=86400,f=3600,g=parseInt(a/e),h=parseInt(a%e/f),i=parseInt(a%e%f/60),j=a%e%f%60;return g>0&&(b.push(d(g)),c.push("dd")),(h>0||g>0)&&(b.push(d(h)),c.push("hh")),(i>0||h>0||g>0)&&(b.push(d(i)),c.push("mm")),b.push(d(j)),c.push("ss"),{time:b,format:c}},j=function(a){return a instanceof Array?a.join(":"):a},k=b.startTime;if(!isNaN(k)){var l=i(k);b.startTime=j(l.time),b.format=j(l.format)}e(this),d.main=setInterval(function(){h(c.length-1)},1e3)},$.fn.setUiNameAttribute=function(){var a=this.find("[xtype]");$.each(a,function(a,b){var c=this.id,d=erajs.getCmp(c);if(d){var e=erajs.getUiNameElement(b);e&&(e.element.attr("uiname",e.name),e.element.attr("uiid",c))}})};var e={};e.fileapi=void 0!==$("<input type='file'/>").get(0).files,e.formdata=void 0!==window.FormData;var f=!!$.fn.prop;$.fn.attr2=function(){if(!f)return this.attr.apply(this,arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"==typeof a?a:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(a){function b(b){var c,d,e=$.param(b,a.traditional).split("&"),f=e.length,g=[];for(c=0;f>c;c++)e[c]=e[c].replace(/\+/g," "),d=e[c].split("="),g.push([decodeURIComponent(d[0]),decodeURIComponent(d[1])]);return g}function c(c){for(var d=new FormData,e=0;e<c.length;e++)d.append(c[e].name,c[e].value);if(a.extraData){var f=b(a.extraData);for(e=0;e<f.length;e++)f[e]&&d.append(f[e][0],f[e][1])}a.data=null;var g=$.extend(!0,{},$.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:h||"POST"});a.uploadProgress&&(g.xhr=function(){var b=$.ajaxSettings.xhr();return b.upload&&b.upload.addEventListener("progress",function(b){var c=0,d=b.loaded||b.position,e=b.total;b.lengthComputable&&(c=Math.ceil(d/e*100)),a.uploadProgress(b,d,e,c)},!1),b}),g.data=null;var i=g.beforeSend;return g.beforeSend=function(b,c){c.data=a.formData?a.formData:d,i&&i.call(this,b,c)},$.ajax(g)}function g(b){function c(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(c){d("cannot get iframe.contentWindow document: "+c)}if(b)return b;try{b=a.contentDocument?a.contentDocument:a.document}catch(c){d("cannot get iframe.contentDocument: "+c),b=a.document}return b}function e(){function a(){try{var b=c(q).readyState;d("state = "+b),b&&"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(e){d("Server abort: ",e," (",e.name,")"),g(z),v&&clearTimeout(v),v=void 0}}var b=k.attr2("target"),e=k.attr2("action"),f="multipart/form-data",i=k.attr("enctype")||k.attr("encoding")||f;w.setAttribute("target",n),(!h||/post/i.test(h))&&w.setAttribute("method","POST"),e!=l.url&&w.setAttribute("action",l.url),l.skipEncodingOverride||h&&!/post/i.test(h)||k.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),l.timeout&&(v=setTimeout(function(){u=!0,g(y)},l.timeout));var j=[];try{if(l.extraData)for(var m in l.extraData)l.extraData.hasOwnProperty(m)&&j.push($.isPlainObject(l.extraData[m])&&l.extraData[m].hasOwnProperty("name")&&l.extraData[m].hasOwnProperty("value")?$('<input type="hidden" name="'+l.extraData[m].name+'">').val(l.extraData[m].value).appendTo(w)[0]:$('<input type="hidden" name="'+m+'">').val(l.extraData[m]).appendTo(w)[0]);l.iframeTarget||p.appendTo("body"),q.attachEvent?q.attachEvent("onload",g):q.addEventListener("load",g,!1),setTimeout(a,15);try{w.submit()}catch(o){var r=document.createElement("form").submit;r.apply(w)}}finally{w.setAttribute("action",e),w.setAttribute("enctype",i),b?w.setAttribute("target",b):k.removeAttr("target"),$(j).remove()}}function g(a){if(!r.aborted&&!E){if(D=c(q),D||(d("cannot access response document"),a=z),a===y&&r)return r.abort("timeout"),void x.reject(r,"timeout");if(a==z&&r)return r.abort("server abort"),void x.reject(r,"error","server abort");if(D&&D.location.href!=l.iframeSrc||u){q.detachEvent?q.detachEvent("onload",g):q.removeEventListener("load",g,!1);var b,e="success";try{if(u)throw"timeout";var f="xml"==l.dataType||D.XMLDocument||$.isXMLDoc(D);if(d("isXml="+f),!f&&window.opera&&(null===D.body||!D.body.innerHTML)&&--F)return d("requeing onLoad callback, DOM not available"),void setTimeout(g,250);var h=D.body?D.body:D.documentElement;r.responseText=h?h.innerHTML:null,r.responseXML=D.XMLDocument?D.XMLDocument:D,f&&(l.dataType="xml"),r.getResponseHeader=function(a){var b={"content-type":l.dataType};return b[a.toLowerCase()]},h&&(r.status=Number(h.getAttribute("status"))||r.status,r.statusText=h.getAttribute("statusText")||r.statusText);var i=(l.dataType||"").toLowerCase(),j=/(json|script|text)/.test(i);if(j||l.textarea){var k=D.getElementsByTagName("textarea")[0];if(k)r.responseText=k.value,r.status=Number(k.getAttribute("status"))||r.status,r.statusText=k.getAttribute("statusText")||r.statusText;else if(j){var n=D.getElementsByTagName("pre")[0],o=D.getElementsByTagName("body")[0];n?r.responseText=n.textContent?n.textContent:n.innerText:o&&(r.responseText=o.textContent?o.textContent:o.innerText)}}else"xml"==i&&!r.responseXML&&r.responseText&&(r.responseXML=G(r.responseText));try{C=I(r,i,l)}catch(s){e="parsererror",r.error=b=s||e}}catch(s){d("error caught: ",s),e="error",r.error=b=s||e}r.aborted&&(d("upload aborted"),e=null),r.status&&(e=r.status>=200&&r.status<300||304===r.status?"success":"error"),"success"===e?(l.success&&l.success.call(l.context,C,"success",r),x.resolve(r.responseText,"success",r),m&&$.event.trigger("ajaxSuccess",[r,l])):e&&(void 0===b&&(b=r.statusText),l.error&&l.error.call(l.context,r,e,b),x.reject(r,"error",b),m&&$.event.trigger("ajaxError",[r,l,b])),m&&$.event.trigger("ajaxComplete",[r,l]),m&&!--$.active&&$.event.trigger("ajaxStop"),l.complete&&l.complete.call(l.context,r,e),E=!0,l.timeout&&clearTimeout(v),setTimeout(function(){l.iframeTarget?p.attr("src",l.iframeSrc):p.remove(),r.responseXML=null},100)}}}var i,j,l,m,n,p,q,r,s,t,u,v,w=k[0],x=$.Deferred();if(x.abort=function(a){r.abort(a)},b)for(j=0;j<o.length;j++)i=$(o[j]),f?i.prop("disabled",!1):i.removeAttr("disabled");if(l=$.extend(!0,{},$.ajaxSettings,a),l.context=l.context||l,n="jqFormIO"+(new Date).getTime(),l.iframeTarget?(p=$(l.iframeTarget),t=p.attr2("name"),t?n=t:p.attr2("name",n)):(p=$('<iframe name="'+n+'" src="'+l.iframeSrc+'" />'),p.css({position:"absolute",top:"-1000px",left:"-1000px"})),q=p[0],r={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var b="timeout"===a?"timeout":"aborted";d("aborting upload... "+b),this.aborted=1;try{q.contentWindow.document.execCommand&&q.contentWindow.document.execCommand("Stop")}catch(c){}p.attr("src",l.iframeSrc),r.error=b,l.error&&l.error.call(l.context,r,b,a),m&&$.event.trigger("ajaxError",[r,l,b]),l.complete&&l.complete.call(l.context,r,b)}},m=l.global,m&&0===$.active++&&$.event.trigger("ajaxStart"),m&&$.event.trigger("ajaxSend",[r,l]),l.beforeSend&&l.beforeSend.call(l.context,r,l)===!1)return l.global&&$.active--,x.reject(),x;if(r.aborted)return x.reject(),x;s=w.clk,s&&(t=s.name,t&&!s.disabled&&(l.extraData=l.extraData||{},l.extraData[t]=s.value,"image"==s.type&&(l.extraData[t+".x"]=w.clk_x,l.extraData[t+".y"]=w.clk_y)));var y=1,z=2,A=$("meta[name=csrf-token]").attr("content"),B=$("meta[name=csrf-param]").attr("content");B&&A&&(l.extraData=l.extraData||{},l.extraData[B]=A),l.forceSync?e():setTimeout(e,10);var C,D,E,F=50,G=$.parseXML||function(a,b){return window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},H=$.parseJSON||function(a){return window.eval("("+a+")")},I=function(a,b,c){var d=a.getResponseHeader("content-type")||"",e="xml"===b||!b&&d.indexOf("xml")>=0,f=e?a.responseXML:a.responseText;return e&&"parsererror"===f.documentElement.nodeName&&$.error&&$.error("parsererror"),c&&c.dataFilter&&(f=c.dataFilter(f,b)),"string"==typeof f&&("json"===b||!b&&d.indexOf("json")>=0?f=H(f):("script"===b||!b&&d.indexOf("javascript")>=0)&&$.globalEval(f)),f};return x}if(!this.length)return d("ajaxSubmit: skipping submit process - no element selected"),this;var h,i,j,k=this;"function"==typeof a?a={success:a}:void 0===a&&(a={}),h=a.type||this.attr2("method"),i=a.url||this.attr2("action"),j="string"==typeof i?$.trim(i):"",j=j||window.location.href||"",j&&(j=(j.match(/^([^#]+)/)||[])[1]),a=$.extend(!0,{url:j,success:$.ajaxSettings.success,type:h||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);var l={};if(this.trigger("form-pre-serialize",[this,a,l]),l.veto)return d("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&a.beforeSerialize(this,a)===!1)return d("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var m=a.traditional;void 0===m&&(m=$.ajaxSettings.traditional);var n,o=[],p=this.formToArray(a.semantic,o);if(a.data&&(a.extraData=a.data,n=$.param(a.data,m)),a.beforeSubmit&&a.beforeSubmit(p,this,a)===!1)return d("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[p,this,a,l]),l.veto)return d("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var q=$.param(p,m);n&&(q=q?q+"&"+n:n),"GET"==a.type.toUpperCase()?(a.url+=(a.url.indexOf("?")>=0?"&":"?")+q,a.data=null):a.data=q;var r=[];if(a.resetForm&&r.push(function(){k.resetForm()}),a.clearForm&&r.push(function(){k.clearForm(a.includeHidden)}),!a.dataType&&a.target){var s=a.success||function(){};r.push(function(b){var c=a.replaceTarget?"replaceWith":"html";$(a.target)[c](b).each(s,arguments)})}else a.success&&r.push(a.success);if(a.success=function(b,c,d){for(var e=a.context||this,f=0,g=r.length;g>f;f++)r[f].apply(e,[b,c,d||k,k])},a.error){var t=a.error;a.error=function(b,c,d){var e=a.context||this;t.apply(e,[b,c,d,k])}}if(a.complete){var u=a.complete;a.complete=function(b,c){var d=a.context||this;u.apply(d,[b,c,k])}}var v=$("input[type=file]:enabled",this).filter(function(){return""!==$(this).val()
}),w=v.length>0,x="multipart/form-data",y=k.attr("enctype")==x||k.attr("encoding")==x,z=e.fileapi&&e.formdata;d("fileAPI :"+z);var A,B=(w||y)&&!z;a.iframe!==!1&&(a.iframe||B)?a.closeKeepAlive?$.get(a.closeKeepAlive,function(){A=g(p)}):A=g(p):A=(w||y)&&z?c(p):$.ajax(a),k.removeData("jqxhr").data("jqxhr",A);for(var C=0;C<o.length;C++)o[C]=null;return this.trigger("form-submit-notify",[this,a]),this},$.fn.ajaxForm=function(a){if(a=a||{},a.delegation=a.delegation&&$.isFunction($.fn.on),!a.delegation&&0===this.length){var e={s:this.selector,c:this.context};return!$.isReady&&e.s?(d("DOM not ready, queuing ajaxForm"),$(function(){$(e.s,e.c).ajaxForm(a)}),this):(d("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return a.delegation?($(document).off("submit.form-plugin",this.selector,b).off("click.form-plugin",this.selector,c).on("submit.form-plugin",this.selector,a,b).on("click.form-plugin",this.selector,a,c),this):this.ajaxFormUnbind().bind("submit.form-plugin",a,b).bind("click.form-plugin",a,c)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(a,b){var c=[];if(0===this.length)return c;var d,f=this[0],g=this.attr("id"),h=a?f.getElementsByTagName("*"):f.elements;if(h&&!/MSIE [678]/.test(navigator.userAgent)&&(h=$(h).get()),g&&(d=$(':input[form="'+g+'"]').get(),d.length&&(h=(h||[]).concat(d))),!h||!h.length)return c;var i,j,k,l,m,n,o;for(i=0,n=h.length;n>i;i++)if(m=h[i],k=m.name,k&&!m.disabled)if(a&&f.clk&&"image"==m.type)f.clk==m&&(c.push({name:k,value:$(m).val(),type:m.type}),c.push({name:k+".x",value:f.clk_x},{name:k+".y",value:f.clk_y}));else if(l=$.fieldValue(m,!0),l&&l.constructor==Array)for(b&&b.push(m),j=0,o=l.length;o>j;j++)c.push({name:k,value:l[j]});else if(e.fileapi&&"file"==m.type){b&&b.push(m);var p=m.files;if(p.length)for(j=0;j<p.length;j++)c.push({name:k,value:p[j],type:m.type});else c.push({name:k,value:"",type:m.type})}else null!==l&&"undefined"!=typeof l&&(b&&b.push(m),c.push({name:k,value:l,type:m.type,required:m.required}));if(!a&&f.clk){var q=$(f.clk),r=q[0];k=r.name,k&&!r.disabled&&"image"==r.type&&(c.push({name:k,value:q.val()}),c.push({name:k+".x",value:f.clk_x},{name:k+".y",value:f.clk_y}))}return c},$.fn.formFields=function(a){var b=[];if(0===this.length)return b;var c,d=this[0],e=this.attr("id"),f=a?d.getElementsByTagName("*"):d.elements;if(f&&!/MSIE [678]/.test(navigator.userAgent)&&(f=$(f).get()),e&&(c=$(':input[form="'+e+'"]').get(),c.length&&(f=(f||[]).concat(c))),!f||!f.length)return b;var g,h,i,j;for(g=0,j=f.length;j>g;g++)i=f[g],h=i.id||i.name,h&&b.push(h);return $.unique(b)},$.fn.formSerialize=function(a){return $.param(this.formToArray(a))},$.fn.fieldSerialize=function(a){var b=[];return this.each(function(){var c=this.name;if(c){var d=$.fieldValue(this,a);if(d&&d.constructor==Array)for(var e=0,f=d.length;f>e;e++)b.push({name:c,value:d[e]});else null!==d&&"undefined"!=typeof d&&b.push({name:this.name,value:d})}}),$.param(b)},$.fn.fieldValue=function(a){for(var b=[],c=0,d=this.length;d>c;c++){var e=this[c],f=$.fieldValue(e,a);null===f||"undefined"==typeof f||f.constructor==Array&&!f.length||(f.constructor==Array?$.merge(b,f):b.push(f))}return b},$.fieldValue=function(a,b){var c=a.name,d=a.type,e=a.tagName.toLowerCase();if(void 0===b&&(b=!0),b&&(!c||a.disabled||"reset"==d||"button"==d||("checkbox"==d||"radio"==d)&&!a.checked||("submit"==d||"image"==d)&&a.form&&a.form.clk!=a||"select"==e&&-1==a.selectedIndex))return null;if("select"==e){var f=a.selectedIndex;if(0>f)return null;for(var g=[],h=a.options,i="select-one"==d,j=i?f+1:h.length,k=i?f:0;j>k;k++){var l=h[k];if(l.selected){var m=l.value;if(m||(m=l.attributes&&l.attributes.value&&!l.attributes.value.specified?l.text:l.value),i)return m;g.push(m)}}return g}return $(a).val()},$.fn.clearForm=function(a,b,c){return this.each(function(){$("input,select,textarea",this).clearFields(a,b,c)})},$.fn.clearFields=$.fn.clearInputs=function(a,b,c){var d=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var e=this.type,f=$(this),g=this.tagName.toLowerCase(),h=this.disabled,i=f.attr("readonly"),j=this.getAttribute("xtype");j||f.hasClass("textbox-text")||f.hasClass("textbox-value")||f.hasClass("slider-value")||!b&&(i||f.hasClass("eraui-readonly"))||!c&&h||(d.test(e)||"textarea"==g?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==g?this.selectedIndex=-1:"file"==e?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):a&&(a===!0&&/hidden/.test(e)||"string"==typeof a&&$(this).is(a))&&(this.value=""))})},$.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},$.fn.enable=function(a){return void 0===a&&(a=!0),this.each(function(){this.disabled=!a})},$.fn.readonly=function(a){return this.each(function(){var b=this.type,c=$(this);switch(b){case"text":case"textarea":a?c.attr("readonly",!0).addClass("eraui-readonly"):c.removeAttr("readonly").removeClass("eraui-readonly");break;case"select-one":case"checkbox":case"radio":case"file":case"button":c.enable(!a)}})},$.fn.selected=function(a){return void 0===a&&(a=!0),this.each(function(){var b=this.type;if("checkbox"==b||"radio"==b)this.checked=a;else if("option"==this.tagName.toLowerCase()){var c=$(this).parent("select");a&&c[0]&&"select-one"==c[0].type&&c.find("option").selected(!1),this.selected=a}})},$.fn.ajaxSubmit.debug=!1}(),function(){erajs.ui.parser={auto:!0,onComplete:function(a){var b=this;b.parseTipsy(a)},plugins:["draggable","droppable","resizable","pagination","tooltip","button","menu","menubutton","progressbar","layout","panel","tabs","accordion","window","dialog","combobox","datebox","datetimebox","numberbox","textbox","filebox","numberspinner","timespinner","combotree","combogrid","tree","spinner","datagrid","propertygrid","treegrid","calendar","slider","combo"],parse:function(a){for(var b=[],c=0;c<this.plugins.length;c++){var d=this.plugins[c],e=$('[xtype="'+d+'"]',a);e.length&&b.push({xtype:d,jq:e})}if(b.length&&window.erajsloader){for(var f=[],c=0;c<b.length;c++)f.push(b[c].xtype);erajsloader.load(f,function(){erajs.ui.parser.initComponent(b)})}else erajs.ui.parser.initComponent(b,a)},initComponent:function(a,b){var c=this;erajs.localize&&c.parseBaseLocale(b);for(var d=0;d<a.length;d++)for(var e=a[d].xtype,f=a[d].jq,g=0;g<f.length;g++){var h=$(f[g]);if(!f[g].id){var i=f[g].name||erajs.id(f[g]);h.attr("id",i)}var j={},k=$.trim(h.attr("custom-options"));k&&(j=erajs.parserCustomOptions(e,k,f[g])),"button"==e&&c.setKnowBtnsText(f[g]),erajs.localize&&erajs.Array.contains(c.uiLocales,e)&&c.parseUiLocale(e,f[g]),erajs.create(e,{target:f[g]},j)}erajs.ui.parser.onComplete.call(erajs.ui.parser,b)},parseValue:function(a,b,c,d){d=d||0;var e=$.trim(String(b||"")),f=e.substr(e.length-1,1);return"%"==f?(e=parseInt(e.substr(0,e.length-1)),e=Math.floor(a.toLowerCase().indexOf("width")>=0?(c.width()-d)*e/100:(c.height()-d)*e/100)):e=parseInt(e)||void 0,e},parseTipsy:function(a){var b=this;$("[tipsy]",a).each(function(){var a=$(this),c=b.getOptionsObject(a.attr("tipsy"));erajs.Extra.showTipsy(a,c)})},setKnowBtnsText:function(a){var b=this,c=$.trim($(a).text());if(!c){var d=b.getUIAttribute(a,"iconCls");if(d){d=d.replace("-",".");var e=b.getLocaleValue(d);e&&$(a).text(e)}}},parseUiLocale:function(a,b){function c(a){if(d(a)){var b=e.getLocaleKey(a);if(b){var c=erajs.getMessage(b);b!==c&&a.setAttribute("title",c)}}}function d(a){return null!==e.getUIAttribute(a,"title")}var e=this;if("button"==a){var f=$(b).text(),g=e.getLocaleValue(b);void 0!==g&&g!==f&&$(b).html(g)}else if("panel"==a||"window"==a||"dialog"==a||"datagrid"==a||"treegrid"==a)c(b);else if("tabs"==a||"layout"==a||"accordion"==a){var h=$(b).children("div");erajs.each(h,function(a){c(a)})}},getUIAttribute:function(a,b){var c=this,d=a.getAttribute(b);if(!d){var e=c.getOptionsObject(a.getAttribute("data-options"));e.hasOwnProperty(b)&&(d=e[b])}return d},uiLocales:["button","tabs","datagrid","treegrid","layout","panel","window","dialog","accordion"],getLocaleKey:function(a){var b=a.getAttribute("langid");return b||(b=a.getAttribute("name")||a.id),b},getLocaleValue:function(a){var b=this;return"object"==typeof a&&(a=b.getLocaleKey(a)),erajs.getMessage(a,!1)},getOptionsObject:function(a){return erajs.isEmpty(a)?{}:erajs.decode(erajs.encodeToJsonStr(a))},parseBaseLocale:function(a){var b=this;$(".LANGS",a).each(function(){var a=b.getLocaleValue(this);a&&$(this).html(a)});var c=document.title,d=$(c);if(c&&d.length){var e=b.getLocaleValue(d[0]);e&&(document.title=e)}$("input:button,input:submit",a).each(function(){var a=b.getLocaleValue(this);a&&$(this).val(a)})},parseOptions:function(a,b){var c=this,d=a,e={},f=$.trim(d.attr("data-options"));if(f&&(e=c.getOptionsObject(f)),$.map(["width","height","left","top","minWidth","maxWidth","minHeight","maxHeight"],function(b){var c=$.trim(a[0].style[b]||"");c&&(-1==c.indexOf("%")&&(c=parseInt(c)||void 0),e[b]=c)}),b){for(var g={},h=0;h<b.length;h++){var i=b[h];if("string"==typeof i)g[i]=d.attr(i);else for(var j in i){var k=i[j];if("boolean"==k)g[j]=d.attr(j)?"true"==d.attr(j):void 0;else if("number"==k)g[j]="0"==d.attr(j)?0:parseFloat(d.attr(j))||void 0;else if("function"==k&&d.attr(j)){var l="on"+erajs.String.capitalize(j.substr(2));g[l]=a[0][j]}}}$.extend(e,g)}return e}},$(function(){var a=$('<div style="position:absolute;top:-1000px;width:100px;height:100px;padding:5px"></div>').appendTo("body");$._boxModel=100!=a.outerWidth(),a.remove(),erajs.windowSize={outerWidth:$(window).width(),outerHeight:$(window).height(),scrollLeft:$(document).scrollLeft(),scrollTop:$(document).scrollTop()},!window.erajsloader&&erajs.ui.parser.auto&&erajs.ui.parser.parse()})}(),!function(){function a(a,b){return(/string|function/.test(typeof b)?h:g)(a,b)}function b(a,c){return"string"!=typeof a&&(c=typeof a,"number"===c?a+="":a="function"===c?b(a.call(a)):""),a}function c(a){return m[a]}function d(a){return b(a).replace(/&(?![\w#]+;)|[<>"']/g,c)}function e(a,b){if(n(a))for(var c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)}function f(a,b){var c=/(\/)[^\/]+\1\.\.\1/,d=("./"+a).replace(/[^\/]+$/,""),e=d+b;for(e=e.replace(/\/\.\//g,"/");e.match(c);)e=e.replace(c,"/");return e}function g(b,c){var d=a.get(b)||i({filename:b,name:"Render Error",message:"Template not found"});return c?d(c):d}function h(a,b){if("string"==typeof b){var c=b;b=function(){return new l(c)}}var d=k[a]=function(c){try{return new b(c,a)+""}catch(d){return i(d)()}};return d.prototype=b.prototype=o,d.toString=function(){return b+""},d}function i(a){var b="{Template Error}",c=a.stack||"";if(c)c=c.split("\n").slice(0,2).join("\n");else for(var d in a)c+="<"+d+">\n"+a[d]+"\n\n";return function(){return"object"==typeof console&&console.error(b+"\n\n"+c),b}}function j(a,b){b=void 0!=b?b:2;var c=$.trim(l(a||"")),d=c.substr(c.length-1,1);if("%"==d)return c;var e=parseInt(c);return isNaN(e)?"auto":e-b+"px"}var k=a.cache={},l=this.String,m={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},n=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},o=a.utils={$helpers:{},$include:function(a,b,c){return a=f(c,a),g(a,b)},$string:b,$escape:d,$each:e},p=a.helpers=o.$helpers;a.get=function(a){return k[a.replace(/^\.\//,"")]},a.helper=function(a,b){p[a]=b},"function"==typeof define?define(function(){return a}):"undefined"!=typeof exports?module.exports=a:this.template=a,a.helper("getStyle",function(a,b,c){function d(a){var b=a.split(";"),c={};return $.each(b,function(a,b){if(!b)return!1;var d=b.split(":");c[d[0]]=d[1]}),c}var e={};b&&(e.width=j(b,2)),c&&(e.height=j(c,2));var f={};a&&(f=d(a));var g,h=$.extend({},f,e),i="";for(g in h)h[g],i+=g+":"+h[g]+";";return i}),a.helper("toPixel",function(a,b){return j(a,b)}),a.helper("disable",function(a){return a?'disabled="disabled"':""}),a.helper("readOnly",function(a,b){return a||!b?'readonly="readonly"':""})}(),template("tpl/button",function(a){"use strict";var b=this,c=b.$helpers,d=b.$escape,e=a.id,f=a.group,g=b.$string,h=c.getStyle,i=a.baseStyle,j=a.width,k=a.height,l=a.size,m=a.baseCls,n=a.plain,o=a.selected,p=a.iconCls,q=a.iconAlign,r=a.text,s="";return s+='<a id="',s+=d(e),s+='" xtype="button" group="',s+=d(f),s+='" style="',s+=g(h(i,j,k)),s+='" class="l-btn l-btn-',s+=d(l),s+=" ",s+=d(m),s+=" ",n&&(s+="l-btn-plain"),s+=" ",o&&(s+=" ",s+=n?" l-btn-selected l-btn-plain-selected ":" l-btn-selected ",s+=" "),s+=' "> <span class="l-btn-left',p&&(s+=" l-btn-icon-",s+=d(q)),s+='"> <span class="l-btn-text ',r||(s+="l-btn-empty"),s+='">',s+=r?g(r):"&nbsp;",s+="</span> ",p&&(s+=' <span class="l-btn-icon erayticon ',s+=d(p),s+='">&nbsp;</span> '),s+=" </span> </a>",new String(s)}),template("tpl/calendar/calendar",function(a){"use strict";var b=this,c=(b.$helpers,b.$escape),d=a.id,e=a.border,f=a.baseStyle,g=b.$each,h=a.weeks,i=(a.$value,a.$index,a.months),j=(a.list,a.i,a.value,a.j,"");return j+='<div id="',j+=c(d),j+='" xtype="calendar" class="calendar ',e||(j+="calendar-noborder"),j+='" style="',j+=c(f),j+='"> <div class="calendar-header"> <div class="calendar-nav calendar-prevmonth"></div> <div class="calendar-nav calendar-nextmonth"></div> <div class="calendar-nav calendar-prevyear"></div> <div class="calendar-nav calendar-nextyear"></div> <div class="calendar-title"> <span class="calendar-text"></span> </div> </div> <div class="calendar-body"> <table cellspacing="0" cellpadding="0" border="0" class="calendar-dtable"> <thead> <tr> ',g(h,function(a){j+=" <th>",j+=c(a),j+="</th> "}),j+=' </tr> </thead> <tbody></tbody> </table> <div class="calendar-menu" style="display: none;"> <div class="calendar-menu-year-inner"> <span class="calendar-nav calendar-menu-prev"></span> <span><input class="calendar-menu-year" type="text" /></span> <span class="calendar-nav calendar-menu-next"></span> </div> <div class="calendar-menu-month-inner"> <div class="calendar-menu-month-inner" style="height: 187px;"> <table class="calendar-mtable"> <tbody> ',g(i,function(a,b){j+=" <tr> ",g(a,function(a,d){j+=' <td class="calendar-nav calendar-menu-month" abbr="',j+=c(4*b+d+1),j+='">',j+=c(a),j+="</td> "}),j+=" </tr> "}),j+=" </tbody> </table> </div> </div> </div> </div> </div>",new String(j)}),template("tpl/tabs",function(a){"use strict";var b=this,c=(b.$helpers,b.$escape),d=a.id,e="";return e+='<div id="',e+=c(d),e+='" xtype="tabs"> <div class="tabs-header"> <div class="tabs-scroller-left" style="display: none"></div> <div class="tabs-scroller-right" style="display: none"></div> <div class="tabs-wrap"> <ul class="tabs"> </ul> </div> </div> </div> ',new String(e)}),template("tpl/textbox",function(a){"use strict";var b=this,c=b.$helpers,d=b.$escape,e=a.baseCls,f=b.$string,g=c.getStyle,h=a.baseStyle,i=a.width,j=a.height,k=a.buttonText,l=a.buttonIcon,m=a.buttonAlign,n=a.icons,o=a.iconAlign,p=b.$each,q=(a.icon,a.index,c.toPixel),r=a.iconWidth,s=a.multiline,t=a.value,u=a.prompt,v=a.readonly,w=a.editable,x=c.disable,y=a.disabled,z=c.readOnly,A=a.type,B=a.textAlign,C=a.name,D="";return D+='<span class="textbox ',D+=d(e),D+='" style="',D+=f(g(h,i,j)),D+='"> ',(k||l)&&(D+=' <a href="javascript:void(0)" class="textbox-button textbox-button-',D+=d(m),D+='" style="',D+=d(m),D+=':0px;"></a> '),D+=" ",n.length&&(D+=' <span class="textbox-addon textbox-addon-',D+=d(o),D+='"> ',p(n,function(a,b){D+=' <a href="javascript:void(0)" icon-index="',D+=d(b),D+='" class="textbox-icon erayticon ',D+=d(a.iconCls),D+='" style="width:',D+=f(q(r,0)),D+=";height:",D+=f(q(j)),D+=";line-height:",D+=f(q(j)),D+='"></a> '}),D+=" </span> "),D+=" ",s?(D+=' <textarea class="textbox-text ',!t&&u&&(D+=" textbox-prompt"),D+=" ",(v||!w)&&(D+="textbox-text-readonly"),D+='" ',D+=f(x(y)),D+=' autocomplete="off" ',D+=f(z(v,w)),D+=' placeholder="',D+=d(u),D+='">',D+=d(t),D+="</textarea> "):(D+=' <input type="',D+=d(A),D+='" class="textbox-text ',!t&&u&&(D+=" textbox-prompt"),D+=" ",(v||!w)&&(D+="textbox-text-readonly"),D+='" ',D+=f(x(y)),D+=' value="',D+=d(t),D+='" autocomplete="off" ',D+=f(z(v,w)),D+=' placeholder="',D+=d(u),D+='" style="text-align:',D+=d(B),D+=';height:16px;"> '),D+=' <input uihidden="true" class="textbox-value" type="hidden" value="',D+=d(t),D+='" ',D+=f(x(y)),D+=" ",C&&(D+=' name="',D+=d(C),D+='" '),D+="> </span>",new String(D)}),template("tpl/window/messager",function(a){"use strict";var b=this,c=(b.$helpers,a.content),d=b.$string,e=a.icon,f=b.$escape,g=a.msg,h=a.prompt,i=a.texts,j=b.$each,k=(a.$value,a.$index,"");return k+='<div class="messager-body messager-window"> ',c?(k+=" ",k+=d(c),k+=" "):(k+=" ",e&&(k+='<div class="messager-icon messager-',k+=f(e),k+='"></div>'),k+=" <div>",k+=d(g),k+="</div> "),k+=" ",h&&(k+=' <br> <div style="clear:both;"/> <div> <input class="messager-input" type="text"> </div> '),k+=' <div style="clear:both;"/> ',i&&(k+=' <div class="messager-button"> ',j(i,function(a){k+=' <a xtype="button" data-options=" text:\'',k+=f(a),k+="', baseStyle:'margin-left:10px' \" title=\"",k+=f(a),k+='"></a> '}),k+=" </div> "),k+=" </div>",new String(k)}),function(a){function b(b){var c=a.data(b.data.target,"draggable"),d=c.options,e=c.proxy,f=b.data,g=f.startLeft+b.pageX-f.startX,h=f.startTop+b.pageY-f.startY;e&&(e.parent()[0]==document.body?(g=null!=d.deltaX&&void 0!=d.deltaX?b.pageX+d.deltaX:b.pageX-b.data.offsetWidth,h=null!=d.deltaY&&void 0!=d.deltaY?b.pageY+d.deltaY:b.pageY-b.data.offsetHeight):(null!=d.deltaX&&void 0!=d.deltaX&&(g+=b.data.offsetWidth+d.deltaX),null!=d.deltaY&&void 0!=d.deltaY&&(h+=b.data.offsetHeight+d.deltaY))),b.data.parent!=document.body&&(g+=a(b.data.parent).scrollLeft(),h+=a(b.data.parent).scrollTop()),"h"==d.axis?f.left=g:"v"==d.axis?f.top=h:(f.left=g,f.top=h)}function c(b){var c=a.data(b.data.target,"draggable"),d=c.options,e=c.proxy;e||(e=a(b.data.target)),e.css({left:b.data.left,top:b.data.top}),a("body").css("cursor",d.cursor)}function d(d){a.fn.draggable.isDragging=!0;var e=a.data(d.data.target,"draggable"),f=e.options,g=a(".droppable").filter(function(){return d.data.target!=this}).filter(function(){var b=a.data(this,"droppable").options.accept;return b?a(b).filter(function(){return this==d.data.target}).length>0:!0});e.droppables=g;var h=e.proxy;return h||(f.proxy?(h="clone"==f.proxy?a(d.data.target).clone().insertAfter(d.data.target):f.proxy.call(d.data.target,d.data.target),e.proxy=h):h=a(d.data.target)),h.css("position","absolute"),b(d),c(d),f.onStartDrag.call(d.data.target,d),!1}function e(d){var e=a.data(d.data.target,"draggable");b(d),0!=e.options.onDrag.call(d.data.target,d)&&c(d);var f=d.data.target;return e.droppables.each(function(){var b=a(this);if(!b.droppable("options").disabled){var c=b.offset();d.pageX>c.left&&d.pageX<c.left+b.outerWidth()&&d.pageY>c.top&&d.pageY<c.top+b.outerHeight()?(this.entered||(a(this).trigger("_dragenter",[f]),this.entered=!0),a(this).trigger("_dragover",[f])):this.entered&&(a(this).trigger("_dragleave",[f]),this.entered=!1)}}),!1}function f(b){function c(){g&&g.remove(),f.proxy=null}function d(){var d=!1;return f.droppables.each(function(){var e=a(this);if(!e.droppable("options").disabled){var f=e.offset();return b.pageX>f.left&&b.pageX<f.left+e.outerWidth()&&b.pageY>f.top&&b.pageY<f.top+e.outerHeight()?(h.revert&&a(b.data.target).css({position:b.data.startPosition,left:b.data.startLeft,top:b.data.startTop}),a(this).trigger("_drop",[b.data.target]),c(),d=!0,this.entered=!1,!1):void 0}}),d||h.revert||c(),d}a.fn.draggable.isDragging=!1,e(b);var f=a.data(b.data.target,"draggable"),g=f.proxy,h=f.options;if(h.revert)if(1==d())a(b.data.target).css({position:b.data.startPosition,left:b.data.startLeft,top:b.data.startTop});else if(g){var i,j;g.parent()[0]==document.body?(i=b.data.startX-b.data.offsetWidth,j=b.data.startY-b.data.offsetHeight):(i=b.data.startLeft,j=b.data.startTop),g.animate({left:i,top:j},function(){c()})}else a(b.data.target).animate({left:b.data.startLeft,top:b.data.startTop},function(){a(b.data.target).css("position",b.data.startPosition)});else a(b.data.target).css({position:"absolute",left:b.data.left,top:b.data.top}),d();return h.onStopDrag.call(b.data.target,b),a(document).unbind(".draggable"),setTimeout(function(){a("body").css("cursor","")},100),!1}a.fn.draggable=function(b,c){return"string"==typeof b?a.fn.draggable.methods[b](this,c):this.each(function(){function c(b){var c=a.data(b.data.target,"draggable"),d=c.handle,e=a(d).offset(),f=a(d).outerWidth(),g=a(d).outerHeight(),h=b.pageY-e.top,i=e.left+f-b.pageX,j=e.top+g-b.pageY,k=b.pageX-e.left;return Math.min(h,i,j,k)>c.options.edge}var g,h=a.data(this,"draggable");h?(h.handle.unbind(".draggable"),g=a.extend(h.options,b)):g=a.extend({},a.fn.draggable.defaults,a.fn.draggable.parseOptions(this),b||{});var i=g.handle?"string"==typeof g.handle?a(g.handle,this):g.handle:a(this);return a.data(this,"draggable",{options:g,handle:i}),g.disabled?void a(this).css("cursor",""):void i.unbind(".draggable").bind("mousemove.draggable",{target:this},function(b){if(!a.fn.draggable.isDragging){var d=a.data(b.data.target,"draggable").options;c(b)?a(this).css("cursor",d.cursor):a(this).css("cursor","")}}).bind("mouseleave.draggable",{target:this},function(){a(this).css("cursor","")}).bind("mousedown.draggable",{target:this},function(b){if(0!=c(b)){a(this).css("cursor","");var g=a(b.data.target).position(),h=a(b.data.target).offset(),i={startPosition:a(b.data.target).css("position"),startLeft:g.left,startTop:g.top,left:g.left,top:g.top,startX:b.pageX,startY:b.pageY,offsetWidth:b.pageX-h.left,offsetHeight:b.pageY-h.top,target:b.data.target,parent:a(b.data.target).parent()[0]};a.extend(b.data,i);var j=a.data(b.data.target,"draggable").options;0!=j.onBeforeDrag.call(b.data.target,b)&&(a(document).bind("mousedown.draggable",b.data,d),a(document).bind("mousemove.draggable",b.data,e),a(document).bind("mouseup.draggable",b.data,f))}})})},a.fn.draggable.methods={options:function(b){return a.data(b[0],"draggable").options},proxy:function(b){return a.data(b[0],"draggable").proxy},enable:function(b){return b.each(function(){a(this).draggable({disabled:!1})})},disable:function(b){return b.each(function(){a(this).draggable({disabled:!0})})}},a.fn.draggable.parseOptions=function(b){var c=a(b);return a.extend({},erajs.ui.parser.parseOptions(c,["cursor","handle","axis",{revert:"boolean",deltaX:"number",deltaY:"number",edge:"number"}]),{disabled:c.attr("disabled")?!0:void 0})},a.fn.draggable.defaults={proxy:null,revert:!1,cursor:"move",deltaX:null,deltaY:null,handle:null,disabled:!1,edge:0,axis:null,onBeforeDrag:function(){},onStartDrag:function(){},onDrag:function(){},onStopDrag:function(){}},a.fn.draggable.isDragging=!1}(jQuery),function(a){function b(b){a(b).addClass("droppable"),a(b).bind("_dragenter",function(c,d){a.data(b,"droppable").options.onDragEnter.apply(b,[c,d])}),a(b).bind("_dragleave",function(c,d){a.data(b,"droppable").options.onDragLeave.apply(b,[c,d])}),a(b).bind("_dragover",function(c,d){a.data(b,"droppable").options.onDragOver.apply(b,[c,d])}),a(b).bind("_drop",function(c,d){a.data(b,"droppable").options.onDrop.apply(b,[c,d])})}a.fn.droppable=function(c,d){return"string"==typeof c?a.fn.droppable.methods[c](this,d):(c=c||{},this.each(function(){var d=a.data(this,"droppable");d?a.extend(d.options,c):(b(this),a.data(this,"droppable",{options:a.extend({},a.fn.droppable.defaults,a.fn.droppable.parseOptions(this),c)}))}))},a.fn.droppable.methods={options:function(b){return a.data(b[0],"droppable").options},enable:function(b){return b.each(function(){a(this).droppable({disabled:!1})})},disable:function(b){return b.each(function(){a(this).droppable({disabled:!0})})}},a.fn.droppable.parseOptions=function(b){var c=a(b);return a.extend({},erajs.ui.parser.parseOptions(c,["accept"]),{disabled:c.attr("disabled")?!0:void 0})},a.fn.droppable.defaults={accept:null,disabled:!1,onDragEnter:function(){},onDragOver:function(){},onDragLeave:function(){},onDrop:function(){}}}(jQuery),function(a){a.fn.resizable=function(b,c){function d(b){var c=b.data,d=a.data(c.target,"resizable").options;if(-1!=c.dir.indexOf("e")){var e=c.startWidth+b.pageX-c.startX;e=Math.min(Math.max(e,d.minWidth),d.maxWidth),c.width=e}if(-1!=c.dir.indexOf("s")){var f=c.startHeight+b.pageY-c.startY;f=Math.min(Math.max(f,d.minHeight),d.maxHeight),c.height=f}if(-1!=c.dir.indexOf("w")){var e=c.startWidth-b.pageX+c.startX;e=Math.min(Math.max(e,d.minWidth),d.maxWidth),c.width=e,c.left=c.startLeft+c.startWidth-c.width}if(-1!=c.dir.indexOf("n")){var f=c.startHeight-b.pageY+c.startY;f=Math.min(Math.max(f,d.minHeight),d.maxHeight),c.height=f,c.top=c.startTop+c.startHeight-c.height}}function e(b){var c=b.data,d=a(c.target);d.css({left:c.left,top:c.top}),d.outerWidth()!=c.width&&d._outerWidth(c.width),d.outerHeight()!=c.height&&d._outerHeight(c.height)}function f(b){return a.fn.resizable.isResizing=!0,a.data(b.data.target,"resizable").options.onStartResize.call(b.data.target,b),!1}function g(b){return d(b),0!=a.data(b.data.target,"resizable").options.onResize.call(b.data.target,b)&&e(b),!1}function h(b){return a.fn.resizable.isResizing=!1,d(b,!0),e(b),a.data(b.data.target,"resizable").options.onStopResize.call(b.data.target,b),a(document).unbind(".resizable"),a("body").css("cursor",""),!1}return"string"==typeof b?a.fn.resizable.methods[b](this,c):this.each(function(){function c(b){var c=a(b.data.target),e="",f=c.offset(),g=c.outerWidth(),h=c.outerHeight(),i=d.edge;b.pageY>f.top&&b.pageY<f.top+i?e+="n":b.pageY<f.top+h&&b.pageY>f.top+h-i&&(e+="s"),b.pageX>f.left&&b.pageX<f.left+i?e+="w":b.pageX<f.left+g&&b.pageX>f.left+g-i&&(e+="e");for(var j=d.handles.split(","),k=0;k<j.length;k++){var l=j[k].replace(/(^\s*)|(\s*$)/g,"");if("all"==l||l==e)return e}return""}var d=null,e=a.data(this,"resizable");e?(a(this).unbind(".resizable"),d=a.extend(e.options,b||{})):(d=a.extend({},a.fn.resizable.defaults,a.fn.resizable.parseOptions(this),b||{}),a.data(this,"resizable",{options:d})),1!=d.disabled&&a(this).bind("mousemove.resizable",{target:this},function(b){if(!a.fn.resizable.isResizing){var d=c(b);""==d?a(b.data.target).css("cursor",""):a(b.data.target).css("cursor",d+"-resize")}}).bind("mouseleave.resizable",{target:this},function(b){a(b.data.target).css("cursor","")}).bind("mousedown.resizable",{target:this},function(b){function d(c){var d=parseInt(a(b.data.target).css(c));return isNaN(d)?0:d}var e=c(b);if(""!=e){var i={target:b.data.target,dir:e,startLeft:d("left"),startTop:d("top"),left:d("left"),top:d("top"),startX:b.pageX,startY:b.pageY,startWidth:a(b.data.target).outerWidth(),startHeight:a(b.data.target).outerHeight(),width:a(b.data.target).outerWidth(),height:a(b.data.target).outerHeight(),deltaWidth:a(b.data.target).outerWidth()-a(b.data.target).width(),deltaHeight:a(b.data.target).outerHeight()-a(b.data.target).height()};a(document).bind("mousedown.resizable",i,f),a(document).bind("mousemove.resizable",i,g),a(document).bind("mouseup.resizable",i,h),a("body").css("cursor",e+"-resize")}})})},a.fn.resizable.methods={options:function(b){return a.data(b[0],"resizable").options},enable:function(b){return b.each(function(){a(this).resizable({disabled:!1})})},disable:function(b){return b.each(function(){a(this).resizable({disabled:!0})})}},a.fn.resizable.parseOptions=function(b){var c=a(b);return a.extend({},erajs.ui.parser.parseOptions(c,["handles",{minWidth:"number",minHeight:"number",maxWidth:"number",maxHeight:"number",edge:"number"}]),{disabled:c.attr("disabled")?!0:void 0})},a.fn.resizable.defaults={disabled:!1,handles:"n, e, s, w, ne, se, sw, nw, all",minWidth:10,minHeight:10,maxWidth:1e4,maxHeight:1e4,edge:5,onStartResize:function(){},onResize:function(){},onStopResize:function(){}},a.fn.resizable.isResizing=!1}(jQuery),function(a){function b(a,b){return"function"==typeof a?a.call(b):a}function c(a){for(;a=a.parentNode;)if(a==document)return!0;return!1}function d(b,c){this.$element=a(b),this.options=c,this.enabled=!0,this.fixTitle(),c.langid&&this.parseLangid(this),c.ref&&(this.options.title="ref")}d.prototype={show:function(){var c=this.getTitle();if(c&&this.enabled){var d=this.tip();d.find(".tipsy-inner")[this.options.html?"html":"text"](c),d[0].className="tipsy",d.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var e,f=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),g=d[0].offsetWidth,h=d[0].offsetHeight,i=b(this.options.gravity,this.$element[0]);switch(i.charAt(0)){case"n":e={top:f.top+f.height+this.options.offset,left:f.left+f.width/2-g/2};break;case"s":e={top:f.top-h-this.options.offset,left:f.left+f.width/2-g/2};break;case"e":e={top:f.top+f.height/2-h/2,left:f.left-g-this.options.offset};break;case"w":e={top:f.top+f.height/2-h/2,left:f.left+f.width+this.options.offset}}2==i.length&&(e.left="w"==i.charAt(1)?f.left+f.width/2-15:f.left+f.width/2-g+15),d.css(e).addClass("tipsy-"+i),d.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+i.charAt(0),this.options.className&&d.addClass(b(this.options.className,this.$element[0])),this.options.fade?d.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):d.css({visibility:"visible",opacity:this.options.opacity});var j=this;j.options.closeIcon&&d.find(".tipsy-close").bind("click",function(){j.hide()})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):this.tip().remove()},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("original-title"))&&a.attr("original-title",a.attr("title")||"").removeAttr("title")},clearTitle:function(){var a=this.$element;"string"==typeof a.attr("original-title")&&(a.attr("original-title",""),this.options.title="title")},getTitle:function(){var b,c=this.$element,d=this.options;this.fixTitle();{var b,d=this.options;d.langid}if("string"==typeof d.title){var e=d.title;switch(e){case"title":b=c.attr("original-title");break;case"text":b=c.text();break;case"html":b=c.html();break;case"ref":var f=d.ref;if(f)if(erajs.isInstantiate(f)){var g=erajs.getCmp(f),h=g.options&&g.options.multiple?g.options.multiple:!1;b=h?g.getValues():g.getValue()}else b=a("#"+f).val()||a("#"+f).text();break;default:b=c.attr(d.title)}}else"function"==typeof d.title&&(b=d.title.call(c[0]));return b=(""+b).replace(/(^\s*|\s*$)/,""),b||d.fallback},tip:function(){if(!this.$tip){var b='<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>';this.options.closeIcon&&(b+='<a class="tipsy-close">x</a>'),this.$tip=a('<div class="tipsy"></div>').html(b),this.$tip.data("tipsy-pointee",this.$element[0])}return this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},parseLangid:function(a){var b=a.$element,c=a.options,d=c.langid;d&&b.attr("original-title",erajs.getMessage(d,!1))}},a.fn.tipsy=function(b){function c(c){var e=a.data(c,"tipsy");return e||(e=new d(c,a.fn.tipsy.elementOptions(c,b)),a.data(c,"tipsy",e)),e}function e(){var a=c(this);a.hoverState="in",0==b.delayIn?a.show():(a.fixTitle(),setTimeout(function(){"in"==a.hoverState&&a.show()},b.delayIn))}function f(){var a=c(this);a.hoverState="out",0==b.delayOut?a.hide():setTimeout(function(){"out"==a.hoverState&&a.hide()},b.delayOut)}if(b===!0)return this.data("tipsy");if("string"==typeof b){var g=this.data("tipsy");return g&&g[b](),this}if(b=a.extend({},a.fn.tipsy.defaults,b),b.live||this.each(function(){c(this)}),"manual"!=b.trigger){var h=b.live?"live":"bind",i="hover"==b.trigger?"mouseenter":"focus",j="hover"==b.trigger?"mouseleave":"blur";this[h](i,e)[h](j,f)}return this},a.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover"},a.fn.tipsy.revalidate=function(){a(".tipsy").each(function(){var b=a.data(this,"tipsy-pointee");
b&&c(b)||a(this).remove()})},a.fn.tipsy.elementOptions=function(b,c){return a.metadata?a.extend({},c,a(b).metadata()):c},a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"},a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"},a.fn.tipsy.autoBounds=function(b,c){return function(){var d={ns:c[0],ew:c.length>1?c[1]:!1},e=a(document).scrollTop()+b,f=a(document).scrollLeft()+b,g=a(this);return g.offset().top<e&&(d.ns="n"),g.offset().left<f&&(d.ew="w"),a(window).width()+a(document).scrollLeft()-g.offset().left<b&&(d.ew="e"),a(window).height()+a(document).scrollTop()-g.offset().top<b&&(d.ns="s"),d.ns+(d.ew?d.ew:"")}}}(jQuery),function(){"use strict";erajs.ui.Button=function(a,b){a=a||{},b=b||{};var c=a.target;if(!c){var d=a.parent,e=a.contentEl;d&&(c=$("<div></div>"),c.appendTo($(d))),e&&(c=$(e))}c&&(this.target=c,$.extend(this,erajs.ui.Button.defaults,b,erajs.ui.Button.parseOptions(c),a)),this.initComponent()},erajs.ui.Button.prototype={renderTpl:function(){var a=this,b=$(a.target),c=template("tpl/button",a),d=$(c).replaceAll(b);a.target=d;var e=a.tipsy;return erajs.Object.isEmpty(e)||d.tipsy(e),d},addEvents:function(a){var b=this;a.unbind(".button").bind("focus.button",function(){b.disabled||$(this).addClass("l-btn-focus")}).bind("blur.button",function(){$(this).removeClass("l-btn-focus")}).bind("click.button",function(){return b.disabled||(b.toggle&&(b.selected?b.unselect():b.select()),b.onClick.call(this),b.handler&&b.handler.call(this)),!1})},initComponent:function(){var a=this,b=a.renderTpl();a.addEvents(b),a._setSelected(a.selected),a._setDisabled(a.disabled)},getId:function(){return this.id},getText:function(){return this.text},setIcon:function(a){var b=this,c=b.target,d=b.iconCls;b.iconCls=a,c.find("span.l-btn-icon").removeClass(d).addClass(a)},setText:function(a){this.text=a,this.initComponent()},enable:function(){this._setDisabled(!1)},disable:function(){this._setDisabled(!0)},select:function(){this._setSelected(!0)},unselect:function(){this._setSelected(!1)},destroy:function(){$(this.target).remove(),erajs.destroy(this)},_setSelected:function(a){var b=this;a?(b.group&&$('div.l-btn[group="'+b.group+'"]').each(function(){var a=this.id;if(a){var b=erajs.getCmp(a);b&&b.toggle&&($(b.target).removeClass("l-btn-selected l-btn-plain-selected"),b.selected=!1)}}),$(b.target).addClass(b.plain?"l-btn-selected l-btn-plain-selected":"l-btn-selected"),b.selected=!0):b.group||($(b.target).removeClass("l-btn-selected l-btn-plain-selected"),b.selected=!1)},_setDisabled:function(a){var b=this,c=b.target;$(c).removeClass("l-btn-disabled l-btn-plain-disabled"),a?(b.disabled=!0,c.onclick&&(b.onClick=c.onclick,c.onclick=null),$(c).addClass(b.plain?"l-btn-disabled l-btn-plain-disabled":"l-btn-disabled")):b.disabled=!1}},erajs.ui.Button.parseOptions=function(a){var b=$(a),c=$.trim($(a).html()),d=b.attr("style"),e=b.attr("class"),f={baseStyle:d?d:void 0,baseCls:e?e:void 0,disabled:b.attr("disabled")?!0:void 0,iconCls:b.attr("icon")||b.attr("iconCls")};return c&&(f.text=c),$.extend({},erajs.ui.parser.parseOptions(b,["id","iconCls","iconAlign","group","size","baseStyle","baseCls",{plain:"boolean",toggle:"boolean",selected:"boolean",onclick:"function"}]),f)},erajs.ui.Button.defaults={id:null,parent:null,contentEl:null,disabled:!1,toggle:!1,selected:!1,group:null,plain:!1,text:"",iconCls:null,iconAlign:"left",size:"small",tipsy:{},onClick:function(){}}}(),function(){function a(a,c){{var d=a.options,e=a.target,f=a.textbox;f.parent()}if(c&&(d.width=c,f.outerWidth(c)),isNaN(parseInt(d.width))){var g=$(e).clone();g.css("visibility","hidden"),g.insertAfter(e),d.width=g.outerWidth(),g.remove()}b(a)}function b(a){function b(a){return(c.iconAlign==a?l:0)+(c.buttonAlign==a?n:0)}var c=a.options,d=a.target,e=a.textbox,f=e.parent(),g=c.width;if(isNaN(g)||c.baseCls){"auto"==g&&(g="100%");var h=erajs.ui.parser.parseValue("width",g,f);h&&e.outerWidth(h)}c.width=e.width(),c.height=e.height();var i=c.height,j=e.find(".textbox-text"),k=c.iconSize,l=k*c.iconWidth,m=a.btn?!0:!1,n=m?$(a.btn.target)._outerWidth():0;if(k>0){var o=e.find(".textbox-addon");o.css({left:"left"==c.iconAlign?"left"==c.buttonAlign?n:0:"",right:"right"==c.iconAlign?"right"==c.buttonAlign?n:0:""})}if(j.css({paddingLeft:d.style.paddingLeft||"",paddingRight:d.style.paddingRight||"",marginLeft:b("left"),marginRight:b("right")}),c.multiline)j.css({paddingTop:d.style.paddingTop||"",paddingBottom:d.style.paddingBottom||""}),j._outerHeight(i);else{var p=Math.floor((i-16)/2);j.css({paddingTop:p+"px",paddingBottom:p+"px"}),j.outerHeight(i)}var q=c.width-l-n;j._outerWidth(q),c.onResize.call(a,c.width,c.height)}function c(a){var b=a.options,c=(a.target,a.textbox),d=c.find(".textbox-text");if(d.attr("placeholder",b.prompt),d.unbind(".textbox"),!b.disabled&&!b.readonly){d.bind("blur.textbox",function(){c.hasClass("textbox-focused")&&(b.value=$(this).val(),""==b.value?$(this).val(b.prompt).addClass("textbox-prompt"):$(this).removeClass("textbox-prompt"),c.removeClass("textbox-focused"),erajs.focusValidate&&$(this).trigger("focusout"))}).bind("focus.textbox",function(){$(this).val()!=b.value&&$(this).val(b.value),$(this).removeClass("textbox-prompt"),c.addClass("textbox-focused")});for(var e in b.inputEvents)d.bind(e+".textbox",{self:a},b.inputEvents[e])}var f=c.find(".textbox-addon");f.unbind().bind("click",{self:a},function(c){var d=$(c.target).closest("a.textbox-icon:not(.textbox-icon-disabled)");if(d.length){var e=parseInt(d.attr("icon-index")),f=b.icons[e];f&&f.handler&&(f.handler.call(d[0],c),b.onClickIcon.call(a,e))}}),f.find(".textbox-icon").each(function(a){var c=b.icons[a],d=$(this);!c||c.disabled||b.disabled||b.readonly?d.addClass("textbox-icon-disabled"):d.removeClass("textbox-icon-disabled")});var g=a.btn;if(g){var h=b.disabled||b.readonly;h?g.disable():g.enable()}}function d(a,b){var c=a.options;c.readonly=void 0==b?!0:b;var d=a.textbox.find(".textbox-text");d.removeAttr("readonly").removeClass("textbox-text-readonly"),(c.readonly||!c.editable)&&d.attr("readonly","readonly").addClass("textbox-text-readonly")}function e(a){var b=a.textbox,c=a.target;b.remove(),$(c).remove()}function f(a,b){var c=a.options,d=a.target,e=a.textbox;b?(c.disabled=!0,$(d).attr("disabled","disabled"),e.find(".textbox-text,.textbox-value").attr("disabled","disabled")):(c.disabled=!1,$(d).removeAttr("disabled"),e.find(".textbox-text,.textbox-value").removeAttr("disabled"))}erajs.ui.Textbox=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Textbox.defaults,erajs.ui.Textbox.parseOptions(b),a),this.id=this.options.id,this.options.originalValue=this.options.value),this.initComponent()},erajs.ui.Textbox.prototype={renderTpl:function(){var a=this,b=a.options,c=a.target,d=$(c);d.addClass("textbox-f").hide();var e=b.name;e&&d.removeAttr("name").attr("textboxName",e);var f=$.extend({},b);if(b.iconCls){var g=b.icons?$.extend(!0,[],b.icons):[];g.push({iconCls:b.iconCls,disabled:!0}),f.icons=g}b.iconSize=f.icons.length;var h=template("tpl/textbox",f);if(a.textbox=$(h).insertAfter(c),b.buttonText||b.buttonIcon){var i=a.textbox.find("a.textbox-button"),j=i[0];a.btn=new erajs.ui.Button({target:j,baseCls:j.className,baseStyle:j.style.cssText,text:b.buttonText,iconCls:b.buttonIcon,onClick:function(){b.onClickButton.call(a)}})}},addEvents:function(){var a=this,b=a.options,c=a.textbox,d=c.find(".textbox-text");if(d.unbind(".textbox"),!b.disabled&&!b.readonly){d.bind("blur.textbox",function(){if(c.hasClass("textbox-focused")){var a=$(this);b.value=a.val(),""==b.value?a.val(b.prompt).addClass("textbox-prompt"):a.removeClass("textbox-prompt"),c.removeClass("textbox-focused"),erajs.focusValidate&&a.trigger("focusout")}}).bind("focus.textbox",function(){$(this).val()!=b.value&&$(this).val(b.value),$(this).removeClass("textbox-prompt"),c.addClass("textbox-focused")});for(var e in b.inputEvents)d.bind(e+".textbox",{self:a},b.inputEvents[e])}if(b.iconSize>0){var f=c.find(".textbox-addon");f.unbind().bind("click",{self:a},function(c){var d=$(c.target).closest("a.textbox-icon:not(.textbox-icon-disabled)");if(d.length){var e=parseInt(d.attr("icon-index")),f=b.icons[e];f&&f.handler&&(f.handler.call(d[0],c),b.onClickIcon.call(a,e))}}),f.find(".textbox-icon").each(function(a){var c=b.icons[a],d=$(this);!c||c.disabled||b.disabled||b.readonly?d.addClass("textbox-icon-disabled"):d.removeClass("textbox-icon-disabled")})}var g=a.btn;g&&(b.disabled||b.readonly?g.disable():g.enable())},initComponent:function(){var a=this;a.renderTpl(),a.addEvents(),b(this)},updateTextbox:function(a){var b=this,c=$.extend({},b.options,a);b.options=c,b._render()},getTextbox:function(){var a=this;return a.textbox.find(".textbox-text")},button:function(){var a=this;return a.btn},destroy:function(){e(this),erajs.destroy(this)},resize:function(b){a(this,b)},disable:function(){f(this,!0),c(this)},enable:function(){f(this,!1),c(this)},readonly:function(a){d(this,a),c(this)},clear:function(){this.setValue("")},setText:function(a){var b=this,c=b.options,d=b.getTextbox(),e=String(a);b.getText()!==e&&(c.value=a,d.val(e)),d.is(":focus")||(erajs.isEmpty(a)?d.val(c.prompt).addClass("textbox-prompt"):d.removeClass("textbox-prompt"))},initValue:function(a){var b=this,c=b.options,d=b.target;c.value="",b.setText(a),b.textbox.find(".textbox-value").val(a),$(d).val(a)},setValue:function(a){var b=this,c=b.options,d=b.getValue();b.initValue(a),d!=a&&erajs.shouldTriggerUiChangeE(c.formTriggerChangeE)&&c.onChange.call(this,a,d)},getText:function(){var a=this,b=a.textbox,c=b.find(".textbox-text");return c.is(":focus")?c.val():a.options.value},getValue:function(){return this.options.value},reset:function(){var a=this,b=a.options;a.setValue(b.originalValue)},getIcon:function(a){var b=this;return b.textbox.find(".textbox-icon:eq("+a+")")},getTipX:function(){var a=this,b=a.options,c=a.textbox,d=c.find(".textbox-addon")._outerWidth(),e=c.find(".textbox-button")._outerWidth();return"right"==b.tipPosition?("right"==b.iconAlign?d:0)+("right"==b.buttonAlign?e:0)+1:"left"==b.tipPosition?("left"==b.iconAlign?-d:0)+("left"==b.buttonAlign?-e:0)-1:d/2*("right"==b.iconAlign?1:-1)},_render:function(){this.options;c(this),this.initValue(this.options.value)}},erajs.ui.Textbox.defaults={id:null,width:"auto",height:22,prompt:"",value:"",type:"text",textAlign:"left",formTriggerChangeE:!0,multiline:!1,editable:!0,disabled:!1,readonly:!1,icons:[],iconCls:null,iconAlign:"right",iconWidth:18,buttonText:"",buttonIcon:null,buttonAlign:"right",inputEvents:{blur:function(a){var b=a.data.self,c=b.options;b.setValue(c.value)}},onChange:function(){},onResize:function(){},onClickButton:function(){},onClickIcon:function(){}},erajs.ui.Textbox.parseOptions=function(a){var b=$(a),c=b.attr("style"),d=b.attr("class");return $.extend({},erajs.ui.parser.parseOptions(b,["id","name","prompt","iconCls","iconAlign","textAlign","buttonText","buttonIcon","buttonAlign","baseCls",{multiline:"boolean",editable:"boolean",iconWidth:"number"}]),{baseStyle:c?c:void 0,baseCls:d?d:void 0,value:b.val()||void 0,type:b.attr("type")?b.attr("type"):void 0,disabled:b.attr("disabled")?!0:void 0,readonly:b.attr("readonly")?!0:void 0})}}(),function(){erajs.ui.Filebox=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Filebox.defaults,erajs.ui.Filebox.parseOptions(b),a),this.id=this.options.id),this._render(b)},erajs.ui.Filebox.prototype={updateFilebox:function(a){var b=this;b.textbox.updateTextbox(a)},destroy:function(){var a=this;a.textbox.destroy(this),erajs.destroy(this)},resize:function(a){var b=this;b.textbox.resize(b,a)},clear:function(){var a=this;a.textbox.setValue("")},getValue:function(){var a=this;return a.textbox.textbox.find(".textbox-value").val()},disable:function(){this.options.disabled=!0,this.textbox.disable()},readonly:function(a){this.textbox.readonly(a)},enable:function(){this.options.disabled=!1,this.textbox.enable()},_render:function(a){var b=this,c=b.options,a=a||b.target;$(a).addClass("filebox-f");var d=new erajs.ui.Textbox($.extend({},c,{target:a[0],onClickButton:function(){b.filebox.find(".textbox-value").click(),c.onClickButton.call(b)}}));b.textbox=d,d.getTextbox().attr("readonly","readonly"),b.filebox=$(a).next().addClass("filebox"),b.filebox.find(".textbox-value").remove(),c.oldValue="";var e=$('<input type="file" class="textbox-value">').appendTo(b.filebox);e.attr("name",$(a).attr("textboxname")||"").change(function(){b.textbox.setText(this.value),c.onChange.call(b,this.value,c.oldValue),c.oldValue=this.value})}},erajs.ui.Filebox.defaults=$.extend({},erajs.ui.Textbox.defaults,{buttonText:"Choose File"}),erajs.ui.Filebox.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Textbox.parseOptions(b),{})}}(),function(){function init(self){function splitMenu(a){var b=[];return a.addClass("menu"),b.push(a),a.hasClass("menu-content")||a.children("div").each(function(){var a=$(this).children("div");if(a.length){a.insertAfter(target),this.submenu=a;var c=splitMenu(a);b=b.concat(c)}}),b}function createMenu(menu){var wh=erajs.ui.parser.parseOptions(menu,["width","height"]);menu[0].originalHeight=wh.height||0,menu.hasClass("menu-content")?menu[0].originalWidth=wh.width||menu._outerWidth():(menu[0].originalWidth=wh.width||0,menu.children("div").each(function(){var item=$(this),itemOpts=$.extend({},erajs.ui.parser.parseOptions(item,["name","iconCls","href",{separator:"boolean"}]),{disabled:item.attr("disabled")?!0:void 0});if(itemOpts.separator&&item.addClass("menu-sep"),itemOpts.onclick&&(item[0].onclick=eval(itemOpts.onclick||function(){})),!item.hasClass("menu-sep")){item[0].itemName=itemOpts.name||"",item[0].itemHref=itemOpts.href||"";var text=item.addClass("menu-item").html();item.empty().append($('<div class="menu-text"></div>').html(text)),itemOpts.iconCls&&$('<div class="menu-icon"></div>').addClass(itemOpts.iconCls).appendTo(item),itemOpts.disabled&&setDisabled(self,item[0],!0),item[0].submenu&&$('<div class="menu-rightarrow"></div>').appendTo(item),bindMenuItemEvent(self,item)}}),$('<div class="menu-line"></div>').prependTo(menu)),setMenuWidth(self,menu),menu.hide(),bindMenuEvent(self,menu)}var target=self.target,opts=self.options;$(target).appendTo("body"),$(target).addClass("menu-top"),$(document).unbind(".menu").bind("mousedown.menu",function(a){var b=$(a.target).closest("div.menu,div.combo-p");b.length||self.hide()});for(var menus=splitMenu($(target)),i=0;i<menus.length;i++)createMenu(menus[i])}function bindMenuEvent(a,b){b.unbind(".menu").bind("mouseenter.menu",function(){a.timer&&(clearTimeout(a.timer),a.timer=null)}).bind("mouseleave.menu",function(){a.options.hideOnUnhover&&(a.timer=setTimeout(function(){hideAll(a)},100))})}function hideAll(a){var b=a.target;return $(b).is(":visible")&&(hideMenu($(b)),a.options.onHide.call(a)),!1}function hideMenu(a){function b(a){a.stop(!0,!0),a[0].shadow&&a[0].shadow.hide(),a.hide()}a&&(b(a),a.find("div.menu-item").each(function(){this.submenu&&hideMenu(this.submenu),$(this).removeClass("menu-active")}))}function bindMenuItemEvent(a,b){b.hasClass("menu-item")&&(b.unbind(".menu"),b.bind("click.menu",function(){if(!$(this).hasClass("menu-item-disabled")){if(!this.submenu){hideAll(a);var b=$(this).attr("href");b&&(location.href=b)}var c=a.getItem(this);a.options.onClick.call(a,c)}}).bind("mouseenter.menu",function(){if(b.siblings().each(function(){this.submenu&&hideMenu(this.submenu),$(this).removeClass("menu-active")}),b.addClass("menu-active"),$(this).hasClass("menu-item-disabled"))return void b.addClass("menu-active-disabled");var c=b[0].submenu;c&&a.show({menu:c,parent:b})}).bind("mouseleave.menu",function(a){b.removeClass("menu-active menu-active-disabled");var c=b[0].submenu;c?a.pageX>=parseInt(c.css("left"))?b.addClass("menu-active"):hideMenu(c):b.removeClass("menu-active")}))}function setMenuWidth(a,b){var c=a.options,d=b.attr("style")||"";b.css({display:"block",left:-1e4,height:"auto",overflow:"hidden"});var e=b[0],f=e.originalWidth||0;f||(f=0,b.find("div.menu-text").each(function(){f<$(this)._outerWidth()&&(f=$(this)._outerWidth()),$(this).closest("div.menu-item")._outerHeight($(this)._outerHeight()+2)}),f+=40),f=Math.max(f,c.minWidth);var g=e.originalHeight||b.outerHeight(),h=Math.max(e.originalHeight,b.outerHeight())-2;b._outerWidth(f)._outerHeight(g),b.children("div.menu-line")._outerHeight(h),d+=";width:"+e.style.width+";height:"+e.style.height,b.attr("style",d)}function setDisabled(a,b,c){var d=$(b);d.hasClass("menu-item")&&(c?(d.addClass("menu-item-disabled"),b.onclick&&(b.onclick1=b.onclick,b.onclick=null)):(d.removeClass("menu-item-disabled"),b.onclick1&&(b.onclick=b.onclick1,b.onclick1=null)))}function showMenu(a,b){var c,d;b=b||{};var e=a.target,f=$(b.menu||e);if(f.hasClass("menu-top")){var g=a.options;if($.extend(g,b),c=g.left,d=g.top,g.alignTo){var h=$(g.alignTo);c=h.offset().left,d=h.offset().top+h._outerHeight(),"right"==g.align&&(c+=h.outerWidth()-f.outerWidth())}c+f.outerWidth()>$(window)._outerWidth()+$(document)._scrollLeft()&&(c=$(window)._outerWidth()+$(document).scrollLeft()-f.outerWidth()-5),0>c&&(c=0),d+f.outerHeight()>$(window)._outerHeight()+$(document).scrollTop()&&(d=$(window)._outerHeight()+$(document).scrollTop()-f.outerHeight()-5)}else{var i=b.parent;c=i.offset().left+i.outerWidth()-2,c+f.outerWidth()+5>$(window)._outerWidth()+$(document).scrollLeft()&&(c=i.offset().left-f.outerWidth()+2);var d=i.offset().top-3;d+f.outerHeight()>$(window)._outerHeight()+$(document).scrollTop()&&(d=$(window)._outerHeight()+$(document).scrollTop()-f.outerHeight()-5)}f.css({left:c,top:d}),f.show(0,function(){f[0].shadow||(f[0].shadow=$('<div class="menu-shadow"></div>').insertAfter(f)),f[0].shadow.css({display:"block",zIndex:erajs.ui.Menu.defaults.zIndex++,left:f.css("left"),top:f.css("top"),width:f.outerWidth(),height:f.outerHeight()}),f.css("z-index",erajs.ui.Menu.defaults.zIndex++),f.hasClass("menu-top")&&a.options.onShow.call(a)})}function removeItem(a,b){function c(a){if(a.submenu){a.submenu.children("div.menu-item").each(function(){c(this)});var b=a.submenu[0].shadow;b&&b.remove(),a.submenu.remove()}$(a).remove()}c(b)}function destroyMenu(a){var b=a.target;$(b).children("div.menu-item").each(function(){removeItem(a,this)}),b.shadow&&b.shadow.remove(),$(b).remove()}function findItem(a,b){function c(d){d.children("div.menu-item").each(function(){var d=a.getItem(this),g=f.empty().html(d.text).text();b==$.trim(g)?e=d:this.submenu&&!e&&c(this.submenu)})}var d=a.target,e=null,f=$("<div></div>");return c($(d)),f.remove(),e}function appendItem(self,param){var target=self.target,menu=$(target);if(param.parent){if(!param.parent.submenu){var submenu=$('<div class="menu"><div class="menu-line"></div></div>').appendTo("body");submenu.hide(),param.parent.submenu=submenu,$('<div class="menu-rightarrow"></div>').appendTo(param.parent)}menu=param.parent.submenu}if(param.separator)var item=$('<div class="menu-sep"></div>').appendTo(menu);else{var item=$('<div class="menu-item"></div>').appendTo(menu);$('<div class="menu-text"></div>').html(param.text).appendTo(item)}param.iconCls&&$('<div class="menu-icon"></div>').addClass(param.iconCls).appendTo(item),param.id&&item.attr("id",param.id),param.name&&(item[0].itemName=param.name),param.href&&(item[0].itemHref=param.href),param.onclick&&("string"==typeof param.onclick?item.attr("onclick",param.onclick):item[0].onclick=eval(param.onclick)),param.handler&&(item[0].onclick=eval(param.handler)),param.disabled&&setDisabled(target,item[0],!0),bindMenuItemEvent(self,item),bindMenuEvent(self,menu),setMenuWidth(self,menu)}erajs.ui.Menu=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c))}b&&(this.target=b,this.options=$.extend({},erajs.ui.Menu.defaults,erajs.ui.Menu.parseOptions(b),a),this.id=this.options.id,init(this)),this._render(b)},erajs.ui.Menu.prototype={updateMenu:function(a){var b=this.options;$.extend({},b,a),this._render()},show:function(a){showMenu(this,a)},hide:function(){hideAll(this)},destroy:function(){destroyMenu(this),erajs.destroy(this)},setText:function(a){$(a.target).children("div.menu-text").html(a.text)},setIcon:function(a){$(a.target).children("div.menu-icon").remove(),a.iconCls&&$('<div class="menu-icon"></div>').addClass(a.iconCls).appendTo(a.target)},getItem:function(a){var b=$(a),c={target:a,id:b.attr("id"),text:$.trim(b.children("div.menu-text").html()),disabled:b.hasClass("menu-item-disabled"),name:a.itemName,href:a.itemHref,onclick:a.onclick},d=b.children("div.menu-icon");if(d.length){for(var e=[],f=d.attr("class").split(" "),g=0;g<f.length;g++)"menu-icon"!=f[g]&&e.push(f[g]);c.iconCls=e.join(" ")}return c},findItem:function(a){var b=this;return findItem(b,a)},appendItem:function(a){appendItem(this,a)},removeItem:function(a){removeItem(this,a)},enableItem:function(a){setDisabled(this,a,!1)},disableItem:function(a){setDisabled(this,a,!0)},_render:function(a){var b=this;$(a).css({left:b.options.left,top:b.options.top})}},erajs.ui.Menu.defaults={id:null,contentEl:null,zIndex:11e4,left:0,top:0,alignTo:null,align:"left",minWidth:120,hideOnUnhover:!0,onShow:function(){},onHide:function(){},onClick:function(){}},erajs.ui.Menu.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.parser.parseOptions(b,["id","left","top",{minWidth:"number",hideOnUnhover:"boolean"}]))}}(),function(){function a(a){var c=a.options,d=new erajs.ui.Button(c);a.button=d;var e=a.target=d.target;e.removeClass(c.cls.btn1+" "+c.cls.btn2).addClass("m-btn"),e.removeClass("m-btn-small m-btn-medium m-btn-large").addClass("m-btn-"+c.size);var f=e.find(".l-btn-left");if($("<span></span>").addClass(c.cls.arrow).appendTo(f),$("<span></span>").addClass("m-btn-line").appendTo(f),c.menu){var g=$(c.menu),h=new erajs.ui.Menu($.extend({},c,{id:a.id+"-menu",target:g[0]}));a.menu=h;var i=h.options,j=i.onShow,k=i.onHide;$.extend(i,{onShow:function(){var b=this.options,c=$(b.alignTo),d=a.options;c.addClass(1==d.plain?d.cls.btn2:d.cls.btn1),j.call(this)},onHide:function(){var b=this.options,c=$(b.alignTo),d=a.options;c.removeClass(1==d.plain?d.cls.btn2:d.cls.btn1),k.call(this)}})}b(a,c.disabled)}function b(a,b){var d=a.button,e=a.target,f=a.options;f.disabled=b;var g=$(e),h=g.find("."+f.cls.trigger);if(h.length||(h=g),h.unbind(".menubutton"),b)d.disable();else{d.enable();var i=null;h.bind("click.menubutton",function(){return c(a),!1}).bind("mouseenter.menubutton",function(){return i=setTimeout(function(){c(a)},f.duration),!1}).bind("mouseleave.menubutton",function(){i&&clearTimeout(i)})}}function c(a){var b=a.options,c=a.target;if(!b.disabled&&a.menu){d(a);var e=a.menu,f=$(c);e&&(e.options.alignTo=f,e.show({alignTo:f,align:b.menuAlign})),f.blur()}}function d(a){var b=a.options;$("body>div.menu-top").hide(),$("body>div.menu-shadow").hide(),$("div[xtype='menubutton']").removeClass(b.cls.btn1).removeClass(b.cls.btn2)}erajs.ui.Menubutton=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c))}b&&(this.target=b,this.options=$.extend({},erajs.ui.Menubutton.defaults,erajs.ui.Menubutton.parseOptions(b),a),this.id=this.options.id,$(b).removeAttr("disabled")),this._render()},erajs.ui.Menubutton.prototype={menubutton:function(a){var b=$.extend(this.options,a);this.options=b},getMenu:function(){var a=this.menu;return a?a:null},enable:function(){b(this,!1)},disable:function(){b(this,!0)},destroy:function(){var a=this.options,b=this.target;a.menu&&this.menu.destroy(),$(b).remove(),erajs.destroy(this)},_render:function(){a(this)}},erajs.ui.Menubutton.defaults=$.extend({},erajs.ui.Button.defaults,{plain:!0,menu:null,menuAlign:"left",duration:100,cls:{btn1:"m-btn-active",btn2:"m-btn-plain-active",arrow:"m-btn-downarrow",trigger:"m-btn"}}),erajs.ui.Menubutton.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Button.parseOptions(a),erajs.ui.parser.parseOptions(b,["menu",{plain:"boolean",duration:"number"}]))}}(),function(){"use strict";erajs.ui.Tooltip=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c))}b&&(this.target=b,$.extend(this,this._parseOptions(),a)),this._render(b)},erajs.ui.Tooltip.prototype={id:null,position:"bottom",content:"",contentEl:null,trackMouse:!1,deltaX:0,deltaY:0,showEvent:"mouseenter",hideEvent:"mouseleave",showDelay:200,hideDelay:100,onShow:function(){},onHide:function(){},onUpdate:function(){},onPosition:function(){},onDestroy:function(){},tooltip:function(a){$.extend(this,a),this._render()},getTip:function(){var a=this;return a.tip?a.tip:void 0},getArrow:function(){var a=this,b=a.getTip();return b?b.children(".tooltip-arrow-outer,.tooltip-arrow"):null},update:function(a){var b=this;if(a&&(b.content=a),b.tip){var c="function"==typeof b.content?b.content.call(b):b.content;b.tip.children(".tooltip-content").html(c),b.onUpdate.call(b,c)}},show:function(a){var b=this,c=c||b.target,d=b.tip;d||(d=$('<div tabindex="-1" class="tooltip"><div class="tooltip-content"></div><div class="tooltip-arrow-outer"></div><div class="tooltip-arrow"></div></div>').appendTo("body"),b.tip=d,b.update()),d.removeClass("tooltip-top tooltip-bottom tooltip-left tooltip-right").addClass("tooltip-"+b.position),b.timer(),b.showTimer=setTimeout(function(){b.reposition(),d.show(),b.onShow.call(b,a);var c=d.children(".tooltip-arrow-outer"),e=d.children(".tooltip-arrow"),f="border-"+b.position+"-color";c.add(e).css({borderTopColor:"",borderBottomColor:"",borderLeftColor:"",borderRightColor:""}),c.css(f,d.css(f)),e.css(f,d.css("backgroundColor"))},b.showDelay)},hide:function(a){var b=this,c=c||b.target;c&&b.tip&&(b.timer(),b.hideTimer=setTimeout(function(){b.tip.hide(),b.onHide.call(b,a)},b.hideDelay))},timer:function(){var a=this;a.showTimer&&(clearTimeout(a.showTimer),a.showTimer=null),a.hideTimer&&(clearTimeout(a.hideTimer),a.hideTimer=null)},reposition:function(){var a=this,b=b||a.target;if(b&&a.tip){var c=$(a.tip);if(a.trackMouse){f=$();var d=a.trackMouseX+a.deltaX,e=a.trackMouseY+a.deltaY}else var f=$(b),d=f.offset().left+a.deltaX,e=f.offset().top+a.deltaY;switch(a.position){case"right":d+=f.outerWidth()+12+(a.trackMouse?12:0),e-=(c.outerHeight()-f.outerHeight())/2;break;case"left":d-=c.outerWidth()+12+(a.trackMouse?12:0),e-=(c.outerHeight()-f.outerHeight())/2;break;case"top":d-=(c.outerWidth()-f.outerWidth())/2,e-=c.outerHeight()+12+(a.trackMouse?12:0);break;case"bottom":d-=(c.outerWidth()-f.outerWidth())/2,e+=f.outerHeight()+12+(a.trackMouse?12:0)}$(b).is(":visible")||(d=-1e5,e=-1e5),c.css({left:d,top:e,zIndex:void 0!=a.zIndex?a.zIndex:erajs.zIndex}),a.onPosition.call(a,d,e)}},destroy:function(a){var b=this,a=void 0===a?!0:a;b.timer(),b.tip&&b.tip.remove(),b.title&&$(b.target).attr("title",b.title),$(b.target).unbind(".tooltip").removeClass("tooltip-f");var c=b.id;c&&a&&erajs.destroy(c),b.onDestroy.call(b)},_parseOptions:function(){var a=$(this.target),b=$.extend({},{title:a.attr("title")},erajs.ui.parser.parseOptions(a,["id","position","showEvent","hideEvent","content",{deltaX:"number",deltaY:"number",showDelay:"number",hideDelay:"number"}]));return a.attr("title",""),b.content||(b.content=b.title),b},_render:function(a){var b=this,a=a||b.target,c=$(this.target);c.unbind(".tooltip").bind(b.showEvent+".tooltip",function(c){b.show(a,c)}).bind(b.hideEvent+".tooltip",function(c){b.hide(a,c)}).bind("mousemove.tooltip",function(c){b.trackMouse&&(b.trackMouseX=c.pageX,b.trackMouseY=c.pageY,b.reposition(a))}),b.update()}}}(),function(){erajs.ui.Progressbar=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c))}b&&(this.target=b,$.extend(this,this._parseOptions(),a)),this._render(b)},erajs.ui.Progressbar.prototype={id:null,contentEl:null,width:"auto",height:22,value:0,text:"{value}%",onChange:function(){},setSize:function(a){var b=this,c=b.bar;a&&(b.width=a),c._outerWidth(b.width)._outerHeight(b.height),c.find("div.progressbar-text").width(c.width()),c.find("div.progressbar-text,div.progressbar-value").css({height:c.height()+"px",lineHeight:c.height()+"px"})},getValue:function(){return this.value},setValue:function(a){var b=this,c=b.target,d=$(c);0>a&&(a=0),a>100&&(a=100);var e=b.text.replace(/{value}/,a),f=b.value;b.value=a,d.find("div.progressbar-value").width(a+"%"),d.find("div.progressbar-text").html(e),f!=a&&b.onChange.call(this,a,f)},destroy:function(){this.spinner.remove(),erajs.destroy(this)},_init:function(a){var b=this,a=a||b.target,c=$(a);return c.addClass("progressbar"),c.html('<div class="progressbar-text"></div><div class="progressbar-value"><div class="progressbar-text"></div></div>'),c},_parseOptions:function(){var a=this,b=$(this.target),c=$.extend({},erajs.ui.parser.parseOptions(b,["id","width","height","text",{value:"number"}]),{bar:a._init()});return c},_render:function(){{var a=this,b=b||a.target;$(this.target)}a.setValue(a.value),a.setSize()}}}(),function(){"use strict";function resize(a,b){var c=(a.target,a.getPanel()),d=a.getHeader(),e=a.getBody();if(b&&$.extend(a,{width:b.width,height:b.height,minWidth:b.minWidth,maxWidth:b.maxWidth,minHeight:b.minHeight,maxHeight:b.maxHeight,left:b.left,top:b.top}),c._size(a),d.add(e)._outerWidth(c.width()),isNaN(parseInt(a.height))){e.css("height","");var f=erajs.ui.parser.parseValue("minHeight",a.minHeight,c.parent()),g=erajs.ui.parser.parseValue("maxHeight",a.maxHeight,c.parent()),h=d._outerHeight()+c._outerHeight()-c.height();e._size("minHeight",f?f-h:""),e._size("maxHeight",g?g-h:"")}else e._outerHeight(c.height()-d._outerHeight());c.css({height:"",minHeight:"",maxHeight:"",left:a.left,top:a.top}),a.onResize.apply(a,[a.width,a.height]),doLayout(a)}function doLayout(a,b){var c=a.target,d=c==$("body")[0],e=$(c).find("div.panel:visible,div.accordion:visible,div.tabs-container:visible,div.layout:visible,.erajs-fluid:visible").filter(function(a,b){var e=$(b).parents("div.panel-body:first");return d?0==e.length:e[0]==c});e.trigger("_resize",[b||!1])}function move(a,b){var c=a.getPanel();b&&(null!=b.left&&(a.left=b.left),null!=b.top&&(a.top=b.top)),c.css({left:a.left,top:a.top}),a.onMove.apply(a,[a.left,a.top])}function refresh(a){function b(a){$(c).html(a),erajs.ui.parser.parse($(c))}var c=a.target,d=a.getPanel();if(a.href){if(!a.isLoaded||!a.cache){var e=$.extend({},a.queryParams);if(0==a.onBeforeLoad.call(a,e))return;a.isLoaded=!1,clearAndFit(c),a.loadingMessage&&$(c).html($('<div class="panel-loading"></div>').html(a.loadingMessage)),a.loader.call(a,e,function(c){b(a.extractor.call(a,c)),a.onLoad.apply(a,arguments),a.isLoaded=!0},function(){a.onLoadError.apply(a,arguments)})}}else if(a.content&&!a.isLoaded){if(clearAndFit(c),b(a.content),a.iniframe){var f=d.find("iframe");f.bind({load:function(){a.onLoad.apply(a,arguments)},error:function(){a.onLoadError.apply(a,arguments)}})}a.isLoaded=!0}}function clearAndFit(a){var b=$(a);b.find("[xtype][id]").each(function(){var a=this.id;if(erajs.isInstantiate(a)){var b=erajs.getCmp(a);erajs.destroy(a);try{b.destroy()}catch(c){}}}),b.find("div").each(function(){$(this)._fit(!1)})}$.fn._remove=function(){return this.each(function(){$(this).remove()})};var TO=!1,_5b=!0;$(window).unbind(".panel").bind("resize.panel",function(){_5b&&(TO!==!1&&clearTimeout(TO),TO=setTimeout(function(){_5b=!1;var a=$("body.layout");if(a.length){var b=a[0],c=b.id;c&&erajs.getCmp(c).resize()}else $("body").children("div.panel:visible,div.accordion:visible,div.tabs-container:visible,div.layout:visible").triggerHandler("_resize");_5b=!0,TO=!1},200))}),erajs.ui.Panel=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,$.extend(this,erajs.ui.Panel.defaults,this._parseOptions(),a),$(b).attr("title","")),this._render(b)},erajs.ui.Panel.prototype={updatePanel:function(a){var b=this;$.extend(b,a),b._render()},getPanel:function(){var a=this;return a.panel},getHeader:function(){var a=this;return a.getPanel().find(">div.panel-header")},getBody:function(){var a=this;return a.getPanel().find(">div.panel-body")
},_doLayout:function(a){var b=this,a=a||b.target;$(a).find("div.panel:visible,div.accordion:visible,div.tabs-container:visible,div.layout:visible").each(function(){$(this).triggerHandler("_resize",[!0])})},expand:function(a){var b=this,c=(b.target,b.getPanel(),b.getBody()),d=b.getHeader().find("a.panel-tool-collapse");0!=b.collapsed&&(c.stop(!0,!0),0!=b.onBeforeExpand.call(b)&&(d.removeClass("panel-tool-expand"),1==a?c.slideDown("normal",function(){b.collapsed=!1,b.onExpand.call(b),refresh(b),b._doLayout()}):(c.show(),b.collapsed=!1,b.onExpand.call(b),refresh(b),b._doLayout())))},collapse:function(a){var b=this,c=(b.target,b.getPanel(),b.getBody()),d=b.getHeader().find("a.panel-tool-collapse");1!=b.collapsed&&(c.stop(!0,!0),0!=b.onBeforeCollapse.call(b)&&(d.addClass("panel-tool-expand"),1==a?c.slideUp("normal",function(){b.collapsed=!0,b.onCollapse.call(b)}):(c.hide(),b.collapsed=!0,b.onCollapse.call(b))))},restore:function(){var a=this,b=(a.target,a.getPanel()),c=a.getHeader().find("a.panel-tool-max");0!=a.maximized&&(b.show(),c.removeClass("panel-tool-restore"),a.original&&$.extend(a,a.original),a.resize(),a.minimized=!1,a.maximized=!1,a.original=null,a.onRestore.call(a))},minimize:function(){var a=this,b=(a.target,a.getPanel());b._fit(!1),b.hide(),a.minimized=!0,a.maximized=!1,a.onMinimize.call(a)},maximize:function(){var a=this,b=(a.target,a.getPanel(),a.getHeader().find("a.panel-tool-max"));1!=a.maximized&&(b.addClass("panel-tool-restore"),a.original||(a.original={width:a.width,height:a.height,left:a.left,top:a.top,fit:a.fit}),a.left=0,a.top=0,a.fit=!0,a.resize(),a.minimized=!1,a.maximized=!0,a.onMaximize.call(a))},move:function(a){move(this,a)},resize:function(a){resize(this,a)},refresh:function(a){{var b=this;b.target}b.isLoaded=!1,a&&("string"==typeof a?b.href=a:b.queryParams=a),refresh(b)},destroy:function(a){var b=this,c=b.getPanel();(1==a||0!=b.onBeforeDestroy.call(b))&&(clearAndFit(c),b._remove(c),erajs.destroy(b.id),b.onDestroy.call(b))},close:function(a){var b=this,c=(b.target,b.getPanel());(1==a||0!=b.onBeforeClose.call(b))&&(c._fit(!1),c.hide(),b.closed=!0,b.onClose.call(b))},open:function(a){var b=this,c=(b.target,b.getPanel());if(1==a||0!=b.onBeforeOpen.call(b)){c.show(),b.closed=!1,b.minimized=!1;var d=b.getHeader().find("a.panel-tool-restore");d.length&&(b.maximized=!0),b.onOpen.call(b),1==b.maximized&&(b.maximized=!1,b.maximize()),1==b.collapsed&&(b.collapsed=!1,b.collapse()),b.collapsed||(refresh(b),b._doLayout())}},setTitle:function(a){var b=this;b.title=a,b.getHeader().find("div.panel-title").html(a)},preparePanel:function(a){var b=this,a=a||b.target;$(a).addClass("panel-body");var c=$('<div class="panel"></div>').insertBefore(a);return c[0].appendChild(a),c.bind("_resize",function(){return 1==b.fit&&b.resize(),!1}),c},_parseOptions:function(){var a=this,b=$(this.target),c=b.attr("loadingMessage"),d=$.extend({},{loadingMessage:void 0!=c?c:void 0,isLoaded:!1,panel:a.preparePanel()},erajs.ui.parser.parseOptions(b,["id","width","height","left","top","title","iconCls","cls","headerCls","bodyCls","tools","href","method",{cache:"boolean",fit:"boolean",border:"boolean",noheader:"boolean"},{collapsible:"boolean",minimizable:"boolean",maximizable:"boolean"},{closable:"boolean",collapsed:"boolean",minimized:"boolean",maximized:"boolean",closed:"boolean"}]));return d},_render:function(a){{var b=this,a=a||b.target;$(this.target)}b._createHeadDom(a),b._addHeaderClass(a),1==b.doSize&&(b.panel.css("display","block"),b.resize()),1==b.closed||1==b.minimized?b.panel.hide():b.open()},getIframe:function(){var a=this,b=a.panel,c=b.find("iframe");return c},_remove:function(a){a._remove()},_addHeaderClass:function(){var a=this,b=a.panel,c=c||a.target,d=a.getHeader(),e=a.getBody();b.css(a.style),b.addClass(a.cls),a.border?(d.removeClass("panel-header-noborder"),e.removeClass("panel-body-noborder")):(d.addClass("panel-header-noborder"),e.addClass("panel-body-noborder")),d.addClass(a.headerCls),e.addClass(a.bodyCls),a.id?$(c).attr("id",a.id):$(c).attr("id","")},_createHeadDom:function(target){var me=this,panel=me.panel,target=target||me.target;if(me.tools&&"string"==typeof me.tools&&panel.find(">div.panel-header>div.panel-tool .panel-tool-a").appendTo(me.tools),panel&&panel.children("div.panel-header").each(function(){$(this).remove();try{this.outerHTML=""}catch(a){}}),null==me.title&&""!=me.title||me.noheader)panel.children("div.panel-body").addClass("panel-body-noheader");else{var pheader=$('<div class="panel-header"><div class="panel-title">'+me.title+"</div></div>").prependTo(panel);me.iconCls&&(pheader.find(".panel-title").addClass("panel-with-icon"),$('<div class="panel-icon erayticon"></div>').addClass(me.iconCls).appendTo(pheader));var ptools=$('<div class="panel-tool"></div>').appendTo(pheader);if(ptools.bind("click",function(a){a.stopPropagation()}),me.tools)if($.isArray(me.tools))for(var length=me.tools.length,i=0;length>i;i++){var toolOpts=me.tools[i],tipsy=toolOpts.tipsy,tool=$('<a href="javascript:void(0)"></a>').addClass(toolOpts.iconCls).appendTo(ptools);toolOpts.handler&&tool.bind("click",eval(me.tools[i].handler)),tipsy&&tool.tipsy(tipsy)}else{var tchildren=$(me.tools).children();tchildren.each(function(){$(this).addClass($(this).attr("iconCls")).addClass("panel-tool-a").appendTo(ptools)})}me.collapsible&&$('<a class="panel-tool-collapse" href="javascript:void(0)"></a>').appendTo(ptools).bind("click",function(){return 1==me.collapsed?me.expand(!0):me.collapse(!0),!1}),me.minimizable&&$('<a class="panel-tool-min" href="javascript:void(0)"></a>').appendTo(ptools).bind("click",function(){return me.minimize(),!1}),me.maximizable&&$('<a class="panel-tool-max" href="javascript:void(0)"></a>').appendTo(ptools).bind("click",function(){return 1==me.maximized?me.restore():me.maximize(),!1}),me.closable&&$('<a class="panel-tool-close" href="javascript:void(0)"></a>').appendTo(ptools).bind("click",function(){return"destroy"==me.closeAction?me.destroy():me.close(),!1}),panel.children("div.panel-body").removeClass("panel-body-noheader")}}},erajs.ui.Panel.parseOptions=function(a){var b=$(a),c=b.attr("loadingMessage");return $.extend({},erajs.ui.parser.parseOptions(b,["id","width","height","left","top","title","iconCls","cls","headerCls","bodyCls","tools","href","method",{cache:"boolean",fit:"boolean",border:"boolean",noheader:"boolean"},{collapsible:"boolean",minimizable:"boolean",maximizable:"boolean"},{closable:"boolean",collapsed:"boolean",minimized:"boolean",maximized:"boolean",closed:"boolean"}]),{loadingMessage:void 0!=c?c:void 0})},erajs.ui.Panel.defaults={id:null,contentEl:null,title:null,iconCls:null,width:"auto",height:"auto",left:null,top:null,cls:null,headerCls:null,bodyCls:null,style:{},cache:!0,fit:!1,border:!0,doSize:!0,noheader:!1,content:null,collapsible:!1,minimizable:!1,maximizable:!1,closable:!1,collapsed:!1,closeAction:"destroy",minimized:!1,maximized:!1,closed:!1,tools:null,queryParams:{},method:"get",href:null,loadingMessage:"Loading...",loader:function(a,b,c){var d=this;return d.href?void $.ajax({type:d.method,url:d.href,cache:!1,data:a,dataType:"html",success:function(a){b(a)},error:function(){c.apply(this,arguments)}}):!1},extractor:function(a){var b=/<body[^>]*>((.|[\n\r])*)<\/body>/im,c=b.exec(a);return c?c[1]:a},onBeforeLoad:function(){},onLoad:function(){},onLoadError:function(){},onBeforeOpen:function(){},onOpen:function(){},onBeforeClose:function(){},onClose:function(){},onBeforeDestroy:function(){},onDestroy:function(){},onResize:function(){},onMove:function(){},onMaximize:function(){},onRestore:function(){},onMinimize:function(){},onBeforeCollapse:function(){},onBeforeExpand:function(){},onCollapse:function(){},onExpand:function(){}}}(),function(){function a(){return"BackCompat"==document.compatMode?{width:Math.max(document.body.scrollWidth,document.body.clientWidth),height:Math.max(document.body.scrollHeight,document.body.clientHeight)}:{width:Math.max(document.documentElement.scrollWidth,document.documentElement.clientWidth),height:Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)}}function b(a,b){var c=a,d=c.options,e=d.height;if(isNaN(e)&&(e=c.window._outerHeight()),d.inline){var f=c.window.parent();d.top=(f.height()-e)/2+f.scrollTop()}else{var g=$(window)._outerHeight()||erajs.windowSize.outerHeight,h=$(document).scrollTop()||erajs.windowSize.scrollTop;d.top=(g-e)/2+h}b&&c.moveWindow()}function c(a,b){var c=a,d=c.options,e=d.width;if(isNaN(e)&&(e=c.window._outerWidth()),d.inline){var f=c.window.parent();d.left=(f.width()-e)/2+f.scrollLeft()}else{var g=$(window)._outerWidth()||erajs.windowSize.outerWidth,h=$(document).scrollLeft()||erajs.windowSize.scrollLeft;d.left=(g-e)/2+h}b&&c.moveWindow()}$(window).resize(function(){$("body>div.window-mask").css({width:$(window)._outerWidth(),height:$(window)._outerHeight()}),setTimeout(function(){$("body>div.window-mask").css({width:a().width,height:a().height})},50)}),erajs.ui.Window=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Window.defaults,erajs.ui.Window.parseOptions(b),a),this.id=this.options.id,this.options.inline||document.body.appendChild(b)),this._render()},erajs.ui.Window.prototype={moveWindow:function(a){var b=this,c=b.options;a&&(null!=a.left&&(c.left=a.left),null!=a.top&&(c.top=a.top)),this.panel.move(c),b.shadow&&b.shadow.css({left:c.left,top:c.top})},vcenter:function(){b(this,!0)},hcenter:function(){c(this,!0)},center:function(){c(this),b(this),this.moveWindow()},open:function(a){this.panel.open(a)},close:function(a){this.panel.close(a)},setTile:function(a){this.panel.setTitle(a)},resize:function(a){this.panel.resize(a)},maximize:function(){this.panel.maximize()},refresh:function(a){this.panel.refresh(a)},minimize:function(){this.panel.minimize()},collapse:function(a){this.panel.collapse(a)},expand:function(a){this.panel.expand(a)},destroy:function(a){this.panel.destroy(a),erajs.destroy(this)},move:function(a){this.moveWindow(a)},_create:function(){var d=this,e=d.target,f=d.options,g=f.closed,h="window-body "+(f.noheader?"window-body-noheader":"");f.bodyCls&&(h+=" "+f.bodyCls);var i=new erajs.ui.Panel($.extend({},f,{target:e,contentEl:"#"+f.id,border:!1,doSize:!0,closed:!0,minimized:!1,cls:"window",headerCls:"window-header",bodyCls:h,onBeforeDestroy:function(){return 0==f.onBeforeDestroy.call(f)?!1:(d.shadow&&d.shadow.remove(),void(d.mask&&d.mask.remove()))},onClose:function(){d.shadow&&d.shadow.hide(),d.mask&&d.mask.hide(),f.onClose.call(d)},onOpen:function(){d.mask&&d.mask.css({display:"block",zIndex:erajs.zIndex++}),d.shadow&&d.shadow.css({display:"block",zIndex:erajs.zIndex++,left:f.left,top:f.top,width:d.window._outerWidth(),height:d.window._outerHeight()}),d.window.css("z-index",erajs.zIndex++),f.onOpen.call(d)},onResize:function(a,b){var c=d.panel;c&&($.extend(d.options,{width:c.width,height:c.height,left:c.left,top:c.top}),d.shadow&&d.shadow.css({left:f.left,top:f.top,width:d.window._outerWidth(),height:d.window._outerHeight()}),f.onResize.call(d,a,b))},onMinimize:function(){d.shadow&&d.shadow.hide(),d.mask&&d.mask.hide(),f.onMinimize.call(d)},onBeforeCollapse:function(){return 0==f.onBeforeCollapse.call(f)?!1:void(d.shadow&&d.shadow.hide())},onExpand:function(){d.shadow&&d.shadow.show(),f.onExpand.call(f)}}));d.panel=i,d.window=i.panel,d.mask&&d.mask.remove(),1==f.modal&&(d.mask=$('<div class="window-mask"></div>').insertAfter(d.window),d.mask.css({width:f.inline?f.mask.parent().width():a().width,height:f.inline?f.mask.parent().height():a().height,display:"none"})),d.shadow&&d.shadow.remove(),1==f.shadow&&(d.shadow=$('<div class="window-shadow"></div>').insertAfter(d.window),d.shadow.css({display:"none"})),null==f.left&&c(d),null==f.top&&b(d),d.moveWindow(),g||i.open()},_setProperties:function(){var a=this,b=a.options;a.window.draggable({handle:">div.panel-header>div.panel-title",disabled:0==b.draggable,onStartDrag:function(b){a.proxy||(a.proxy=$('<div class="window-proxy"></div>').insertAfter(a.window)),a.proxy.css({display:"none",zIndex:erajs.zIndex++,left:b.data.left,top:b.data.top}),a.proxy._outerWidth(a.window._outerWidth()),a.proxy._outerHeight(a.window._outerHeight()),setTimeout(function(){a.proxy&&a.proxy.show()},500)},onDrag:function(b){return a.proxy.css({display:"block",left:b.data.left,top:b.data.top}),!1},onStopDrag:function(c){var d=c.data.left,e=c.data.top;b.left=d>0?d:0,b.top=e>0?e:0,a.moveWindow(b),a.proxy.remove(),a.proxy=null}}),a.window.resizable({disabled:0==b.resizable,onStartResize:function(b){a.pmask&&a.pmask.remove(),a.pmask=$('<div class="window-proxy-mask"></div>').insertAfter(a.window),a.pmask.css({zIndex:erajs.zIndex++,left:b.data.left,top:b.data.top,width:a.window._outerWidth(),height:a.window._outerHeight()}),a.proxy&&a.proxy.remove(),a.proxy=$('<div class="window-proxy"></div>').insertAfter(a.window),a.proxy.css({zIndex:erajs.zIndex++,left:b.data.left,top:b.data.top}),a.proxy._outerWidth(b.data.width)._outerHeight(b.data.height),$("iframe").each(function(){$("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:document.body.scrollWidth+"px",height:document.body.scrollHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3,top:0,left:0}).appendTo("body")})},onResize:function(b){return a.proxy.css({left:b.data.left,top:b.data.top}),a.proxy._outerWidth(b.data.width),a.proxy._outerHeight(b.data.height),!1},onStopResize:function(b){a.resize(b.data),a.pmask.remove(),a.pmask=null,a.proxy.remove(),a.proxy=null,$("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}})},_render:function(){{var a=this,b=a.target;$(b)}a._create(),a._setProperties()}},erajs.ui.Window.parseOptions=function(a){return $.extend({},erajs.ui.Panel.parseOptions(a),erajs.ui.parser.parseOptions($(a),[{draggable:"boolean",resizable:"boolean",shadow:"boolean",modal:"boolean",inline:"boolean"}]))},erajs.ui.Window.defaults=$.extend({},erajs.ui.Panel.defaults,{id:"",contentEl:null,zIndex:9e3,draggable:!0,resizable:!0,shadow:!0,modal:!1,inline:!1,title:"New Window",collapsible:!0,minimizable:!0,maximizable:!0,closable:!0,closed:!1})}(),function(){"use strict";function a(a){var c=a,e=c.target,f=$(e);f.addClass("accordion"),c.panels=[],f.children("div").each(function(){var d=$(this),e=$.extend({},erajs.ui.parser.parseOptions(d),{selected:d.attr("selected")?!0:void 0}),f=b(a,this,e);c.panels.push(f)}),f.bind("_resize",function(a,b){var e=c.options;return(1==e.fit||b)&&d(c),!1})}function b(a,b,c){var d=a,e=d.options,f=new erajs.ui.Panel($.extend({},{target:b,conentEl:b.id,collapsible:!0,minimizable:!1,maximizable:!1,closable:!1,doSize:!1,collapsed:!0,headerCls:"accordion-header",bodyCls:"accordion-body"},c,{onBeforeExpand:function(){if(c.onBeforeExpand&&0==c.onBeforeExpand.call(this))return!1;if(!e.multiple)for(var a=$.grep(d.getSelections(),function(a){return a.collapsible}),b=0;b<a.length;b++)d.unselect(d.getPanelIndex(a[b]));var f=this.getHeader();f.addClass("accordion-header-selected"),f.find(".accordion-collapse").removeClass("accordion-expand")},onExpand:function(){c.onExpand&&c.onExpand.call(this),e.onSelect.call(d,this.title,d.getPanelIndex(this))},onBeforeCollapse:function(){if(c.onBeforeCollapse&&0==c.onBeforeCollapse.call(this))return!1;var a=this.getHeader();a.removeClass("accordion-header-selected"),a.find(".accordion-collapse").addClass("accordion-expand")},onCollapse:function(){c.onCollapse&&c.onCollapse.call(this),e.onUnselect.call(a,this.title,d.getPanelIndex(this))}})),g=f.getHeader(),h=g.children("div.panel-tool");h.children("a.panel-tool-collapse").hide();var i=$('<a href="javascript:void(0)"></a>').addClass("accordion-collapse accordion-expand").appendTo(h);return i.bind("click",function(){var a=d.getPanelIndex(f);return f.collapsed?d.select(a):d.unselect(a),!1}),f.collapsible?i.show():i.hide(),g.click(function(){return $(this).find("a.accordion-collapse:visible").triggerHandler("click"),!1}),f}function c(a){var b=a,c=b.options,d=b.target,e=$(d);c.border?e.removeClass("accordion-noborder"):e.addClass("accordion-noborder")}function d(a){function b(a,b){for(var c=0,d=0;d<e.length;d++){var f=e[d],i=f.getHeader(),j=i._outerHeight(h);if(f.collapsible==a){var k=isNaN(b)?void 0:b+h*j.length;f.resize({width:g.width(),height:a?k:void 0}),c+=$(f.target).outerHeight()-h}}return c}var c=a,d=c.options,e=c.panels,f=c.target,g=$(f);d.fit?$.extend(d,g._fit()):g._fit(!1),isNaN(d.width)?g.css("width",""):g._outerWidth(d.width);var h=0,i="auto",j=g.find(">div.panel>div.accordion-header");j.length&&(h=$(j[0]).css("height","")._outerHeight()),isNaN(d.height)?g.css("height",""):(g._outerHeight(d.height),i=g.height()-h*j.length),b(!0,i-b(!1)+1)}function e(a){function b(a){var b=d.animate;d.animate=!1,c.select(a),d.animate=b}var c=a,d=c.options,e=g(c,"selected",!0);b(e?c.getPanelIndex(e):d.selected)}function f(a){for(var b=a.panels,c=0;c<b.length;c++){var d=b[c];$(d.target).stop(!0,!0)}}function g(a,b,c,d){for(var e=a,f=e.panels,g=[],h=0;h<f.length;h++){var i=f[h];if(b)i[b]==c&&g.push(i);else if(i.id==c.id||i.title==c.title)return h}return b?d?g:g.length?g[0]:null:-1}erajs.ui.Accordion=function(b){b=b||{};var c=b.target;if(!c){var d=b.contentEl;d&&(c=$(d))}c&&(this.target=c,this.options=$.extend({},erajs.ui.Accordion.defaults,erajs.ui.Accordion.parseOptions(c),b),this.panels=[],this.id=this.options.id,this.accordion=$(c).addClass("accordion"),a(this)),this._render(c)},erajs.ui.Accordion.prototype={updateAccordion:function(a){var b=this,c=$.extend(b.options,a);b.options=c,b._render()},getSelected:function(){var a=this,b=a.getSelections();return b.length?b[0]:null},getSelections:function(){var a=this;return g(a,"collapsed",!1,!0)},getPanels:function(){return this.panels},getPanel:function(a){var b=this,c=b.panels;return"number"==typeof a?0>a||a>=c.length?null:c[a]:g(b,"title",a)},getPanelIndex:function(a){return g(this,null,a)},select:function(a){var b=this,c=b.getPanel(a);if(c){f(b);var d=b.options;c.expand(d.animate)}},unselect:function(a){var b=this,c=b.getPanel(a);if(c){f(b);var d=b.options;c.collapse(d.animate)}},add:function(a){var c=this,e=c.options,g=c.panels;void 0==a.selected&&(a.selected=!0),f(c);var h=($('<div class=""></div>').appendTo(c.target),$('div.accordion>div[class=""]')[0]),i=b(c,h,a);g.push(i),d(c),e.onAdd.call(c,a.title,g.length-1),a.selected&&c.select(g.length-1)},remove:function(a){var b=this,c=b.options,e=b.panels;f(b);var g=b.getPanel(a),h=g.title,i=b.getPanelIndex(g);if(g&&0!=c.onBeforeRemove.call(b,h,i)){if(e.splice(i,1),g.destroy(),e.length){d(b);var j=b.getSelected();j||b.select(0)}c.onRemove.call(b,h,i)}},_render:function(){{var a=this;a.options}c(a),d(a),e(a)}},erajs.ui.Accordion.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.parser.parseOptions(b,["id","width","height",{fit:"boolean",border:"boolean",animate:"boolean",multiple:"boolean",selected:"number"}]))},erajs.ui.Accordion.defaults={id:null,width:"auto",height:"auto",fit:!1,border:!0,animate:!0,multiple:!1,selected:0,onSelect:function(){},onUnselect:function(){},onAdd:function(){},onBeforeRemove:function(){},onRemove:function(){}}}(),function(){"use strict";function setScrollers(a){var b=a,c=b.target,d=b.options;if("left"!=d.tabPosition&&"right"!=d.tabPosition&&d.showHeader){var e=$(c).children("div.tabs-header"),f=e.children("div.tabs-tool"),g=e.children("div.tabs-scroller-left"),h=e.children("div.tabs-scroller-right"),i=e.children("div.tabs-wrap"),j=e.outerHeight();d.plain&&(j-=j-e.height()),f._outerHeight(j);var k=0;$("ul.tabs li",e).each(function(){k+=$(this).outerWidth(!0)});var l=e.width()-f._outerWidth();k>l?(g.add(h).show()._outerHeight(j),"left"==d.toolPosition?(f.css({left:g.outerWidth(),right:""}),i.css({marginLeft:g.outerWidth()+f._outerWidth(),marginRight:h._outerWidth(),width:l-g.outerWidth()-h.outerWidth()})):(f.css({left:"",right:h.outerWidth()}),i.css({marginLeft:g.outerWidth(),marginRight:h.outerWidth()+f._outerWidth(),width:l-g.outerWidth()-h.outerWidth()}))):(g.add(h).hide(),"left"==d.toolPosition?(f.css({left:0,right:""}),i.css({marginLeft:f._outerWidth(),marginRight:0,width:l})):(f.css({left:"",right:0}),i.css({marginLeft:0,marginRight:f._outerWidth(),width:l})))}}function wrapTabs(a){var b=a,c=b.target,d=(b.options,b.tabs),e=$(c);e.addClass("tabs-container");var f=$('<div class="tabs-panels"></div>').insertBefore(e);e.children("div").each(function(){f[0].appendChild(this)}),e[0].appendChild(f[0]),$('<div class="tabs-header"><div class="tabs-scroller-left"></div><div class="tabs-scroller-right"></div><div class="tabs-wrap"><ul class="tabs"></ul></div></div>').prependTo(c),e.children("div.tabs-panels").children("div").each(function(){var b=$(this),c=$.extend({},erajs.ui.parser.parseOptions(b),{selected:b.attr("selected")?!0:void 0}),e=createTab(a,this,c);d.push(e)}),e.children("div.tabs-header").find(".tabs-scroller-left, .tabs-scroller-right").hover(function(){$(this).addClass("tabs-scroller-over")},function(){$(this).removeClass("tabs-scroller-over")}),e.bind("_resize",function(b,c){return($(this).hasClass("erajs-fluid")||c)&&(setSize(a),setSelectedSize(a)),!1})}function createTab(a,b,c){c=c||{};var d=a,e=d.target,f=$.extend({},c,{target:b,conentEl:b.id,border:!1,noheader:!0,closed:!0,doSize:!1,iconCls:c.icon?c.icon:void 0,onLoad:function(){c.onLoad&&c.onLoad.call(this,arguments),d.options.onLoad.call(d,this)}}),g=new erajs.ui.Panel(f),h=$(e).children("div.tabs-header").find("ul.tabs");return g.tab=$("<li></li>").appendTo(h),g.tab.append('<a href="javascript:void(0)" class="tabs-inner"><span class="tabs-title"></span><span class="tabs-icon erayticon"></span></a>'),d.update({tab:b,options:g}),g}function addTools(container){var me=container,opts=me.options,target=me.target,header=$(target).children("div.tabs-header");if(opts.tools)if("string"==typeof opts.tools)$(opts.tools).addClass("tabs-tool").appendTo(header),$(opts.tools).show();else{header.children("div.tabs-tool").remove();for(var tools=$('<div class="tabs-tool"><table cellspacing="0" cellpadding="0" style="height:100%"><tr></tr></table></div>').appendTo(header),tr=tools.find("tr"),i=0;i<opts.tools.length;i++){var td=$("<td></td>").appendTo(tr),tool=$("<div></div>").appendTo(td);tool[0].onclick=eval(opts.tools[i].handler||function(){}),new erajs.ui.Button($.extend({},opts.tools[i],{target:tool,plain:!0}))}}else header.children("div.tabs-tool").remove()}function setProperties(a){var b=a,c=b.options,d=b.target,e=$(d),f=e.children("div.tabs-header"),g=e.children("div.tabs-panels");f.removeClass("tabs-header-top tabs-header-bottom tabs-header-left tabs-header-right"),g.removeClass("tabs-panels-top tabs-panels-bottom tabs-panels-left tabs-panels-right"),"top"==c.tabPosition?f.insertBefore(g):"bottom"==c.tabPosition?(f.insertAfter(g),f.addClass("tabs-header-bottom"),g.addClass("tabs-panels-top")):"left"==c.tabPosition?(f.addClass("tabs-header-left"),g.addClass("tabs-panels-right")):"right"==c.tabPosition&&(f.addClass("tabs-header-right"),g.addClass("tabs-panels-left")),1==c.plain?f.addClass("tabs-header-plain"):f.removeClass("tabs-header-plain"),1==c.border?(f.removeClass("tabs-header-noborder"),g.removeClass("tabs-panels-noborder")):(f.addClass("tabs-header-noborder"),g.addClass("tabs-panels-noborder"))}function setSize(a,b){var c=a,d=c.options,e=c.target,f=$(e);b&&$.extend(d,{width:b.width,height:b.height}),f._size(d);for(var g=f.children("div.tabs-header"),h=f.children("div.tabs-panels"),i=g.find("div.tabs-wrap"),j=i.find(".tabs"),k=0;k<c.tabs.length;k++){var l=c.tabs[k],m=l.tab.find("a.tabs-inner"),n=parseInt(l.tabWidth||d.tabWidth)||void 0;n?m._outerWidth(n):m.css("width",""),m._outerHeight(d.tabHeight),m.css("lineHeight",m.height()+"px")}if("left"==d.tabPosition||"right"==d.tabPosition)g._outerWidth(d.showHeader?d.headerWidth:0),h._outerWidth(f.width()-g.outerWidth()),g.add(h)._outerHeight(d.height),i._outerWidth(g.width()),j._outerWidth(i.width()).css("height","");else{var o=g.children("div.tabs-scroller-left,div.tabs-scroller-right,div.tabs-tool");g._outerWidth(d.width).css("height",""),d.showHeader?(g.css("background-color",""),i.css("height",""),o.show()):(g.css("background-color","transparent"),g._outerHeight(0),i._outerHeight(0),o.hide()),j._outerHeight(d.tabHeight).css("width",""),setScrollers(a);var p=d.height;h._size("height",isNaN(p)?"":p-g.outerHeight());var n=d.width;h._size("width",isNaN(n)?"":n)}}function getTab(a,b,c){var d=a,e=d.tabs;if("number"==typeof b){if(0>b||b>=e.length)return null;var f=e[b];return c&&e.splice(b,1),f}for(var g=0;g<e.length;g++){var f=e[g];if(f.title==b)return c&&e.splice(g,1),f}return null}function exists(a,b){return null!=getTab(a,b)}function selectTab(a,b){var c=a,d=c.target,e=c.options,f=c.tabs,g=c.selectHis;if(0!=f.length){var h=getTab(a,b);if(h){var i=getSelectedTab(a);if(i){if(h.title==i.title)return void setSelectedSize(a);if(unselectTab(a,c.getTabIndex(i)),!i.closed)return}h.open();var j=h.title;g.push(j);var k=h.tab;k.addClass("tabs-selected");var l=$(d),m=l.find(">div.tabs-header>div.tabs-wrap"),n=k.position().left,o=n+k.outerWidth();if(0>n||o>m.width()){var p=n-(m.width()-k.width())/2;c.scrollBy(p)}else c.scrollBy(0);setSelectedSize(a),c.lastSelectTab=h,e.onSelect.call(c,j,c.getTabIndex(h))}}}function unselectTab(a,b){var c=a,d=getTab(a,b);d&&(d.closed||(d.close(),d.closed&&(d.tab.removeClass("tabs-selected"),c.options.onUnselect.call(a,d.title,c.getTabIndex(d)))))}function getSelectedTab(a){for(var b=a,c=b.tabs,d=0;d<c.length;d++){var e=c[d];if(0==e.closed)return e}return null}function setSelectedSize(a){var b=a,c=b.target,d=b.options,e=getSelectedTab(a);if(e){var f=$(c).children("div.tabs-panels"),g="auto"==d.width?"auto":f.width(),h="auto"==d.height?"auto":f.height();e.resize({width:g,height:h})}}function closeTab(a,b){var c=a,d=c.options,e=c.tabs,f=c.selectHis,g=exists(a,b);if(g){var h=getTab(a,b),i=h.title,j=c.getTabIndex(h);if(0!=d.onBeforeClose.call(c,i,j)){var h=getTab(a,b,!0);h.tab.remove(),h.destroy(),d.onClose.call(c,i,j),setSize(a);for(var k=0;k<f.length;k++)f[k]==i&&(f.splice(k,1),k--);var l=f.pop();l?selectTab(a,l):e.length&&selectTab(a,0)}}}function showHeader(a,b){var c=a,d=c.options;d.showHeader=b,c.resize()}function bindEvents(a){function b(a){var b=0;return a.parent().children("li").each(function(c){return a[0]==this?(b=c,!1):void 0}),b}var c=a,d=c.options,e=c.target;$(e).children("div.tabs-header").unbind().bind("click",function(a){if($(a.target).hasClass("tabs-scroller-left"))c.scrollBy(-d.scrollIncrement);else if($(a.target).hasClass("tabs-scroller-right"))c.scrollBy(d.scrollIncrement);else{var e=$(a.target).closest("li");if(e.hasClass("tabs-disabled"))return;var f=$(a.target).closest("a.tabs-close");if(f.length)closeTab(c,b(e));else if(e.length){var g=b(e),h=c.tabs[g],i=d.onBeforeLeave.call(c,c.lastSelectTab);if(0==i)return;h.collapsible?h.closed?selectTab(c,g):unselectTab(c,g):selectTab(c,g)}}})}function doFirstSelect(a){for(var b=a,c=b.tabs,d=0;d<c.length;d++)if(c[d].selected)return void selectTab(a,d);selectTab(a,b.options.selected)}function addTab(a,b){var c=a,d=c.target,e=c.options,f=c.tabs;void 0==b.selected&&(b.selected=!0);var g=$("<div></div>").appendTo($(d).children("div.tabs-panels")),h=createTab(a,g[0],b);f.push(h),e.onAdd.call(c,b.title,f.length-1),setSize(c),b.selected&&selectTab(a,f.length-1)}erajs.ui.Tabs=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c))}b&&(this.target=b,this.options=$.extend({},erajs.ui.Tabs.defaults,erajs.ui.Tabs.parseOptions(b),a),this.tabs=[],this.id=this.options.id,this.selectHis=[],wrapTabs(this)),this._render(b)},erajs.ui.Tabs.prototype={updateTabs:function(a){var b=this,c=$.extend(b.options,a);b.options=c,b._render()},resize:function(a){var b=this;setSize(b,a),setSelectedSize(b)},add:function(a){addTab(this,a)},close:function(a){var b=this;closeTab(b,a)},getTab:function(a){var b=this;return getTab(b,a)},getTabIndex:function(a){for(var b=this,c=b.tabs,d=0;d<c.length;d++)if(c[d].id==a.id)return d;return-1},getSelected:function(){return getSelectedTab(this)},select:function(a){var b=this;selectTab(b,a)},unselect:function(a){unselectTab(this,a)},exists:function(a){var b=this;return exists(b,a)},updateTab:function(a){var b=this,c=a.which,d=(a.options,b.getTab(c));if(d){var e=$.extend(d,a.options,{iconCls:a.options.icon?a.options.icon:void 0});d.updatePanel(e),b.update({tab:d.tab,options:e})}},update:function(a){var b=this,c=(b.selectHis,a.tab),d=a.options,e=(d.title,d.tab),f=e.find("span.tabs-title"),g=e.find("span.tabs-icon");if(f.html(d.title),g.attr("class","tabs-icon erayticon"),e.find("a.tabs-close").remove(),d.closable?(f.addClass("tabs-closable"),$('<a href="javascript:void(0)" class="tabs-close"></a>').appendTo(e)):f.removeClass("tabs-closable"),d.iconCls?(f.addClass("tabs-with-icon"),g.addClass(d.iconCls)):f.removeClass("tabs-with-icon"),e.find("span.tabs-p-tool").remove(),d.tools){var h=$('<span class="tabs-p-tool"></span>').insertAfter(e.find("a.tabs-inner"));if($.isArray(d.tools))for(var i=0;i<d.tools.length;i++){var j=$('<a href="javascript:void(0)"></a>').appendTo(h);j.addClass(d.tools[i].iconCls),d.tools[i].handler&&j.bind("click",{handler:d.tools[i].handler},function(a){$(this).parents("li").hasClass("tabs-disabled")||a.data.handler.call(this)})}else $(d.tools).children().appendTo(h);var k=12*h.children().length;d.closable?k+=8:(k-=3,h.css("right","5px")),f.css("padding-right",k+"px")}setSize(b),b.options.onUpdate.call(b,d.title,b.getTabIndex(c))},enableTab:function(a){var b=this,c=b.getTab(a);c&&c.tab.removeClass("tabs-disabled")},disableTab:function(a){var b=this,c=b.getTab(a);c&&c.tab.addClass("tabs-disabled")},showHeader:function(){showHeader(this,!0)},hideHeader:function(){showHeader(this,!1)},scrollBy:function(a){function b(){var a=0,b=f.children("ul");return b.children("li").each(function(){a+=$(this).outerWidth(!0)}),a-f.width()+(b.outerWidth()-b.width())}var c=this,d=c.target,e=c.options,f=$(d).find(">div.tabs-header>div.tabs-wrap"),g=Math.min(f._scrollLeft()+a,b());f.animate({scrollLeft:g},e.scrollDuration)},_render:function(){addTools(this),setProperties(this),setSize(this),bindEvents(this),doFirstSelect(this)}},erajs.ui.Tabs.defaults={id:null,width:"auto",height:"auto",headerWidth:150,tabWidth:"auto",tabHeight:27,selected:0,showHeader:!0,plain:!1,fit:!1,border:!0,tools:null,toolPosition:"right",tabPosition:"top",scrollIncrement:100,scrollDuration:400,onLoad:function(){},onSelect:function(){},onUnselect:function(){},onBeforeClose:function(){},onBeforeLeave:function(){},onClose:function(){},onAdd:function(){},onUpdate:function(){},onContextMenu:function(){}},erajs.ui.Tabs.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.parser.parseOptions(b,["id","width","height","tools","toolPosition","tabPosition",{fit:"boolean",border:"boolean",plain:"boolean",headerWidth:"number",tabWidth:"number",tabHeight:"number",selected:"number",showHeader:"boolean"}]))}}(),function(){"use strict";function a(a,c){function d(a,c){if(a&&b(a)){a.resize({width:j.width(),height:a.height});var d=a.getPanel().outerHeight();a.move({left:0,top:"n"==c?0:j.height()-d}),k.height-=d,"n"==c&&(k.top+=d,!a.split&&a.border&&k.top--),!a.split&&a.border&&k.height++}}function e(a,c){if(a&&b(a)){{({width:a.width,height:k.height})}a.resize({width:a.width,height:k.height});var d=a.getPanel().outerWidth();a.move({left:"e"==c?j.width()-d:0,top:k.top}),k.width-=d,"w"==c&&(k.left+=d,!a.split&&a.border&&k.left--),!a.split&&a.border&&k.width++}}var f=a,g=f.target,h=f.options,i=f.panels,j=$(g);c&&$.extend(h,{width:c.width,height:c.height}),"body"==g.tagName.toLowerCase()?(h.fit=!0,j._size(h,$("body"))._size("clear")):j._size(h);var k={top:0,left:0,width:j.width(),height:j.height()};d(b(i.expandNorth)?i.expandNorth:i.north,"n"),d(b(i.expandSouth)?i.expandSouth:i.south,"s"),e(b(i.expandEast)?i.expandEast:i.east,"e"),e(b(i.expandWest)?i.expandWest:i.west,"w"),i.center.resize(k)}function b(a){return a?a.getPanel().is(":visible"):!1
}function c(b,c,d){var f=b,g=f.target;c.region=c.region||"center";var h=f.panels,j=$(g),k=c.region;if(!h[k]){var l=$(d);l.length||(l=$("<div></div>").appendTo(j));var m=$.extend({},erajs.ui.Layout.paneldefaults,{target:l[0],conentEl:l.id,width:l.length?parseInt(l[0].style.width)||l.outerWidth():"auto",height:l.length?parseInt(l[0].style.height)||l.outerHeight():"auto",doSize:!1,collapsible:!0,cls:"layout-panel layout-panel-"+k,bodyCls:"layout-body",onOpen:function(){var a=this,c=(a.target,a.getHeader().children("div.panel-tool"));c.children("a.panel-tool-collapse").hide();var d={north:"up",south:"down",east:"right",west:"left"};if(d[k]){var f="layout-button-"+d[k],g=c.children("a."+f);g.length||(g=$('<a href="javascript:void(0)"></a>').addClass(f).appendTo(c),g.bind("click",{dir:k},function(a){return e(b,a.data.dir),!1})),a.collapsible?g.show():g.hide()}}},c),n=new erajs.ui.Panel(m);if(h[k]=n,n.split){var o=n.panel;o.addClass("layout-split-"+k);var p="";"north"==k&&(p="s"),"south"==k&&(p="n"),"east"==k&&(p="w"),"west"==k&&(p="e"),o.resizable($.extend({},{handles:p,onStartResize:function(){if(i=!0,"north"==k||"south"==k)var a=$(">div.layout-split-proxy-v",g);else var a=$(">div.layout-split-proxy-h",g);var b={display:"block"};"north"==k?(b.top=parseInt(o.css("top"))+o.outerHeight()-a.height(),b.left=parseInt(o.css("left")),b.width=o.outerWidth(),b.height=a.height()):"south"==k?(b.top=parseInt(o.css("top")),b.left=parseInt(o.css("left")),b.width=o.outerWidth(),b.height=a.height()):"east"==k?(b.top=parseInt(o.css("top"))||0,b.left=parseInt(o.css("left"))||0,b.width=a.width(),b.height=o.outerHeight()):"west"==k&&(b.top=parseInt(o.css("top"))||0,b.left=o.outerWidth()-a.width(),b.width=a.width(),b.height=o.outerHeight()),a.css(b),$('<div class="layout-mask"></div>').css({left:0,top:0,width:j.width(),height:j.height()}).appendTo(j)},onResize:function(a){if("north"==k||"south"==k){var b=$(">div.layout-split-proxy-v",g);b.css("top",a.pageY-$(g).offset().top-b.height()/2)}else{var b=$(">div.layout-split-proxy-h",g);b.css("left",a.pageX-$(g).offset().left-b.width()/2)}return!1},onStopResize:function(b){j.children("div.layout-split-proxy-v,div.layout-split-proxy-h").hide(),n.resize(b.data),a(f),i=!1,j.find(">div.layout-mask").remove()}},c))}}}function d(a,b){var c=a,d=c.panels;if(d[b]){d[b].destroy(),d[b]=null;var e="expand"+b.substring(0,1).toUpperCase()+b.substring(1);d[e]&&(d[e].destroy(),d[e]=void 0)}}function e(a,c,d){function g(b){var d;"east"==b?d="layout-button-left":"west"==b?d="layout-button-right":"north"==b?d="layout-button-down":"south"==b&&(d="layout-button-up");{var e=$("<div></div>").appendTo(l),g=$.extend({},erajs.ui.Layout.paneldefaults,{target:e[0],cls:"layout-expand layout-expand-"+b,title:"&nbsp;",closed:!0,minWidth:0,minHeight:0,doSize:!1,tools:[{iconCls:d,handler:function(){return f(a,c),!1}}]}),h=new erajs.ui.Panel(g);h.target}return h.getPanel().hover(function(){$(this).addClass("layout-expand-over")},function(){$(this).removeClass("layout-expand-over")}),h}function h(){var a=$(l),d=k.center,e=m.collapsedSize;if("east"==c){var f=m.getPanel()._outerWidth(),g=d.width+f-e;return(m.split||!m.border)&&g++,{resizeC:{width:g},expand:{left:a.width()-f},expandP:{top:d.top,left:a.width()-e,width:e,height:d.height},collapse:{left:a.width(),top:d.top,height:d.height}}}if("west"==c){var h=m.getPanel()._outerWidth(),g=d.width+h-e;return(m.split||!m.border)&&g++,{resizeC:{width:g,left:e-1},expand:{left:0},expandP:{left:0,top:d.top,width:e,height:d.height},collapse:{left:-h,top:d.top,height:d.height}}}if("north"==c){var i=m.getPanel()._outerHeight(),j=d.height;b(k.expandNorth)||(j+=i-e+(m.split||!m.border?1:0));var n=k.east,o=k.west,p=k.expandEast,q=k.expandWest;return n&&n.resize({top:e-1,height:j}),o&&o.resize({top:e-1,height:j}),p&&p.resize({top:e-1,height:j}),q&&q.resize({top:e-1,height:j}),{resizeC:{top:e-1,height:j},expand:{top:0},expandP:{top:0,left:0,width:a.width(),height:e},collapse:{top:-i,width:a.width()}}}if("south"==c){var i=m.getPanel()._outerHeight(),j=d.height;b(k.expandSouth)||(j+=i-e+(m.split||!m.border?1:0));var n=k.east,o=k.west,p=k.expandEast,q=k.expandWest;return n&&n.resize({height:j}),o&&o.resize({height:j}),p&&p.resize({height:j}),q&&q.resize({height:j}),{resizeC:{height:j},expand:{top:a.height()-i},expandP:{top:a.height()-e,left:0,width:a.width(),height:e},collapse:{top:a.height(),width:a.width()}}}}void 0==d&&(d="normal");var j=a,k=j.panels,l=j.target,m=k[c];if(0!=m.onBeforeCollapse.call(m)){var n="expand"+c.substring(0,1).toUpperCase()+c.substring(1);if(!k[n]){var o=g(c);k[n]=o;var p=o.target;$(p).bind("click",function(){var b=h();return m.expand(!1),m.open(),m.resize(b.collapse),$(m.target).animate(b.expand,function(){$(this).unbind(".layout").bind("mouseleave.layout",{region:c},function(b){1!=i&&($("body>div.combo-p>div.combo-panel:visible").length||e(a,b.data.region))})}),!1})}var q=h();b(k[n])||k.center.resize(q.resizeC);var r=m.target;$(r).animate(q.collapse,d,function(){m.collapse(!1),m.close(),k[n].open(),k[n].resize(q.expandP),$(this).unbind(".layout")})}}function f(b,c){function d(){var a=$(g),b=f.center;return"east"==c&&f.expandEast?{collapse:{left:a.width(),top:b.top,height:b.height},expand:{left:a.width()-h.getPanel()._outerWidth()}}:"west"==c&&f.expandWest?{collapse:{left:-h.getPanel()._outerWidth(),top:b.top,height:b.height},expand:{left:0}}:"north"==c&&f.expandNorth?{collapse:{top:-h.getPanel()._outerHeight(),width:a.width()},expand:{top:0}}:"south"==c&&f.expandSouth?{collapse:{top:a.height(),width:a.width()},expand:{top:a.height()-h.getPanel()._outerHeight()}}:void 0}var e=b,f=e.panels,g=e.target,h=f[c];if(0!=h.onBeforeExpand.call(h)){var i=d(),j="expand"+c.substring(0,1).toUpperCase()+c.substring(1);if(f[j]){f[j].close();var k=h.getPanel();k.stop(!0,!0),h.expand(!1),h.open(),h.resize(i.collapse),k.animate(i.expand,function(){a(b)})}}}function g(b){function d(a){a.children("div").each(function(){var a=erajs.ui.Layout.parsePanelOptions(this);"north,south,east,west,center".indexOf(a.region)>=0&&c(e,a,this)})}var e=b,f=e.target,g=$(f);g.addClass("layout"),d(g.children("form").length?g.children("form"):g),g.append('<div class="layout-split-proxy-h"></div><div class="layout-split-proxy-v"></div>'),g.bind("_resize",function(b,c){e.options;return($(this).hasClass("erajs-fluid")||c)&&a(e),!1})}function h(a){var b=a.panels;b.east&&b.east.collapsed&&e(a,"east",0),b.west&&b.west.collapsed&&e(a,"west",0),b.north&&b.north.collapsed&&e(a,"north",0),b.south&&b.south.collapsed&&e(a,"south",0)}var i=!1;erajs.ui.Layout=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c))}b&&(this.target=b,this.options=$.extend({},erajs.ui.Layout.defaults,erajs.ui.Layout.parseOptions(b),a),this.id=this.options.id,this.panels={center:null,north:null,south:null,east:null,west:null},g(this)),this._render(b)},erajs.ui.Layout.prototype={resize:function(b){a(this,b)},panel:function(a){var b=this.panels;return b[a]},collapse:function(a){e(this,a)},expand:function(a){f(this,a)},add:function(b){c(this,b),a(this);var d=b.region,f=this.panel(d);f.collapsed&&e(this,d,0)},remove:function(b){d(this,b),a(this)},_render:function(){a(this),h(this)}},erajs.ui.Layout.defaults={fit:!1},erajs.ui.Layout.paneldefaults=$.extend({},erajs.ui.Panel.defaults,{region:null,split:!1,collapsedSize:28,minWidth:10,minHeight:10,maxWidth:1e4,maxHeight:1e4}),erajs.ui.Layout.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.parser.parseOptions(b,["id",{fit:"boolean"}]))},erajs.ui.Layout.parsePanelOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Panel.parseOptions(a),erajs.ui.parser.parseOptions(b,["id","region",{split:"boolean",collpasedSize:"number",minWidth:"number",minHeight:"number",maxWidth:"number",maxHeight:"number"}]))}}(),function(){function a(a,b){$.isArray(b)||(b=[b]);var d=a.options,e=a.target,f=a.combo,g=c(a);f.find(".textbox-value").remove();for(var h=d.name||$(e).attr("textboxName"),i=0;i<b.length;i++){var j=$('<input type="hidden" uihidden="true" class="textbox-value">').appendTo(f);j.attr("name",h),d.disabled&&j.attr("disabled","disabled"),j.val(b[i])}if(erajs.shouldTriggerUiChangeE(d.formTriggerChangeE)){var k=function(){if(g.length!=b.length)return!0;var a=$.extend(!0,[],g),c=$.extend(!0,[],b);a.sort(),c.sort();for(var d=0;d<a.length;d++)if(a[d]!=c[d])return!0;return!1}();k&&(d.multiple?d.onChange.call(a,b,g):d.onChange.call(a,b[0],g[0]))}}function b(b,c){a(b,[c])}function c(a){var b=[],c=a.combo;return c.find(".textbox-value").each(function(){b.push($(this).val())}),b}function d(a){var b=c(a);return b[0]}function e(a,b){var c=a.textbox,d=c.getText();d!=b&&(c.setText(b),a.previousText=b)}function f(a){function b(){var a=e.offset().left;return"right"==d.panelAlign&&(a+=e._outerWidth()-h._outerWidth()),a+h._outerWidth()>$(window)._outerWidth()+$(document).scrollLeft()&&(a=$(window)._outerWidth()+$(document).scrollLeft()-h._outerWidth()),0>a&&(a=0),a}function c(){var a=e.offset().top+e._outerHeight();return a+h._outerHeight()>$(window)._outerHeight()+$(document).scrollTop()&&(a=e.offset().top-h._outerHeight()),a<$(document).scrollTop()&&(a=e.offset().top+e._outerHeight()),a}var d=a.options,e=a.combo,f=a.panel,g=f.target,h=$(g);f.move({left:b(),top:c()}),f.closed&&(f.open(),f.resize({width:d.panelWidth?d.panelWidth:e._outerWidth(),height:d.panelHeight}),d.onShowPanel.call(a)),function(){h.is(":visible")&&(f.move({left:b(),top:c()}),setTimeout(arguments.callee,200))}()}function g(a){$(a).find(".combo-f").each(function(){var a=this.id;if(a){var b=erajs.getCmp(a);if(b){var c=b.panel;c.panel.is(":visible")&&c.close()}}})}function h(c){var d=c.options,e=(c.target,d.onChange);d.onChange=function(){},d.multiple?a(c,d.value?d.value:[]):b(c,d.value),d.onChange=e}function i(){$(document).unbind(".combo").bind("mousedown.combo",function(a){var b=$(a.target).closest("span.combo,div.combo-p");return b.length?void g(b):void $("body>div.combo-p>div.combo-panel:visible").each(function(){k(this)})})}function j(a){var b=a.options,c=a.target,d=a.panel;if(b.editable){var e=$(c).closest("div.combo-panel");$("div.combo-panel:visible").not(d.target).not(e).each(function(){k(this)})}else o(a)}function k(a){var b=$(a).attr("combpanelid");if(b){var c=erajs.getCmp(b);try{var d=c.options,e=c.xtype;"combobox"==e&&d&&d.editable&&!c.getValue()&&c.clear(),c.hidePanel()}catch(f){}}}function l(a){var b=a.panel;b.close()}function m(a){var b=a.options,c=a.target,d=$(c);if(!a.panel){var e=null,f=b.panelEl;e=f?$(f).addClass("combo-panel"):$('<div class="combo-panel"></div>').appendTo("body"),e.attr("combPanelId",a.id),a.panel=new erajs.ui.Panel({target:e[0],minWidth:b.panelMinWidth,maxWidth:b.panelMaxWidth,minHeight:b.panelMinHeight,maxHeight:b.panelMaxHeight,doSize:!1,closed:!0,cls:"combo-p",style:{position:"absolute",zIndex:erajs.zIndex++},onOpen:function(){var b=a.panel,c=$(b.target);erajs.ui.Menu?c.css("z-index",erajs.ui.Menu.defaults.zIndex++):erajs.ui.Window&&c.css("z-index",erajs.ui.Window.defaults),b.resize()},onBeforeClose:function(){g(this.panel)},onClose:function(){a.options.onHidePanel.call(a)}})}var h=$.extend(!0,[],b.icons);b.hasDownArrow&&h.push({iconCls:"combo-arrow",handler:function(){o(a)}}),d.addClass("combo-f"),a.textbox=new erajs.ui.Textbox($.extend({},b,{target:$(c)[0],icons:h,baseCls:"combo",onChange:function(){},inputEvents:{click:function(){j(a)},keydown:function(b){n(a,b)},paste:function(b){n(a,b)},drop:function(b){n(a,b)}}})),b.name&&d.attr("comboName",b.name),a.combo=a.textbox.textbox}function n(a,b){var c=a.options;switch(b.keyCode){case 38:c.keyHandler.up.call(a,b);break;case 40:c.keyHandler.down.call(a,b);break;case 37:c.keyHandler.left.call(a,b);break;case 39:c.keyHandler.right.call(a,b);break;case 13:return b.preventDefault(),c.keyHandler.enter.call(a,b),!1;case 9:case 27:l(a);break;default:c.editable&&(a.timer&&clearTimeout(a.timer),a.timer=setTimeout(function(){var d=a.textbox.textbox.find(".textbox-text").val();a.previousText!=d&&(a.previousText=d,a.showPanel(),c.keyHandler.query.call(a,d,b))},c.delay))}}function o(a){var b=a.target,c=(a.options,a.panel),d=c.panel;if(d.is(":visible"))l(a);else{var e=$(b).closest("div.combo-panel");$("div.combo-panel:visible").not(c.target).not(e).each(function(){k(this)}),a.showPanel()}a.textbox.textbox.find(".textbox-text").focus()}erajs.ui.Combo=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Combo.defaults,erajs.ui.Combo.parseOptions(b),a),this.id=this.options.id,this.previousText="",this.options.originalValue=this.options.value),this._render(b)},erajs.ui.Combo.prototype={updateCombo:function(a){var b=this,c=$.extend({},b.options,a);b.options=c,b._render()},getTextbox:function(){return this.textbox},destroy:function(){var a=this;a.panel.destroy(),a.textbox.destroy(),erajs.destroy(this)},resize:function(a){var b=this.getTextbox();b.resize(a)},showPanel:function(){f(this)},hidePanel:function(){l(this)},disable:function(){this.options.disabled=!0;var a=this.getTextbox();a.disable()},enable:function(){this.options.disabled=!1;var a=this.getTextbox();a.enable()},readonly:function(a){var b=this.getTextbox();b.readonly(a)},clear:function(){var a=this,b=a.options,c=a.combo,d=a.getTextbox();d.clear(),b.multiple?c.find(".textbox-value").remove():c.find(".textbox-value").val("")},reset:function(){var a=this,b=a.options;b.multiple?a.setValues(b.originalValue):a.setValue(b.originalValue)},getText:function(){return this.getTextbox().getText()},setText:function(a){e(this,a)},getValues:function(){return c(this)},setValues:function(b){a(this,b)},getValue:function(){return d(this)},setValue:function(a){b(this,a)},_render:function(){m(this),i(this),h(this)}},erajs.ui.Combo.defaults=$.extend({},erajs.ui.Textbox.defaults,{contentEl:null,panelEl:null,panelWidth:null,panelHeight:200,panelAlign:"left",multiple:!1,selectOnNavigation:!0,separator:",",hasDownArrow:!0,delay:200,keyHandler:{up:function(){},down:function(){},left:function(){},right:function(){},enter:function(){},query:function(){}},onShowPanel:function(){},onHidePanel:function(){},onChange:function(){}}),erajs.ui.Combo.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Textbox.parseOptions(a),erajs.ui.parser.parseOptions(b,["id","separator","panelAlign",{panelWidth:"number",hasDownArrow:"boolean",delay:"number",selectOnNavigation:"boolean"},{panelMinWidth:"number",panelMaxWidth:"number",panelMinHeight:"number",panelMaxHeight:"number"}]),{panelHeight:"auto"==b.attr("panelHeight")?"auto":parseInt(b.attr("panelHeight"))||void 0,multiple:b.attr("multiple")?!0:void 0})}}(),function(){"use strict";function a(a,b){for(var c=a.options,d=a.data,e=0;e<d.length;e++)if(d[e][c.valueField]==b)return e;return-1}function b(a,b){var c=a.options,d=a.combo,e=d.panel.target,f=$(e),g=c.finder.getEl(a,b);if(g.length){var h=g.position().top,i=g.outerHeight(),j=f.height();if(0>=h){var k=f.scrollTop()+h;f.scrollTop(k)}else if(h+i>j){var k=f.scrollTop()+h+i-j;f.scrollTop(k)}}}function c(a,b,c){var d=a.options;a.data=d.loadFilter.call(a,b),a.groups=[],b=a.data;var e=a.getValues(),f=[],g=void 0,i=d.autoValueIndex,j=!1;null!=i&&i<=b.length&&(j=!0);for(var k=0;k<b.length;k++){var l=b[k],m=l[d.valueField]+"",n=l[d.textField],o=l[d.groupField];o?g!=o&&(g=o,a.groups.push(o),f.push('<div id="'+(a.groupIdPrefix+"_"+(a.groups.length-1))+'" class="combobox-group">'),f.push(d.groupFormatter?d.groupFormatter.call(a,o):o),f.push("</div>")):g=void 0;var p="combobox-item"+(l.disabled?" combobox-item-disabled":"")+(o?" combobox-gitem":"");f.push('<div id="'+(a.itemIdPrefix+"_"+k)+'" class="'+p+'">'),f.push(d.formatter?d.formatter.call(a,l):n),f.push("</div>"),j&&i==k&&e.push(m),l.selected&&-1==$.inArray(m,e)&&e.push(m)}var q=a.combo.panel.getBody();$(q).html(f.join("")),d.multiple?h(a,e,c):h(a,e.length?[e[e.length-1]]:[],c),d.onLoadSuccess.call(a,b)}function d(a,b,d,e){var f=a.options;b&&(f.url=b),d=d||{},0!=f.onBeforeLoad.call(a,d)&&f.loader.call(a,d,function(b){c(a,b,e)},function(){f.onLoadError.apply(this,arguments)})}function e(a){var c=a.options,d=a.target;l++,a.itemIdPrefix="_erajs_combobox_i"+l,a.groupIdPrefix="_erajs_combobox_g"+l;var e=$(d);e.addClass("combobox-f");var h=$.extend({},c,{onShowPanel:function(){var d=this.panel.panel;d.find("div.combobox-item,div.combobox-group").show();var e=a.getValue();e&&b(a,e),c.onShowPanel.call(a)},keyHandler:{up:function(b){j(a,"prev"),b.preventDefault()},down:function(b){j(a,"next"),b.preventDefault()},left:function(){},right:function(){},enter:function(){k(a)},query:function(b){i(a,b)}}}),m=new erajs.ui.Combo(h);a.combo=m;var n=m.panel.panel;$(n).unbind().bind("mouseover",function(a){$(this).children("div.combobox-item-hover").removeClass("combobox-item-hover");var b=$(a.target).closest("div.combobox-item");b.hasClass("combobox-item-disabled")||b.addClass("combobox-item-hover"),a.stopPropagation()}).bind("mouseout",function(a){$(a.target).closest("div.combobox-item").removeClass("combobox-item-hover"),a.stopPropagation()}).bind("click",function(b){var d=$(b.target).closest("div.combobox-item");if(d.length&&!d.hasClass("combobox-item-disabled")){var e=c.finder.getRow(a,d);if(e){var h=e[c.valueField];c.onClickItem.call(a,e),c.multiple?d.hasClass("combobox-item-selected")?g(a,h):f(a,h):(f(a,h),m.hidePanel()),erajs.focusValidate&&m.combo.find(".textbox-text").trigger("focusout"),b.stopPropagation()}}})}function f(a,b){var c=a.options,d=a.combo,e=d.getValues();if(-1==$.inArray(b+"",e)){c.multiple?e.push(b):e=[b],h(a,e);var f=c.finder.getRow(a,b);c.onSelect.call(a,f)}}function g(a,b){var c=a.options,d=a.combo,e=d.getValues(),f=$.inArray(b+"",e);if(f>=0){e.splice(f,1),h(a,e);var g=c.finder.getRow(a,b);c.onUnselect.call(a,g)}}function h(a,b,c){var d=a.options,e=a.combo,f=d.checkbox;erajs.isArray(b)||(b=b.split(","));var g=e.panel,h=g.getPanel();h.find("div.combobox-item-selected").removeClass("combobox-item-selected"),f&&h.find("input.combobox-checkbox")._propAttr("checked",!1);for(var i=[],j=[],k=0;k<b.length;k++){var l=b[k],m=l,n=d.finder.getEl(a,l);n.addClass("combobox-item-selected");var o=d.finder.getRow(a,l);o&&(m=o[d.textField]),i.push(l),j.push(m),f&&n.find("input.combobox-checkbox")._propAttr("checked",!0)}e.setValues(i),c||e.setText(j.join(d.separator))}function i(a,b){var c=a.options,e=a.combo;if(c.multiple&&!b?h(a,[],!0):h(a,[b],!0),"remote"==c.mode)d(a,null,{q:b},!0);else{var f=e.panel,g=f.panel;g.find("div.combobox-item-selected,div.combobox-item-hover").removeClass("combobox-item-selected combobox-item-hover"),g.find("div.combobox-item,div.combobox-group").hide();var i=a.data,j=[],k=c.multiple?b.split(c.separator):[b];$.map(k,function(b){b=$.trim(b);for(var d=void 0,e=0;e<i.length;e++){var f=i[e];if(c.filter.call(a,b,f)){var g=f[c.valueField],h=f[c.textField],k=f[c.groupField],l=c.finder.getEl(a,g).show();h.toLowerCase()==b.toLowerCase()&&(j.push(g),l.addClass("combobox-item-selected"),c.onSelect.call(a,f)),c.groupField&&d!=k&&($("#"+a.groupIdPrefix+"_"+$.inArray(k,a.groups)).show(),d=k)}}}),h(a,j,!0)}}function j(a,c){var d=a.options,e=a.combo,g=e.panel,h=$(g.target),i=h.children("div.combobox-item-hover");i.length||(i=h.children("div.combobox-item-selected")),i.removeClass("combobox-item-hover");var j="div.combobox-item:visible:not(.combobox-item-disabled):first",k="div.combobox-item:visible:not(.combobox-item-disabled):last";if(i.length?"next"==c?(i=i.nextAll(j),i.length||(i=h.children(j))):(i=i.prevAll(j),i.length||(i=h.children(k))):i=h.children("next"==c?j:k),i.length){i.addClass("combobox-item-hover");var l=d.finder.getRow(a,i);l&&(b(a,l[d.valueField]),d.selectOnNavigation&&f(a,l[d.valueField]))}}function k(b){var c=b.options,d=b.combo,e=d.panel,f=$(e.target),g=f.children("div.combobox-item-hover");if(g.length){var i=c.finder.getRow(b,g),j=i[c.valueField];c.multiple&&g.hasClass("combobox-item-selected")?b.unselect(j):b.select(j)}var k=[];$.map(b.getValues(),function(c){a(b,c)>=0&&k.push(c)}),h(b,k,!1),c.multiple||b.hidePanel()}var l=0;erajs.ui.Combobox=function(a,b){a=a||{},b=b||{};var f=a.target;if(!f){var g=a.contentEl;g&&(f=$(g)[0])}if(f){this.target=f,this.options=$.extend({},erajs.ui.Combobox.defaults,b,erajs.ui.Combobox.parseOptions(f),a),this.data=[],this.id=this.options.id,e(this);var h=erajs.ui.Combobox.parseData(this);h.length&&c(this,h)}this.options.data&&c(this,this.options.data),d(this);var i=this.options.value;i&&this.setValues(i)},erajs.ui.Combobox.prototype={getData:function(){return this.data},setValues:function(a){h(this,a)},setValue:function(a){h(this,[a])},clear:function(){var a=this.combo,b=a.options;a.clear();var c=a.panel,d=$(c.getPanel()),e=d.find("div.combobox-item-selected");e.removeClass("combobox-item-selected"),b.checkbox&&e.find("[type='checkbox']").removeAttr("checked")},reset:function(){var a=(this.options,this.combo.options.originalValue);this.setValues(a)},loadData:function(a){c(this,a)},reload:function(a){d(this,a)},select:function(a){f(this,a)},unselect:function(a){g(this,a)},getValues:function(){var a=this.combo,b=a.getValues();return b},getValue:function(){var a=this.getValues();return a[0]},getText:function(){return this.combo.getText()},hidePanel:function(){this.combo.hidePanel()},disable:function(){this.options.disabled=!0,this.combo.disable()},enable:function(){this.options.disabled=!1,this.combo.enable()},readonly:function(a){this.options.readonly=a,this.combo.readonly(a)},destroy:function(){this.combo.destroy(),erajs.destroy(this)},resize:function(a){this.combo.resize(a)}},erajs.ui.Combobox.defaults=$.extend({},erajs.ui.Combo.defaults,{id:null,valueField:"value",textField:"text",autoValueIndex:null,groupField:null,groupFormatter:function(a){return a},mode:"local",method:"post",url:null,data:null,checkbox:!1,filter:function(a,b){var c=this.options;return 0==b[c.textField].toLowerCase().indexOf(a.toLowerCase())},formatter:function(a){var b=this.options;return b.checkbox?'<input type="checkbox" class="combobox-checkbox">'+a[b.textField]:a[b.textField]},loader:function(a,b,c){var d=this,e=d.options;return e.url?void $.ajax({type:e.method,url:e.url,data:a,dataType:"json",success:function(a){b(a)},error:function(){c.apply(this,arguments)}}):!1},loadFilter:function(a){return a},finder:{getEl:function(b,c){var d=a(b,c),e=b.itemIdPrefix+"_"+d;return $("#"+e)},getRow:function(b,c){var d=c instanceof jQuery?c.attr("id").substr(b.itemIdPrefix.length+1):a(b,c);return b.data[parseInt(d)]}},onBeforeLoad:function(){},onLoadSuccess:function(){},onLoadError:function(){},onSelect:function(){},onUnselect:function(){},onClickItem:function(){}}),erajs.ui.Combobox.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Combo.parseOptions(a),erajs.ui.parser.parseOptions(b,["id","valueField","textField","groupField","mode","method","url"]))},erajs.ui.Combobox.parseData=function(a){function b(a,b,c){var f=$(a),g={};g[e.valueField]=void 0!=f.attr("value")?f.attr("value"):f.text(),g[e.textField]=f.text(),g.selected=0===b?!1:f.is(":selected"),g.disabled=f.is(":disabled"),c&&(e.groupField=e.groupField||"group",g[e.groupField]=c),d.push(g)}var c=a,d=[],e=c.options,f=c.target;return $(f).children().each(function(a){if("optgroup"==this.tagName.toLowerCase()){var c=$(this).attr("label");$(this).children().each(function(a){b(this,a,c)})}else b(this,a)}),d}}(),function(){function a(a,b){var c=b.buttons||{},d=[];if(c)for(var e in c)d.push(e);var f=$.extend({},{content:"",msg:"",texts:d},b),g=template("tpl/window/messager",f),h=$(g).appendTo("body"),i=new erajs.ui.Window({contentEl:h,title:a,noheader:a?!1:!0,width:300,height:"auto",modal:!0,shadow:!1,collapsible:!1,minimizable:!1,maximizable:!1,resizable:!1,onClose:function(){setTimeout(function(){i.panel.destroy()},100)}});if(c){h.find("a[xtype='button']").each(function(){var a=this.title;new erajs.ui.Button({target:this,onClick:c[a]})})}return i}function b(a,b,d,e){var f=a.panel;if(f){switch(b){case null:f.show();break;case"slide":f.slideDown(d);break;case"fade":f.fadeIn(d);break;case"show":f.show(d)}var g=null;e>0&&(g=setTimeout(function(){c(a,b,d)},e)),f.hover(function(){g&&clearTimeout(g)},function(){e>0&&(g=setTimeout(function(){c(a,b,d)},e))})}}function c(a,b,c){var d=a.panel[0];if(1!=d.locked){d.locked=!0;var e=a.panel;if(e){switch(b){case null:e.hide();break;case"slide":e.slideUp(c);break;case"fade":e.fadeOut(c);break;case"show":e.hide(c)}setTimeout(function(){a.destroy()},c)}}}var d=erajs.Messager=erajs.Msg={};erajs.apply(d,{show:function(a){var d=$.extend({},erajs.ui.Window.defaults,{collapsible:!1,minimizable:!1,maximizable:!1,shadow:!1,draggable:!1,resizable:!1,closed:!0,style:{left:"",top:"",right:0,zIndex:erajs.zIndex++,bottom:-document.body.scrollTop-document.documentElement.scrollTop},onBeforeOpen:function(){return b(this,d.showType,d.showSpeed,d.timeout),!1},onBeforeClose:function(){return c(this,d.showType,d.showSpeed),!1}},{title:"",width:250,height:100,showType:"slide",showSpeed:600,msg:"",timeout:4e3},a);d.style.zIndex=erajs.zIndex++;var e=$('<div class="messager-body"></div>').html(d.msg).appendTo("body");d.target=e[0];var f=new erajs.ui.Window(d);return f.window.css(f.options.style),f.open(),f},alert:function(b,c,d,e){var f={};f[erajs.Messager.defaults.ok]=function(){return g.close(),e?(e(),!1):void 0};var g=a(b,{buttons:f,icon:d,msg:c});return g},confirm:function(b,c,d){var e={};e[erajs.Messager.defaults.ok]=function(){return f.close(),d?(d(!0),!1):void 0},e[erajs.Messager.defaults.cancel]=function(){return f.close(),d?(d(!1),!1):void 0};var f=a(b,{buttons:e,icon:"question",msg:c});return f},prompt:function(b,c,d){var e={};e[erajs.Messager.defaults.ok]=function(){if(f.close(),d){var a=$(".messager-input",f.window).val();return d(a),!1}},e[erajs.Messager.defaults.cancel]=function(){return f.close(),d?(d(),!1):void 0};var f=a(b,{icon:"question",msg:c,prompt:!0,buttons:e}),g=$(f.target).find("div>input.messager-input");return g.focus(),f}}),erajs.Messager.defaults={ok:"Ok",cancel:"Cancel"}}(),function(){function init(a){var b=a.target,c=$('<div class="slider"><div class="slider-inner"><a href="javascript:void(0)" class="slider-handle"></a><span class="slider-tip"></span></div><div class="slider-rule"></div><div class="slider-rulelabel"></div><div style="clear:both"></div><input type="hidden" class="slider-value" uihidden="true"></div>').insertAfter(b),d=$(b);d.addClass("slider-f").hide();var e=d.attr("name");return e&&(c.find("input.slider-value").attr("name",e),d.removeAttr("name").attr("sliderName",e)),c}function buildSlider(a){function b(b){var d=Math.abs(b%c.step);d<c.step/2?b-=d:b=b-d+c.step,setValue(a,b)}var c=a.options,d=a.slider;d.removeClass("slider-h slider-v slider-disabled"),d.addClass("h"==c.mode?"slider-h":"slider-v"),d.addClass(c.disabled?"slider-disabled":""),d.find("a.slider-handle").draggable({axis:c.mode,cursor:"pointer",disabled:c.disabled,onDrag:function(e){var f=e.data.left,g=d.width();if("h"!=c.mode&&(f=e.data.top,g=d.height()),0>f||f>g)return!1;var h=pos2value(a,f);return b(h),!1},onBeforeDrag:function(){a.isDragging=!0},onStartDrag:function(){c.onSlideStart.call(a,c.value)},onStopDrag:function(d){var e=pos2value(a,"h"==c.mode?d.data.left:d.data.top);b(e),c.onSlideEnd.call(a,c.value),c.onComplete.call(a,c.value),a.isDragging=!1}}),d.find("div.slider-inner").unbind(".slider").bind("mousedown.slider",function(d){if(!a.isDragging){var e=$(this).offset(),f=pos2value(a,"h"==c.mode?d.pageX-e.left:d.pageY-e.top);b(f),c.onComplete.call(a,c.value)}})}function pos2value(a,b){var c=a.options,d=a.slider,e="h"==c.mode?d.width():d.height(),f=c.converter.toValue.call(a,"h"==c.mode?c.reversed?e-b:b:e-b,e);return f.toFixed(0)}function value2pos(a,b){var c=a.options,d=a.slider,e="h"==c.mode?d.width():d.height(),f=c.converter.toPosition.call(a,b,e);return"v"==c.mode&&(f=d.height()-f),c.reversed&&(f=e-f),f.toFixed(0)}function setValue(a,b){var c=a.options,d=a.slider,e=a.target,f=c.value;b<c.min&&(b=c.min),b>c.max&&(b=c.max),c.value=b,$(e).val(b),d.find("input.slider-value").val(b);var g=value2pos(a,b),h=d.find(".slider-tip");if(c.showTip?(h.show(),h.html(c.tipFormatter.call(a,c.value))):h.hide(),"h"==c.mode){var i="left:"+g+"px;";d.find(".slider-handle").attr("style",i),h.attr("style",i+"margin-left:"+-Math.round(h.outerWidth()/2)+"px")}else{var i="top:"+g+"px;";d.find(".slider-handle").attr("style",i),h.attr("style",i+"margin-left:"+-Math.round(h.outerWidth())+"px")}f!=b&&erajs.shouldTriggerUiChangeE(c.formTriggerChangeE)&&c.onChange.call(a,b,f)}function initValue(a){var b=a.options,c=b.onChange;b.onChange=function(){},setValue(a,b.value),b.onChange=c}function showRule(a){function b(a){var b=d.find("div.slider-rule"),e=d.find("div.slider-rulelabel");b.empty(),e.empty();for(var f=0;f<a.length;f++){var g=100*f/(a.length-1)+"%",h=$("<span></span>").appendTo(b);h.css("h"==c.mode?"left":"top",g),"|"!=a[f]&&(h=$("<span></span>").appendTo(e),h.html(a[f]),h.css("h"==c.mode?{left:g,marginLeft:-Math.round(h.outerWidth()/2)}:{top:g,marginTop:-Math.round(h.outerHeight()/2)}))}}var c=a.options,d=a.slider,e="h"==c.mode?c.rule:c.rule.slice(0).reverse();c.reversed&&(e=e.slice(0).reverse()),b(e)}function setSize(a,b){var c=a.options,d=a.slider;b&&(b.width&&(c.width=b.width),b.height&&(c.height=b.height)),"h"==c.mode?(d.css("height",""),d.children("div").css("height",""),isNaN(c.width)||d.width(c.width)):(d.css("width",""),d.children("div").css("width",""),isNaN(c.height)||(d.height(c.height),d.find("div.slider-rule").height(c.height),d.find("div.slider-rulelabel").height(c.height),d.find("div.slider-inner")._outerHeight(c.height))),initValue(a)}erajs.ui.Slider=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c))}b&&(this.target=b,this.options=$.extend({},erajs.ui.Slider.defaults,erajs.ui.Slider.parseOptions(b),a),this.id=this.options.id,this.slider=init(this),$(b).removeAttr("disabled"));var d=this.options;d.min=parseFloat(d.min),d.max=parseFloat(d.max),d.value=parseFloat(d.value),d.step=parseFloat(d.step),d.originalValue=d.value,this._render(b)},erajs.ui.Slider.prototype={options:function(){return this.options},destroy:function(){this.slider.remove(),$(this.target).remove(),erajs.destroy(this)},resize:function(a){setSize(this,a)},getValue:function(){return this.options.value},setValue:function(a){setValue(this,a)},clear:function(){var a=this.options;setValue(this,a.min)},reset:function(){var a=this.options;setValue(this,a.originalValue)},enable:function(){this.options.disabled=!1,buildSlider(this)},disable:function(){this.options.disabled=!0,buildSlider(this)},_render:function(){buildSlider(this),showRule(this),setSize(this)}},erajs.ui.Slider.defaults={id:null,contentEl:null,width:"auto",height:"auto",mode:"h",reversed:!1,showTip:!1,disabled:!1,value:0,min:0,max:100,step:1,rule:[],formTriggerChangeE:!0,tipFormatter:function(a){return a},converter:{toPosition:function(a,b){var c=this.options;return(a-c.min)/(c.max-c.min)*b},toValue:function(a,b){var c=this.options;return c.min+(c.max-c.min)*(a/b)}},onChange:function(){},onSlideStart:function(){},onSlideEnd:function(){},onComplete:function(){}},erajs.ui.Slider.parseOptions=function(target){var t=$(target);return $.extend({},erajs.ui.parser.parseOptions(t,["id","name","width","height","mode",{reversed:"boolean",showTip:"boolean",min:"number",max:"number",step:"number"}]),{value:t.val()||void 0,disabled:t.attr("disabled")?!0:void 0,rule:t.attr("rule")?eval(t.attr("rule")):void 0})}}(),function(){function a(a){var b=a.target,c=$('<span class="spinner"><span class="spinner-arrow"><span class="spinner-arrow-up"></span><span class="spinner-arrow-down"></span></span></span>').insertAfter(b);return $(b).addClass("spinner-text spinner-f").prependTo(c),c}function b(a,b){var c=a.options,d=a.target;b?(c.disabled=!0,$(d).attr("disabled",!0)):(c.disabled=!1,$(d).removeAttr("disabled"))}function c(a,b){var c=a.options;c.readonly=void 0==b?!0:b;var d=c.readonly?!0:!c.editable;$(a.target).attr("readonly",d).css("cursor",d?"pointer":"")}function d(a,b){var c=a.options,d=a.spinner,e=a.target;
b&&(c.width=b);var f=$('<div style="display:none"></div>').insertBefore(d);d.appendTo("body"),isNaN(c.width)&&(c.width=$(e).outerWidth());var g=d.find(".spinner-arrow");d._outerWidth(c.width)._outerHeight(c.height),$(e)._outerWidth(d.width()-g.outerWidth()),$(e).css({height:d.height()+"px",lineHeight:d.height()+"px"}),g._outerHeight(d.height()),g.find("span")._outerHeight(g.height()/2),d.insertAfter(f),f.remove()}function e(a){var b=a.options,c=a.spinner,d=a.target,e=$(d);e.unbind(".spinner"),c.find(".spinner-arrow-up,.spinner-arrow-down").unbind(".spinner"),b.disabled||b.readonly||(c.find(".spinner-arrow-up").bind("mouseenter.spinner",function(){$(this).addClass("spinner-arrow-hover")}).bind("mouseleave.spinner",function(){$(this).removeClass("spinner-arrow-hover")}).bind("click.spinner",function(){b.spin.call(a,!1),b.onSpinUp.call(a)}),c.find(".spinner-arrow-down").bind("mouseenter.spinner",function(){$(this).addClass("spinner-arrow-hover")}).bind("mouseleave.spinner",function(){$(this).removeClass("spinner-arrow-hover")}).bind("click.spinner",function(){b.spin.call(a,!0),b.onSpinDown.call(a)}),e.bind("change.spinner",function(){a.setValue($(this).val())}))}erajs.ui.Spinner=function(b){b=b||{};var c=b.target;if(!c){var d=b.contentEl;d&&(c=$(d))}c&&(this.target=c,this.options=$.extend({},erajs.ui.Spinner.defaults,erajs.ui.Spinner.parseOptions(c),b),this.id=this.options.id,this.spinner=a(this),$(c).removeAttr("disabled"));var e=this.options.value;this.options.originalValue=e,$(c).val(e),this._render(c)},erajs.ui.Spinner.prototype={destroy:function(){this.spinner.remove(),erajs.destroy(this)},resize:function(a){d(this,a)},enable:function(){b(this,!1),e(this)},disable:function(){b(this,!0),e(this)},readonly:function(a){c(this,a),e(this)},getValue:function(){return this.options.value},setValue:function(a){var b=this.options,c=b.value;b.value=a,$(this.target).val(a),c!=a&&erajs.shouldTriggerUiChangeE(b.formTriggerChangeE)&&b.onChange.call(this,a,c)},clear:function(){var a=this.options;a.value="",$(this.target).val("")},reset:function(){var a=this.options;this.setValue(a.originalValue)},_render:function(){b(this,this.options.disabled),c(this,this.options.readonly),d(this),e(this)}},erajs.ui.Spinner.defaults={id:null,contentEl:null,width:"auto",height:22,deltaX:19,value:"",min:null,max:null,increment:1,editable:!0,disabled:!1,readonly:!1,formTriggerChangeE:!0,spin:function(){},onSpinUp:function(){},onSpinDown:function(){},onChange:function(){}},erajs.ui.Spinner.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.parser.parseOptions(b,["id","name","width","height","min","max",{increment:"number",editable:"boolean"}]),{value:b.val()||void 0,disabled:b.attr("disabled")?!0:void 0,readonly:b.attr("readonly")?!0:void 0})}}(),function(){function a(a){var b=a.target,c=$(b);c.addClass("numberbox numberbox-f");var d=$('<input type="hidden" uihidden="true">').insertAfter(b),e=c.attr("name");return e&&(d.attr("name",e),c.removeAttr("name").attr("numberboxName",e)),d}function b(a,b){var c=a.options,d=a.target;b?(c.disabled=!0,$(d).attr("disabled",!0)):(c.disabled=!1,$(d).removeAttr("disabled"))}function c(a,b){var c=a.options,d=a.target;b&&(c.width=b);var e=$(d),f=$('<div style="display:none"></div>').insertBefore(e);e.appendTo("body"),isNaN(c.width)&&(c.width=e.outerWidth()),e._outerWidth(c.width)._outerHeight(c.height),e.css("line-height",e.height()+"px"),e.insertAfter(f),f.remove()}function d(a){var b=a.options,c=a.target;$(c).unbind(".numberbox").bind("keypress.numberbox",function(c){return b.filter.call(a,c)}).bind("blur.numberbox",function(){var c=$(this);e(a,c.val()),erajs.focusValidate&&c.trigger("focusout");var d=f(a);c.val(b.formatter.call(a,d)),b.onBlur.call(a,d)}).bind("focus.numberbox",function(){var c=f(a);c!=b.parser.call(a,$(this).val())&&$(this).val(b.formatter.call(a,c)),b.onFocus.call(a,c)})}function e(a,b){var c=a.options,d=a.target,e=f(a);b=c.parser.call(a,b),c.value=b,a.field.val(b),$(d).val(c.formatter.call(a,b)),e!=b&&erajs.shouldTriggerUiChangeE(c.formTriggerChangeE)&&c.onChange.call(a,b,e)}function f(a){var b=a.field;return b.val()}function g(a){var b=a.options,c=b.onChange;b.onChange=function(){},e(a,b.parser.call(a,b.value)),b.onChange=c,b.originalValue=f(a)}erajs.ui.Numberbox=function(b){b=b||{};var c=b.target;if(!c){var d=b.contentEl;d&&(c=$(d))}c&&(this.target=c,this.options=$.extend({},erajs.ui.Numberbox.defaults,erajs.ui.Numberbox.parseOptions(c),b),this.id=this.options.id,this.field=a(this),$(c).removeAttr("disabled"),$(c).css({imeMode:"disabled"})),this._render(c)},erajs.ui.Numberbox.prototype={updateNumberbox:function(a){var b=this,c=$.extend({},b.options,a);b.options=c,b._render()},destroy:function(){this.field.remove(),$(this.target).remove(),erajs.destroy(this)},resize:function(a){c(this,a)},enable:function(){b(this,!1)},fix:function(){var a=this.target;e(this,$(a).val())},disable:function(){b(this,!0)},getValue:function(){return f(this)},setValue:function(a){e(this,a)},clear:function(){var a=this.options;a.value="",this.field.val(""),$(this.target).val("")},reset:function(){var a=this.options;this.setValue(a.originalValue)},_render:function(){b(this,this.options.disabled),c(this),d(this),g(this)}},erajs.ui.Numberbox.defaults={id:null,width:"auto",height:22,disabled:!1,value:"",min:null,max:null,precision:0,decimalSeparator:".",groupSeparator:"",prefix:"",suffix:"",formTriggerChangeE:!0,allowKeys:[75,84,77,71,107,116,109,103],filter:function(a){var b=this.options,c=this.target;if(45==a.which)return-1==$(c).val().indexOf("-")?!0:!1;var d=String.fromCharCode(a.which);return d==b.decimalSeparator?-1==$(c).val().indexOf(d)?!0:!1:d==b.groupSeparator?!0:a.which>=48&&a.which<=57&&0==a.ctrlKey&&0==a.shiftKey||0==a.which||8==a.which||$.inArray(a.which,b.allowKeys)>-1?!0:1!=a.ctrlKey||99!=a.which&&118!=a.which?!1:!0},formatter:function(a){if(!a)return a;a+="";var b=this.options,c=a,d="",e=a.indexOf(".");if(e>=0&&(c=a.substring(0,e),d=a.substring(e+1,a.length)),b.groupSeparator)for(var f=/(\d+)(\d{3})/;f.test(c);)c=c.replace(f,"$1"+b.groupSeparator+"$2");return d?b.prefix+c+b.decimalSeparator+d+b.suffix:b.prefix+c+b.suffix},_transformValue:function(a){function b(a,b){switch(a){case"K":b=1e3*parseFloat(b);break;case"T":b=1e3*parseFloat(b);break;case"M":b=1e6*parseFloat(b);break;case"G":b=1e9*parseFloat(b)}return b}var c=["K","T","M","G"];return erajs.each(c,function(c){erajs.String.endsWith(a,c,!0)&&(a=b(c,a.slice(0,-1)))}),a},parser:function(a){a+="";var b=this.options;parseFloat(a)!=a&&(b.prefix&&(a=$.trim(a.replace(new RegExp("\\"+$.trim(b.prefix),"g"),""))),b.suffix&&(a=$.trim(a.replace(new RegExp("\\"+$.trim(b.suffix),"g"),""))),b.groupSeparator&&(a=$.trim(a.replace(new RegExp("\\"+b.groupSeparator,"g"),""))),b.decimalSeparator&&(a=$.trim(a.replace(new RegExp("\\"+b.decimalSeparator,"g"),"."))),a=a.replace(/\s/g,"")),erajs.isEmpty(a)||(a=b._transformValue(a));var c=parseFloat(a).toFixed(b.precision);return isNaN(c)?c="":"number"==typeof b.min&&c<b.min?c=b.min.toFixed(b.precision):"number"==typeof b.max&&c>b.max&&(c=b.max.toFixed(b.precision)),c},onChange:function(){},onBlur:function(){},onFocus:function(){}},erajs.ui.Numberbox.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.parser.parseOptions(b,["id","name","width","height","decimalSeparator","groupSeparator","suffix",{min:"number",max:"number",precision:"number"}]),{prefix:b.attr("prefix")?b.attr("prefix"):void 0,disabled:b.attr("disabled")?!0:void 0,value:b.val()||void 0})}}(),function(){function wrapDialog(a){for(var b=a.options,c=a.target,d=document.createElement("div");c.firstChild;)d.appendChild(c.firstChild);c.appendChild(d);var e=$(d);e.attr("style",$(c).attr("style")),$(c).removeAttr("style").css("overflow","hidden");var f=new erajs.ui.Panel($.extend({},{target:e[0],loadingMessage:b.loadingMessage},{border:!1,doSize:!1,bodyCls:"dialog-content"}));return f}function buildDialog(a){var b=a.options,c=a.target,d=a.contentPanel;addTools(a),addButtons(a);var e=new erajs.ui.Window($.extend({},b,{onOpen:function(){d.closed&&d.open(),b.onOpen&&b.onOpen.call(a)},onResize:function(e,f){var g=$(c);d.panel.show(),d.resize({width:g.width(),height:"auto"==f?"auto":g.height()-g.children("div.dialog-toolbar")._outerHeight()-g.children("div.dialog-button")._outerHeight()}),b.onResize&&b.onResize.call(a,e,f)}}));a.window=e}function addButtons(a){var b=a.options,c=a.target;if(b.buttons)if($.isArray(b.buttons)){$(c).find("div.dialog-button").remove();for(var d=$('<div class="dialog-button"></div>').appendTo(c),e=0;e<b.buttons.length;e++){var f=b.buttons[e],g=$("<div></div>").appendTo(d);f.handler&&(g[0].onclick=f.handler),new erajs.ui.Button($.extend({},f,{target:g[0]}))}}else $(b.buttons).addClass("dialog-button").appendTo(c),$(b.buttons).show();else $(c).find("div.dialog-button").remove()}function addTools(self){var opts=self.options,target=self.target;if(opts.toolbar)if($.isArray(opts.toolbar)){$(target).find("div.dialog-toolbar").remove();for(var toolbar=$('<div class="dialog-toolbar"><table cellspacing="0" cellpadding="0"><tr></tr></table></div>').prependTo(target),tr=toolbar.find("tr"),i=0;i<opts.toolbar.length;i++){var btn=opts.toolbar[i];if("-"==btn)$('<td><div class="dialog-tool-separator"></div></td>').appendTo(tr);else{var td=$("<td></td>").appendTo(tr),tool=$("<div ></div>").appendTo(td);tool[0].onclick=eval(btn.handler||function(){}),new erajs.ui.Button($.extend({},btn,{target:tool[0],plain:!0}))}}}else $(opts.toolbar).addClass("dialog-toolbar").prependTo(target),$(opts.toolbar).show();else $(target).find("div.dialog-toolbar").remove()}erajs.ui.Dialog=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Dialog.defaults,erajs.ui.Dialog.parseOptions(b),a),this.id=this.options.id,this.contentPanel=wrapDialog(this)),this._render(b)},erajs.ui.Dialog.prototype={open:function(){this.window.open()},close:function(){this.window.close()},getWindow:function(){return this.window},destroy:function(a){this.window.destroy(a),erajs.destroy(this)},_render:function(){buildDialog(this)}},erajs.ui.Dialog.defaults=$.extend({},erajs.ui.Window.defaults,{title:"New Dialog",collapsible:!1,minimizable:!1,maximizable:!0,resizable:!1,toolbar:null,buttons:null}),erajs.ui.Dialog.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Window.parseOptions(a),erajs.ui.parser.parseOptions(b,["id","toolbar","buttons"]))}}(),function(){function a(a){var c=a.target,d=a.options;$(c).addClass("numberspinner-f");var e=new erajs.ui.Spinner($.extend({},d,{spin:function(c){b(a,c)}}));a.spinner=e;var f=new erajs.ui.Numberbox($.extend({},d,{width:"auto"}));a.numberbox=f}function b(a,b){var c=a.options,d=parseFloat(a.getValue()||c.value)||0;1==b?d-=c.increment:d+=c.increment,a.setValue(d)}erajs.ui.Numberspinner=function(b){b=b||{};var c=b.target;if(!c){var d=b.contentEl;d&&(c=$(d))}c&&(this.target=c,this.options=$.extend({},erajs.ui.Numberspinner.defaults,erajs.ui.Numberspinner.parseOptions(c),b),this.id=this.options.id),a(this)},erajs.ui.Numberspinner.prototype={options:function(){var a=this.options,b=this.numberbox;return $.extend(a,{value:this.getValue(),originalValue:b.options.originalValue})},setValue:function(a){var b=this,c=b.options;c.value=a;var d=b.numberbox;d.setValue(a)},getValue:function(){var a=this.numberbox;return a.getValue()},disable:function(){this.options.disabled=!0,this.spinner.disable()},enable:function(){this.options.disabled=!1,this.spinner.enable()},readonly:function(a){this.options.readonly=a,this.spinner.readonly(a)},clear:function(){var a=this.numberbox,b=this.spinner;b.clear(),a.clear()},reset:function(){var a=this.options;this.setValue(a.originalValue)},destroy:function(){this.spinner.destroy(),erajs.destroy(this)}},erajs.ui.Numberspinner.defaults=$.extend({},erajs.ui.Spinner.defaults,erajs.ui.Numberbox.defaults),erajs.ui.Numberspinner.parseOptions=function(a){return $.extend({},erajs.ui.Spinner.parseOptions(a),erajs.ui.Numberbox.parseOptions(a),{})}}(),function(){function a(a,b){var d=a.options,f=a.target,g=$(f).val();""==g&&(g=[0,0,0].join(d.separator));for(var h=g.split(d.separator),i=0;i<h.length;i++)h[i]=parseInt(h[i],10);1==b?h[d.highlight]-=d.increment:h[d.highlight]+=d.increment;var j=h.join(d.separator);$(f).val(j),e(a),c(a)}function b(b){var d=b.target,f=b.options,g=$(d);g.addClass("timespinner-f");var h=$.extend({},f,{target:d[0],spin:function(c){a(b,c)}}),i=new erajs.ui.Spinner(h);b.spinner=i,g.unbind(".timespinner").bind("click.timespinner",function(){var a=0;if(null!=this.selectionStart)a=this.selectionStart;else if(this.createTextRange){var e=d.createTextRange(),g=document.selection.createRange();g.setEndPoint("StartToStart",e),a=g.text.length}a>=0&&2>=a?f.highlight=0:a>=3&&5>=a?f.highlight=1:a>=6&&8>=a&&(f.highlight=2),c(b)}).bind("blur.timespinner",function(){e(b)})}function c(a){var b=a.options,c=a.target,d=0,e=0;if(0==b.highlight?(d=0,e=2):1==b.highlight?(d=3,e=5):2==b.highlight&&(d=6,e=8),null!=c.selectionStart)c.setSelectionRange(d,e);else if(c.createTextRange){var f=c.createTextRange();f.collapse(),f.moveEnd("character",e),f.moveStart("character",d),f.select()}$(c).focus()}function d(a,b){var c=a.options;if(!b)return null;for(var d=b.split(c.separator),e=0;e<d.length;e++)if(isNaN(d[e]))return null;for(;d.length<3;)d.push(0);return new Date(1900,0,0,d[0],d[1],d[2])}function e(a){function b(a){return(10>a?"0":"")+a}var c=a.options,e=a.target,f=a.spinner,g=$(e).val(),h=d(a,g);if(!h)return c.value="",void f.setValue("");var i=d(a,c.min),j=d(a,c.max);i&&i>h&&(h=i),j&&h>j&&(h=j);var k=[b(h.getHours()),b(h.getMinutes())];c.showSeconds&&k.push(b(h.getSeconds()));var l=k.join(c.separator);c.value=l,f.setValue(l)}erajs.ui.Timespinner=function(a){a=a||{};var c=a.target;if(!c){var d=a.contentEl;d&&(c=$(d))}c&&(this.target=c,this.options=$.extend({},erajs.ui.Timespinner.defaults,erajs.ui.Timespinner.parseOptions(c),a),this.id=this.options.id),b(this)},erajs.ui.Timespinner.prototype={options:function(){return this.spinner.options},getSpinner:function(){return this.spinner},setValue:function(a){var b=this.target;$(b).val(a),e(this)},getValue:function(){return this.options.value},readonly:function(a){this.options.readonly=a,this.spinner.readonly(a)},enable:function(){this.options.disabled=!1,this.spinner.enable()},disable:function(){this.options.disabled=!0,this.spinner.disable()},clear:function(){var a=this.options;a.value="",$(this.target).val("")},reset:function(){var a=this.spinner.options;this.setValue(a.originalValue)},getHours:function(){var a=this.getSplitValue();return parseInt(a[0],10)},getSplitValue:function(){var a=this.options,b=a.value.split(a.separator);return b},getMinutes:function(){var a=this.getSplitValue();return parseInt(a[1],10)},getSeconds:function(){var a=this.getSplitValue();return parseInt(a[2],10)||0},destroy:function(){this.spinner.destroy(),erajs.destroy(this)}},erajs.ui.Timespinner.defaults=$.extend({},erajs.ui.Spinner.defaults,{separator:":",showSeconds:!1,highlight:0}),erajs.ui.Timespinner.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Spinner.parseOptions(a),erajs.ui.parser.parseOptions(b,["separator",{showSeconds:"boolean",highlight:"number"}]))}}(),function(){function a(a,b){var c=a.options,d=$(a.target),e=d.find(".calendar-header");b&&$.extend(c,{width:b.width,height:b.height}),d._size(c,d.parent()),d.find(".calendar-body")._outerHeight(d.height()-e._outerHeight())}function b(a){var b=a.options,c=$(a.target),d=c.find(".calendar-menu").show(),e=c.find(".calendar-body"),f=d.find(".calendar-menu-year-inner"),g=d.find(".calendar-menu-month-inner");f.find("input").val(b.year).focus(),g.find("td.calendar-selected").removeClass("calendar-selected"),g.find("td:eq("+(b.month-1)+")").addClass("calendar-selected"),d._outerWidth(e._outerWidth()),d._outerHeight(e._outerHeight()),g._outerHeight(d.height()-f._outerHeight())}function c(a,b,c){for(var d=a.options,e=[],f=new Date(b,c,0).getDate(),g=1;f>=g;g++)e.push([b,c,g]);for(var h=[],i=[],j=-1;e.length>0;){var k=e.shift();i.push(k);var l=new Date(k[0],k[1]-1,k[2]).getDay();j==l?l=0:l==(0==d.firstDay?7:d.firstDay)-1&&(h.push(i),i=[]),j=l}i.length&&h.push(i);var m=h[0];if(m.length<7)for(;m.length<7;){var n=m[0],k=new Date(n[0],n[1]-1,n[2]-1);m.unshift([k.getFullYear(),k.getMonth()+1,k.getDate()])}else{for(var n=m[0],i=[],g=1;7>=g;g++){var k=new Date(n[0],n[1]-1,n[2]-g);i.unshift([k.getFullYear(),k.getMonth()+1,k.getDate()])}h.unshift(i)}for(var o=h[h.length-1];o.length<7;){var p=o[o.length-1],k=new Date(p[0],p[1]-1,p[2]+1);o.push([k.getFullYear(),k.getMonth()+1,k.getDate()])}if(h.length<6){for(var p=o[o.length-1],i=[],g=1;7>=g;g++){var k=new Date(p[0],p[1]-1,p[2]+g);i.push([k.getFullYear(),k.getMonth()+1,k.getDate()])}h.push(i)}return h}function d(a){var b=a.options,d=a.target,e=$(d),f=b.current;f&&!b.validator.call(a,f)&&(b.current=f=null);var g=new Date,h=g.getFullYear()+","+(g.getMonth()+1)+","+g.getDate(),i=f?f.getFullYear()+","+(f.getMonth()+1)+","+f.getDate():"",j=6-b.firstDay,k=j+1;j>=7&&(j-=7),k>=7&&(k-=7);var l=b.months[b.month-1]+" "+b.year;e.find(".calendar-title span").html(l);var m=e.find("table.calendar-dtable");m.children("tbody").remove();for(var n=["<tbody>"],o=c(a,b.year,b.month),p=0;p<o.length;p++){var q=o[p],r="";0==p?r="calendar-first":p==o.length-1&&(r="calendar-last"),n.push('<tr class="'+r+'">');for(var s=0;s<q.length;s++){var t=q[s],u=t[0]+","+t[1]+","+t[2],v=new Date(t[0],parseInt(t[1])-1,t[2]),w=b.formatter.call(a,v),x=b.styler.call(a,v),y="",z="";"string"==typeof x?z=x:x&&(y=x["class"]||"",z=x.style||"");var r="calendar-day";(b.year!=t[0]||b.month!=t[1])&&(r+=" calendar-other-month"),u==h&&(r+=" calendar-today"),u==i&&(r+=" calendar-selected"),s==j?r+=" calendar-saturday":s==k&&(r+=" calendar-sunday"),0==s?r+=" calendar-first":s==q.length-1&&(r+=" calendar-last"),r+=" "+y,b.validator.call(a,v)||(r+=" calendar-disabled"),n.push('<td class="'+r+'" abbr="'+u+'" style="'+z+'">'+w+"</td>")}n.push("</tr>")}n.push("</tbody>"),m.append(n.join("")),b.onNavigate.call(a,b.year,b.month)}function e(a){function c(a){var b=$(a).closest(".calendar-day");return b.length?b:$(a)}function e(b){var c=j.find(".calendar-menu"),e=c.find(".calendar-menu-year").val(),f=c.find(".calendar-selected").attr("abbr");isNaN(e)||(h.year=parseInt(e),h.month=parseInt(f),d(a)),b&&c.hide()}function f(b){h.year+=b,d(a),k.find(".calendar-menu-year").val(h.year)}function g(b){h.month+=b,h.month>12?(h.year++,h.month=1):h.month<1&&(h.year--,h.month=12),d(a),k.find("td.calendar-selected").removeClass("calendar-selected"),k.find("td:eq("+(h.month-1)+")").addClass("calendar-selected")}var h=a.options,i=a.target,j=$(i),k=j.find(".calendar-menu");k.find(".calendar-menu-year").unbind(".calendar").bind("keypress.calendar",function(a){13==a.keyCode&&e(!0)}),j.unbind(".calendar").bind("mouseover.calendar",function(a){var b=c(a.target);(b.hasClass("calendar-nav")||b.hasClass("calendar-text")||b.hasClass("calendar-day")&&!b.hasClass("calendar-disabled"))&&b.addClass("calendar-nav-hover")}).bind("mouseout.calendar",function(a){var b=c(a.target);(b.hasClass("calendar-nav")||b.hasClass("calendar-text")||b.hasClass("calendar-day")&&!b.hasClass("calendar-disabled"))&&b.removeClass("calendar-nav-hover")}).bind("click.calendar",function(i){var j=c(i.target);if(j.hasClass("calendar-menu-next")||j.hasClass("calendar-nextyear"))f(1);else if(j.hasClass("calendar-menu-prev")||j.hasClass("calendar-prevyear"))f(-1);else if(j.hasClass("calendar-menu-month"))k.find(".calendar-selected").removeClass("calendar-selected"),j.addClass("calendar-selected"),e(!0);else if(j.hasClass("calendar-prevmonth"))g(-1);else if(j.hasClass("calendar-nextmonth"))g(1);else if(j.hasClass("calendar-text"))k.is(":visible")?k.hide():b(a);else if(j.hasClass("calendar-day")){if(j.hasClass("calendar-disabled"))return;var l=h.current;j.closest("div.calendar-body").find(".calendar-selected").removeClass("calendar-selected"),j.addClass("calendar-selected");var m=j.attr("abbr").split(","),n=parseInt(m[0]),o=parseInt(m[1]),p=parseInt(m[2]);h.current=new Date(n,o-1,p),h.onSelect.call(a,h.current),l&&l.getTime()==h.current.getTime()||h.onChange.call(a,h.current,l),(h.year!=n||h.month!=o)&&(h.year=n,h.month=o,d(a))}})}erajs.ui.Calendar=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Calendar.defaults,erajs.ui.Calendar.parseOptions(b),a),this.id=this.options.id),this.initComponent()},erajs.ui.Calendar.prototype={_renderTpl:function(){for(var a=this,b=a.options,c=$(a.target),d=b.months,e=[],f=0;3>f;f++)e.push(d.slice(4*f,4*(f+1)));var g=template("tpl/calendar/calendar",$.extend({},b,{months:e})),h=$(g).replaceAll(c);return a.target=h,h},initComponent:function(){var b=this;b._renderTpl(),a(b),e(b),d(b)},calendar:function(a){var b=this,c=$.extend({},b.options,a);b.options=c,b.initComponent()},destroy:function(){this.target.remove(),erajs.destroy(this)},resize:function(b){a(this,b)},moveTo:function(a){var b=this,c=this.options;if(!a){var d=new Date;return void b.calendar({year:d.getFullYear(),month:d.getMonth()+1,current:a})}if(c.validator.call(b,a)){var e=c.current;b.calendar({year:a.getFullYear(),month:a.getMonth()+1,current:a}),e&&e.getTime()==a.getTime()||c.onChange.call(b,c.current,e)}}},erajs.ui.Calendar.defaults={id:null,contentEl:null,width:180,height:180,fit:!1,border:!0,firstDay:0,weeks:["S","M","T","W","T","F","S"],months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],year:(new Date).getFullYear(),month:(new Date).getMonth()+1,current:function(){var a=new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate())}(),formatter:function(a){return a.getDate()},styler:function(){return""},validator:function(){return!0},onSelect:function(){},onChange:function(){},onNavigate:function(){}},erajs.ui.Calendar.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.parser.parseOptions(b,["id","width","height",{firstDay:"number",fit:"boolean",border:"boolean"}]))}}(),function(){function a(a,b){var c=a.options,d=c.transformQueryStrToD.call(a,b);e(a,d,!0)}function b(b){function c(){var a=i.panel,c=a.panel;c.css("overflow","hidden"),a.onBeforeDestroy=function(){var a=$(this).find(".calendar-shared");a.length&&a.insertBefore(a[0].pholder)};var d=$('<div class="datebox-calendar-inner"></div>').appendTo(a.target),f=$("<div></div>").appendTo(d),h=g.parser.call(b,g.value),j=new erajs.ui.Calendar({target:f[0],border:!1,fit:!0,current:function(){return h}(),month:function(){return h.getMonth()+1}(),year:function(){return h.getFullYear()}(),onSelect:function(a){e(b,a),b.combo.hidePanel(),b.options.onSelect.call(b,a)}});b.calendar=j;for(var k=$('<div class="datebox-button"><table cellspacing="0" cellpadding="0" style="width:100%"><tr></tr></table></div>').appendTo(a.target),l=k.find("tr"),m=0;m<g.buttons.length;m++){var n=$("<td></td>").appendTo(l),o=g.buttons[m],p=$('<a href="javascript:void(0)"></a>').html($.isFunction(o.text)?o.text(b):o.text).appendTo(n);p.bind("click",{self:b,handler:o.handler},function(a){a.data.handler.call(this,a.data.self)})}l.find("td").css("width",100/g.buttons.length+"%")}function f(){b.calendar.resize()}{var g=b.options,h=b.target;$(h)}$(h).addClass("datebox-f");var i=new erajs.ui.Combo($.extend({},g,{onShowPanel:function(){b.calendar||c(),f(),e(b,g.value,!0),g.onShowPanel.call(b)},onHidePanel:function(){var a=$(this.panel.panel).find(".calendar-menu");if(a.hide(),g.editable){var c=g.formatter.call(b,g.dateValue);i.setText(c)}erajs.focusValidate&&i.combo.find(".textbox-text").trigger("focusout")},keyHandler:{up:function(){},down:function(){},left:function(){},right:function(){},enter:function(){d(b)},query:function(c){a(b,c)}}}));b.combo=i,i.combo.addClass("datebox");var j=g.value;if(j)if(erajs.isString(j))b.initValue(j);else if(erajs.isDate(j))e(b,j);else if(erajs.isFunction(j)){var k=j.call();e(b,k)}}function c(a){var b=a.options,c=a.combo.combo;$(c).find(".textbox-text").keydown(function(c){if(9==c.keyCode){var d=$(this).val();d=b.transformQueryStrToD.call(a,d),a.setValue(d)}})}function d(a,b){var c=a.calendar,d=c.options.current,f=b||d;f&&(e(a,f),a.combo.hidePanel())}function e(a,b,c){var d=a.options,e=a.combo,f="",g="",h=a.calendar;b&&(erajs.isDate(b)||(b=d.parser.call(a,b)),f=g=d.formatter.call(a,b),d.submitFormat&&d.submitFormat!==d.format&&(f=erajs.Date.format(b,d.submitFormat))),d.dateValue=b,d.value=f,e.setValue(f),c?h&&h.moveTo(b):e.setText(g)}erajs.ui.Datebox=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Datebox.defaults,erajs.ui.Datebox.parseOptions(b),a),this.id=this.options.id),this.initComponent(b)},erajs.ui.Datebox.prototype={initComponent:function(){b(this),c(this)},getValue:function(){return this.options.value},setValue:function(a){e(this,a)},initValue:function(a){var b=this,c=b.options,a=a||c.value;a&&(a=c.formatter.call(b,c.parser.call(b,a))),this.combo.setText(a)},reset:function(){var a=this,b=a.combo.options;a.setValue(b.originalValue)},clear:function(){this.options.value="",this.combo.clear()},disable:function(){this.options.disabled=!0,this.combo.disable()},enable:function(){this.options.disabled=!1,this.combo.enable()},readonly:function(a){this.options.readonly=a,this.combo.readonly(a)},destroy:function(){this.combo.destroy(),erajs.destroy(this)},resize:function(a){this.combo.resize(a)},hidePanel:function(){this.combo.hidePanel()}},erajs.ui.Datebox.defaults=$.extend({},erajs.ui.Combo.defaults,{panelWidth:180,panelHeight:"auto",sharedCalendar:null,currentText:"Today",closeText:"Close",okText:"Ok",format:"Y/m/d",submitFormat:"",dateValue:null,formatter:function(a){var b=this,c=b.format||b.options.format;return erajs.isDate(a)?erajs.Date.format(a,c):a},transformQueryStrToD:function(a){a=erajs.String.trim(a);var b=this,c=b.options,d=a,e=/^-?[0-9]+[d|w|m|y]$/i;if(e.test(a)){var f,g=a.substr(0,a.length-1),h=a.substr(-1);switch(h.toLocaleUpperCase()){case"D":f=erajs.Date.DAY;break;case"W":f=erajs.Date.DAY,g=7*g;break;case"M":f=erajs.Date.MONTH;break;case"Y":f=erajs.Date.YEAR}d=erajs.Date.add(c.referDate.call(b),f,g)}else d=erajs.validStringDate(a,c.format);var i=c.submitFormat||c.format;return erajs.Date.format(d,i)},referDate:function(){return new Date},parser:function(a){function b(a,b){return erajs.Date.parse(a,b)}if(!a)return new Date;if(erajs.isDate(a))return a;var c,d=this,e=d.submitFormat||d.options.submitFormat,f=d.format||d.options.format,g=b(a,f),h=[],i=0;if(!g)for(e&&h.push(e),f&&h.push(f),c=h.length;c>i&&!g;++i)g=b(a,h[i]);return g},buttons:[{text:function(a){return a.options.currentText},handler:function(a){var b=new Date;d(a,b)}},{text:function(a){return a.options.closeText},handler:function(a){a.combo.hidePanel()}}],onSelect:function(){}}),erajs.ui.Datebox.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Combo.parseOptions(a),erajs.ui.parser.parseOptions(b,["sharedCalendar"]))}}(),function(){function a(a){function c(){var b=a.datebox.combo.panel,c=b.panel,d="";if(!a.spinner){var e=$('<div style="padding:2px"><input style="width:80px"></div>').insertAfter(c.find("div.datebox-calendar-inner"));d=e.children("input")}var g=new erajs.ui.Timespinner({target:d,width:c._outerWidth()-6,showSeconds:f.showSeconds,separator:f.timeSeparator});a.spinner=g,d.unbind(".datetimebox").bind("mousedown.datetimebox",function(a){a.stopPropagation()})}var f=a.options,g=(a.target,$.extend({},f,{onShowPanel:function(){$.extend(a.datebox.calendar.options,{onSelect:function(b){f.onSelect.call(a,b)}}),a.spinner||c(),b(a,f.value,!0),f.onShowPanel.call(a)},buttons:[{text:function(a){return a.options.currentText},handler:function(){var b=a.datebox.calendar;$.extend(b.options,{year:(new Date).getFullYear(),month:(new Date).getMonth()+1,current:new Date}),d(a)}},{text:function(a){return a.options.okText},handler:function(){d(a)}},{text:function(a){return a.options.closeText},handler:function(){a.datebox.combo.hidePanel(),a.options.onHidePanel.call(a)}}],formatter:erajs.ui.Datebox.defaults.formatter,parser:erajs.ui.Datebox.defaults.parser})),h=new erajs.ui.Datebox(g);a.datebox=h,$.extend(h.combo.options,{keyHandler:{up:function(){},down:function(){},left:function(){},right:function(){},enter:function(){d(a)},query:function(b){e(a,b)}}});var i=f.value;if(i)if(erajs.isString(i))h.initValue(i);else if(erajs.isDate(i))b(a,i);else if(erajs.isFunction(i)){var j=i.call();b(a,j)}}function b(a,b,c){function d(a){function b(a){return(10>a?"0":"")+a}var c=[b(a.getHours()),b(a.getMinutes())];return e.showSeconds&&c.push(b(a.getSeconds())),c.join(k.options.separator)}var e=a.options,f=a.datebox,g=f.combo,h=f.calendar,i="",j="";b&&(erajs.isDate(b)||(b=e.parser.call(a,b)),i=j=e.formatter.call(a,b),e.submitFormat&&e.submitFormat!==e.format&&(i=erajs.Date.format(b,e.submitFormat))),f.options.dateValue=b,e.value=i,g.setValue(i),b||(b=new Date),c?h&&h.moveTo(b):g.setText(j);var k=a.spinner;k&&b&&k.setValue(d(b))}function c(a){var b=a.datebox,c=b.calendar,d=a.spinner,e=c.options.current;return new Date(e.getFullYear(),e.getMonth(),e.getDate(),d.getHours(),d.getMinutes(),d.getSeconds())}function d(a){var d=a.datebox.combo,e=a.options,f=c(a);b(a,e.formatter.call(a,f)),d.hidePanel(),a.options.onHidePanel.call(a)}function e(a,c){var d=a.options,e=d.transformQueryStrToD.call(a,c);b(a,e,!0)}erajs.ui.Datetimebox=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Datetimebox.defaults,erajs.ui.Datetimebox.parseOptions(b),a),this.id=this.options.id),this._render()},erajs.ui.Datetimebox.prototype={reset:function(){var a=this,b=a.datebox.combo.options;a.setValue(b.originalValue)},clear:function(){this.options.value="",this.datebox.combo.clear()},hidePanel:function(){this.datebox.combo.hidePanel()},setValue:function(a){b(this,a)},getValue:function(){return this.options.value},disable:function(){this.options.disabled=!0,this.datebox.combo.disable()},enable:function(){this.options.disabled=!1,this.datebox.combo.enable()},readonly:function(a){this.options.readonly=a,this.datebox.combo.readonly(a)},destroy:function(){this.datebox.combo.destroy(),erajs.destroy(this)},_render:function(){a(this)}},erajs.ui.Datetimebox.defaults=$.extend({},erajs.ui.Datebox.defaults,{showSeconds:!0,timeSeparator:":",format:"Y/m/d H:i:s",submitFormat:""}),erajs.ui.Datetimebox.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Datebox.parseOptions(a),erajs.ui.parser.parseOptions(b,["timeSeparator",{showSeconds:"boolean"}]))}}(),function(){function init(a){function b(b){var c=d.nav[b],e=$("<div></div>").appendTo(h);e.wrap("<td></td>");var f=new erajs.ui.Button({target:e,iconCls:c.iconCls,plain:!0});return f.target.unbind(".pagination").bind("click.pagination",function(){c.handler.call(a)}),f}function c(a,b){var c=$.inArray(b,a);return c>=0&&a.splice(c,1),a}var d=a.options,e=a.target,f=a.bb={},g=$(e).addClass("pagination").html('<table cellspacing="0" cellpadding="0" border="0"><tr></tr></table>'),h=g.find("tr"),i=$.extend([],d.layout);d.showPageList||c(i,"list"),d.showRefresh||c(i,"refresh"),"sep"==i[0]&&i.shift(),"sep"==i[i.length-1]&&i.pop();for(var j=0;j<i.length;j++){var k=i[j];if("list"==k){var l=$('<select class="pagination-page-list"></select>');l.bind("change",function(){d.pageSize=parseInt($(this).val()),d.onChangePageSize.call(a,d.pageSize),select(a,d.pageNumber)});for(var m=0;m<d.pageList.length;m++){var n=d.pageList[m];l.append($("<option>").val(n).text(n))}$("<td></td>").append(l).appendTo(h)}else"sep"==k?$('<td><div class="pagination-btn-separator"></div></td>').appendTo(h):"first"==k?f.first=b("first"):"prev"==k?f.prev=b("prev"):"next"==k?f.next=b("next"):"last"==k?f.last=b("last"):"manual"==k?($('<span style="padding-left:6px;"></span>').html(d.beforePageText).appendTo(h).wrap("<td></td>"),f.num=$('<input class="pagination-num" type="text" value="1" size="2">').appendTo(h).wrap("<td></td>"),f.num.unbind(".pagination").bind("keydown.pagination",function(b){if(13==b.keyCode){var c=parseInt($(this).val())||1;
return select(a,c),!1}}),f.after=$('<span style="padding-right:6px;"></span>').appendTo(h).wrap("<td></td>")):"refresh"==k?f.refresh=b("refresh"):"links"==k&&$('<td class="pagination-links"></td>').appendTo(h)}if(d.buttons)if($('<td><div class="pagination-btn-separator"></div></td>').appendTo(h),$.isArray(d.buttons))for(var j=0;j<d.buttons.length;j++){var o=d.buttons[j];if("-"==o)$('<td><div class="pagination-btn-separator"></div></td>').appendTo(h);else{var p=$("<td></td>").appendTo(h),q=$("<div></div>").appendTo(p);new erajs.ui.Button($.extend({},o,{target:q[0],plain:!0}))}}else{var p=$("<td></td>").appendTo(h);$(d.buttons).appendTo(p).show()}$('<div class="pagination-info"></div>').appendTo(g),$('<div style="clear:both;"></div>').appendTo(g)}function select(a,b){var c=a.options;refresh(a,{pageNumber:b}),c.onSelectPage.call(a,c.pageNumber,c.pageSize)}function refresh(a,b){var c=a.options,d=a.bb,e=a.target;$.extend(c,b||{});var f=$(e).find("select.pagination-page-list");f.length&&(f.val(c.pageSize+""),c.pageSize=parseInt(f.val()));var g=Math.ceil(c.total/c.pageSize)||1;c.pageNumber<1&&(c.pageNumber=1),c.pageNumber>g&&(c.pageNumber=g),d.num&&d.num.val(c.pageNumber),d.after&&d.after.html(c.afterPageText.replace(/{pages}/,g));var h=$(e).find("td.pagination-links");if(h.length){h.empty();var i=c.pageNumber-Math.floor(c.links/2);1>i&&(i=1);var j=i+c.links-1;j>g&&(j=g),i=j-c.links+1,1>i&&(i=1);for(var k=i;j>=k;k++){var l=$("<div></div>").appendTo(h),m=new erajs.ui.Button({target:l[0],plain:!0,text:k});k==c.pageNumber?m.select():m.target.unbind(".pagination").bind("click.pagination",{pageNumber:k},function(b){select(a,b.data.pageNumber)})}}var n=c.displayMsg;n=n.replace(/{from}/,0==c.total?0:c.pageSize*(c.pageNumber-1)+1),n=n.replace(/{to}/,Math.min(c.pageSize*c.pageNumber,c.total)),n=n.replace(/{total}/,c.total),$(e).find("div.pagination-info").html(n);var o=d.first;o&&o._setDisabled(1==c.pageNumber);var p=d.prev;p&&p._setDisabled(1==c.pageNumber);var q=d.next;q&&q._setDisabled(c.pageNumber==g);var r=d.last;r&&r._setDisabled(c.pageNumber==g),load(a,c.loading)}function load(a,b){var c=a.options;if(c.loading=b,c.showRefresh&&a.bb.refresh){var d=a.bb.refresh,e=c.loading?"pagination-loading":"pagination-load";d.iconCls!=e&&d.setIcon(e)}}erajs.ui.Pagination=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Pagination.defaults,erajs.ui.Pagination.parseOptions(b),a),this.id=this.options.id),this._render(b)},erajs.ui.Pagination.prototype={pagination:function(a){var b=this.options;$.extend(b,a),this._render()},loading:function(){load(this,!0)},loaded:function(){load(this,!1)},refresh:function(a){refresh(this,a)},select:function(a){select(this,a)},_render:function(){init(this),refresh(this)}},erajs.ui.Pagination.defaults={contentEl:null,total:1,pageSize:10,pageNumber:1,pageList:[10,20,30,50],loading:!1,buttons:null,showPageList:!0,showRefresh:!0,links:10,layout:["list","sep","first","prev","sep","manual","sep","next","last","sep","refresh"],onSelectPage:function(){},onBeforeRefresh:function(){},onRefresh:function(){},onChangePageSize:function(){},beforePageText:"Page",afterPageText:"of {pages}",displayMsg:"Displaying {from} to {to} of {total} items",nav:{first:{iconCls:"pagination-first",handler:function(){var a=this.options;a.pageNumber>1&&this.select(1)}},prev:{iconCls:"pagination-prev",handler:function(){var a=this.options;a.pageNumber>1&&this.select(a.pageNumber-1)}},next:{iconCls:"pagination-next",handler:function(){var a=this.options,b=Math.ceil(a.total/a.pageSize);a.pageNumber<b&&this.select(a.pageNumber+1)}},last:{iconCls:"pagination-last",handler:function(){var a=this.options,b=Math.ceil(a.total/a.pageSize);a.pageNumber<b&&this.select(b)}},refresh:{iconCls:"pagination-refresh",handler:function(){var a=this.options;0!=a.onBeforeRefresh.call(this,a.pageNumber,a.pageSize)&&(this.select(a.pageNumber),a.onRefresh.call(this,a.pageNumber,a.pageSize))}}}},erajs.ui.Pagination.parseOptions=function(target){var t=$(target);return $.extend({},erajs.ui.parser.parseOptions(t,["id",{total:"number",pageSize:"number",pageNumber:"number",links:"number"},{loading:"boolean",showPageList:"boolean",showRefresh:"boolean"}]),{pageList:t.attr("pageList")?eval(t.attr("pageList")):void 0})}}(),function(){function indexOf(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]==b)return c;return-1}function _7(a,b,c){for(var d=a.length,e=0;d>e;e++)if(a[e][b]==c[b])return;a.push(c)}function _4(a,b,c){if("string"==typeof b){for(var d=0,e=a.length;e>d;d++)if(a[d][b]==c)return void a.splice(d,1)}else{var f=indexOf(a,b);-1!=f&&a.splice(f,1)}}function init(self,opts){function getColumns(){var frozenColumns=[],columns=[];return $(target).children("thead").each(function(){var t=$(this),opt=erajs.ui.parser.parseOptions(t,[{frozen:"boolean"}]);t.find("tr").each(function(){var columnsTemp=[];$(this).find("th").each(function(){var th=$(this),col=$.extend({},erajs.ui.parser.parseOptions(th,["field","align","halign","gravity","order",{sortable:"boolean",checkbox:"boolean",resizable:"boolean",fixed:"boolean",tip:"boolean"},{rowspan:"number",colspan:"number",width:"number"}]),{title:th.html()||void 0,hidden:th.attr("hidden")?!0:void 0,formatter:th.attr("formatter")?eval(th.attr("formatter")):void 0,styler:th.attr("styler")?eval(th.attr("styler")):void 0,sorter:th.attr("sorter")?eval(th.attr("sorter")):void 0});if(th.attr("editor")){var s=$.trim(th.attr("editor"));col.editor="{"==s.substr(0,1)?eval("("+s+")"):s}columnsTemp.push(col)}),opt.frozen?frozenColumns.push(columnsTemp):columns.push(columnsTemp)})}),[frozenColumns,columns]}var target=self.target,opts=opts||{},dgBody=$('<div class="datagrid-wrap"><div class="datagrid-view"><div class="datagrid-view1"><div class="datagrid-header"><div class="datagrid-header-inner"></div></div><div class="datagrid-body"><div class="datagrid-body-inner"></div></div><div class="datagrid-footer"><div class="datagrid-footer-inner"></div></div></div><div class="datagrid-view2"><div class="datagrid-header"><div class="datagrid-header-inner"></div></div><div class="datagrid-body"></div><div class="datagrid-footer"><div class="datagrid-footer-inner"></div></div></div></div></div>').insertAfter(target),panel=new erajs.ui.Panel($.extend({},opts,{target:dgBody[0],doSize:!1,onResize:function(a,b){setTimeout(function(){autoFit(self),fitColumns(self),opts.onResize.call(panel,a,b)},0)},onExpand:function(){fixRowHeight(self),opts.onExpand.call(panel)}}));panel.getPanel().addClass("datagrid").bind("_resize",function(a,b){return(1==opts.fit||b)&&(setSize(self),autoFit(self)),!1}),$(target).hide().appendTo(dgBody.children("div.datagrid-view"));var cc=getColumns(),view=dgBody.children("div.datagrid-view"),view1=view.children("div.datagrid-view1"),view2=view.children("div.datagrid-view2");return{panel:panel,frozenColumns:cc[0],columns:cc[1],dc:{view:view,view1:view1,view2:view2,header1:view1.children("div.datagrid-header").children("div.datagrid-header-inner"),header2:view2.children("div.datagrid-header").children("div.datagrid-header-inner"),body1:view1.children("div.datagrid-body").children("div.datagrid-body-inner"),body2:view2.children("div.datagrid-body"),footer1:view1.children("div.datagrid-footer").children("div.datagrid-footer-inner"),footer2:view2.children("div.datagrid-footer").children("div.datagrid-footer-inner")}}}function setSize(a,b){var c=a.options,d=a.panel;if(b&&(b.width&&(c.width=b.width),b.height&&(c.height=b.height)),1==c.fit){var e=d.getPanel().parent();c.width=e.width(),c.height=e.height()}d.resize(c)}function autoFit(a){var b=a.options,c=a.dc,d=a.panel.getBody(),e=d.width(),f=d.height(),g=c.view,h=c.view1,i=c.view2,j=h.children("div.datagrid-header"),k=i.children("div.datagrid-header"),l=j.find("table"),m=k.find("table");g.width(e);var n=j.children("div.datagrid-header-inner").show(),o=n.find("table");h.width(o.length?o.width():0),b.showHeader||n.hide();h._outerWidth();i.width(e-h._outerWidth()),h.children("div.datagrid-header,div.datagrid-body,div.datagrid-footer").width(h.width()),i.children("div.datagrid-header,div.datagrid-body,div.datagrid-footer").width(i.width());var p;j.css("height",""),k.css("height",""),l.css("height",""),m.css("height","");var q=l.height(),r=m.height();if(p=q?Math.max(l.height(),m.height()):r,l.height(p),m.height(p),j.add(k)._outerHeight(p),"auto"!=b.height){var s=f-i.children("div.datagrid-header")._outerHeight()-i.children("div.datagrid-footer")._outerHeight()-d.children("div.datagrid-toolbar")._outerHeight();d.children("div.datagrid-pager").each(function(){s-=$(this)._outerHeight()}),c.body1.add(c.body2).children("table.datagrid-btable-frozen").css({position:"absolute",top:c.header2._outerHeight()});var t=c.body2.children("table.datagrid-btable-frozen")._outerHeight();h.add(i).children("div.datagrid-body").css({marginTop:t,height:s-t})}g.height(i.height())}function createStyleSheet(a){var b=a.options,c=a.panel,d=a.dc,e=null;b.sharedStyleSheet?e="boolean"==typeof b.sharedStyleSheet?"head":b.sharedStyleSheet:(e=c.getPanel().closest("div.datagrid-view"),e.length||(e=d.view));var f=$(e),g=$.data(f[0],"ss");return g||(g=$.data(f[0],"ss",{cache:{},dirty:[]})),{add:function(a){for(var b=['<style type="text/css" easyui="true">'],c=0;c<a.length;c++)g.cache[a[c][0]]={width:a[c][1]};var d=0;for(var e in g.cache){var h=g.cache[e];h.index=d++,b.push(e+"{width:"+h.width+"}")}b.push("</style>"),$(b.join("\n")).appendTo(f),f.children("style[easyui]:not(:last)").remove()},getRule:function(a){var b=f.children("style[easyui]:last")[0],c=b.styleSheet?b.styleSheet:b.sheet||document.styleSheets[document.styleSheets.length-1],d=c.cssRules||c.rules;return d[a]},set:function(a,b){var c=g.cache[a];if(c){c.width=b;var d=this.getRule(c.index);d&&(d.style.width=b)}},remove:function(a){var b=[];for(var c in g.cache)-1==c.indexOf(a)&&b.push([c,g.cache[c].width]);g.cache={},this.add(b)},dirty:function(a){a&&g.dirty.push(a)},clean:function(){for(var a=0;a<g.dirty.length;a++)this.remove(g.dirty[a]);g.dirty=[]}}}function _58(a){function b(b,c,e){if(c){$(b).show(),$(b).empty();var g=[],h=[];d.sortName&&(g=d.sortName.split(","),h=d.sortOrder.split(","));for(var i=$('<table class="datagrid-htable" border="0" cellspacing="0" cellpadding="0"><tbody></tbody></table>').appendTo(b),j=0;j<c.length;j++)for(var k=$('<tr class="datagrid-header-row"></tr>').appendTo($("tbody",i)),l=c[j],m=0;m<l.length;m++){var n=l[m],o="";n.rowspan&&(o+='rowspan="'+n.rowspan+'" '),n.colspan&&(o+='colspan="'+n.colspan+'" ');var p=$("<td "+o+"></td>").appendTo(k);if(n.checkbox)p.attr("field",n.field),$('<div class="datagrid-header-check"></div>').html('<input type="checkbox"/>').appendTo(p);else if(n.field){p.attr("field",n.field),p.append('<div class="datagrid-cell"><span></span><span class="datagrid-sort-icon"></span></div>'),$("span",p).html(n.title),$("span.datagrid-sort-icon",p).html("&nbsp;");var q=p.find("div.datagrid-cell"),r=indexOf(g,n.field);if(r>=0&&q.addClass("datagrid-sort-"+h[r]),0==n.resizable&&q.attr("resizable","false"),n.width){var s=erajs.ui.parser.parseValue("width",n.width,f.view,d.scrollbarSize);q._outerWidth(s-1),n.boxWidth=parseInt(q[0].style.width),n.deltaWidth=s-n.boxWidth}else n.auto=!0;q.css("text-align",n.halign||n.align||"center"),n.cellClass=a.cellClassPrefix+"-"+n.field.replace(/[\.|\s]/g,"-"),q.addClass(n.cellClass).css("width","")}else $('<div class="datagrid-cell-group"></div>').html(n.title).appendTo(p);n.hidden&&p.hide()}if(e&&d.rownumbers){var p=$('<td rowspan="'+d.frozenColumns.length+'"><div class="datagrid-header-rownumber"></div></td>');0==$("tr",i).length?p.wrap('<tr class="datagrid-header-row"></tr>').parent().appendTo($("tbody",i)):p.prependTo($("tr:first",i))}}}function c(){for(var b=[],c=getColumnFields(a,!0).concat(getColumnFields(a)),d=0;d<c.length;d++){var e=getColumnOption(a,c[d]);e&&!e.checkbox&&b.push(["."+e.cellClass,e.boxWidth?e.boxWidth+"px":"auto"])}a.ss.add(b),a.ss.dirty(a.cellSelectorPrefix),a.cellSelectorPrefix="."+a.cellClassPrefix}var d=(a.target,a.options),e=a.panel,f=a.dc;a.ss=a.createStyleSheet(),a.rowIdPrefix="datagrid-row-r"+ ++index,a.cellClassPrefix="datagrid-cell-c"+index,b(f.header1,d.frozenColumns,!0),b(f.header2,d.columns,!1),c(),f.header1.add(f.header2).css("display",d.showHeader?"block":"none"),f.footer1.add(f.footer2).css("display",d.showFooter?"block":"none");var g=e.target;if(d.toolbar)if($.isArray(d.toolbar)){$("div.datagrid-toolbar",e).remove();for(var h=$('<div class="datagrid-toolbar"><table cellspacing="0" cellpadding="0"><tr></tr></table></div>').prependTo(e.target),i=h.find("tr"),j=0;j<d.toolbar.length;j++){var k=d.toolbar[j];if("-"==k)$('<td><div class="datagrid-btn-separator"></div></td>').appendTo(i);else{var l=$("<td></td>").appendTo(i),m=$("<div></div>").appendTo(l);new erajs.ui.Button($.extend({},k,{target:m[0],plain:!0}))}}}else $(d.toolbar).addClass("datagrid-toolbar").prependTo(g),$(d.toolbar).show();else $("div.datagrid-toolbar",g).remove();if($("div.datagrid-pager",g).remove(),d.pagination){var n=$('<div class="datagrid-pager"></div>');"bottom"==d.pagePosition?n.appendTo(g):"top"==d.pagePosition&&n.addClass("datagrid-pager-top").prependTo(g);var o=new erajs.ui.Pagination({target:n[0],total:d.pageNumber*d.pageSize,buttons:d.pagingButtons?d.pagingButtons:[],pageNumber:d.pageNumber,pageSize:d.pageSize,pageList:d.pageList,onSelectPage:function(b,c){d.pageNumber=b,d.pageSize=c,this.refresh({pageNumber:b,pageSize:c}),request(a)}});d.pageSize=o.options.pageSize,a.pager=o}}function bindEvents(a){function b(a){return a.attr("datagrid-row-index")?parseInt(a.attr("datagrid-row-index")):a.attr("node-id")}function c(a){return a.length&&a.parent().length}var d=a.panel.getPanel(),e=a.options,f=a.dc,g=f.header1.add(f.header2);g.find("input[type=checkbox]").unbind(".datagrid").bind("click.datagrid",function(b){return e.singleSelect&&e.selectOnCheck?!1:($(this).is(":checked")?checkAll(a):uncheckAll(a),void b.stopPropagation())});var h=g.find("div.datagrid-cell");h.closest("td").unbind(".datagrid").bind("mouseenter.datagrid",function(){a.resizing||$(this).addClass("datagrid-header-over")}).bind("mouseleave.datagrid",function(){$(this).removeClass("datagrid-header-over")}),h.unbind(".datagrid").bind("click.datagrid",function(b){var c=$(this).offset().left+5,d=$(this).offset().left+$(this)._outerWidth()-5;if(b.pageX<d&&b.pageX>c){var e=$(this).parent().attr("field");sort(a,e)}}).bind("dblclick.datagrid",function(b){var c=$(this).offset().left+5,d=$(this).offset().left+$(this)._outerWidth()-5,f="right"==e.resizeHandle?b.pageX>d:"left"==e.resizeHandle?b.pageX<c:b.pageX<c||b.pageX>d;if(f){var g=$(this).parent().attr("field"),h=getColumnOption(a,g);if(0==h.resizable)return;a.autoSizeColumn(g),h.auto=!1}});var i="right"==e.resizeHandle?"e":"left"==e.resizeHandle?"w":"e,w";h.each(function(){$(this).resizable({handles:i,disabled:$(this).attr("resizable")?"false"==$(this).attr("resizable"):!1,minWidth:25,onStartResize:function(b){a.resizing=!0,g.css("cursor",$("body").css("cursor")),a.proxy||(a.proxy=$('<div class="datagrid-resize-proxy"></div>').appendTo(f.view)),a.proxy.css({left:b.pageX-$(d).offset().left-1,display:"none"}),setTimeout(function(){a.proxy&&a.proxy.show()},500)},onResize:function(b){return a.proxy.css({left:b.pageX-$(d).offset().left-1,display:"block"}),!1},onStopResize:function(){g.css("cursor",""),$(this).css("height",""),$(this)._outerWidth($(this)._outerWidth());var b=$(this).parent().attr("field"),c=getColumnOption(a,b);c.width=$(this)._outerWidth(),c.boxWidth=c.width-c.deltaWidth,c.auto=void 0,$(this).css("width",""),fixColumnSize(a,b),a.proxy.remove(),a.proxy=null,$(this).parents("div:first.datagrid-header").parent().hasClass("datagrid-view1")&&autoFit(a),fitColumns(a),e.onResizeColumn.call(a,b,c.width),setTimeout(function(){a.resizing=!1},0)}})}),f.body1.add(f.body2).unbind().bind("mouseover",function(d){if(!a.resizing){var e=$(d.target),f=e.closest("tr.datagrid-row");if(c(f)){var g=b(f);highlightRow(a,g),d.stopPropagation()}}}).bind("mouseout",function(d){var f=$(d.target).closest("tr.datagrid-row");if(c(f)){var g=b(f);e.finder.getTr(a,g).removeClass("datagrid-row-over"),d.stopPropagation()}}).bind("click",function(d){var f=$(d.target),g=f.closest("tr.datagrid-row");if(c(g)){var h=b(g);if(f.parent().hasClass("datagrid-cell-check"))e.singleSelect&&e.selectOnCheck?(e.checkOnSelect||uncheckAll(a,!0),checkRow(a,h)):f.is(":checked")?checkRow(a,h):uncheckRow(a,h);else{var i=e.finder.getRow(a,h),j=f.closest("td[field]",g);if(j.length){var k=j.attr("field");e.onClickCell.call(a,h,k,i[k])}1==e.singleSelect?selectRow(a,h):e.ctrlSelect?d.ctrlKey?g.hasClass("datagrid-row-selected")?unselectRow(a,h):selectRow(a,h):(a.clearSelections(),selectRow(a,h)):g.hasClass("datagrid-row-selected")?unselectRow(a,h):selectRow(a,h),e.onClickRow.call(a,h,i)}d.stopPropagation()}}).bind("dblclick",function(d){var f=$(d.target),g=f.closest("tr.datagrid-row");if(c(g)){var h=b(g),i=e.finder.getRow(a,h),j=f.closest("td[field]",g);if(j.length){var k=j.attr("field");e.onDblClickCell.call(a,h,k,i[k])}e.onDblClickRow.call(a,h,i),d.stopPropagation()}}).bind("contextmenu",function(d){var f=$(d.target).closest("tr.datagrid-row");if(c(f)){var g=b(f),h=e.finder.getRow(a,g);e.onRowContextMenu.call(a,d,g,h),d.stopPropagation()}}),f.body2.bind("scroll",function(){var a=f.view1.children("div.datagrid-body");a.scrollTop($(this).scrollTop());var b=f.body1.children(":first"),c=f.body2.children(":first");if(b.length&&c.length){var d=b.offset().top,e=c.offset().top;d!=e&&a.scrollTop(a.scrollTop()+d-e)}f.view2.children("div.datagrid-header,div.datagrid-footer")._scrollLeft($(this)._scrollLeft()),f.body2.children("table.datagrid-btable-frozen").css("left",-$(this)._scrollLeft())})}function getColumnFields(a,b){function c(a){for(var b=0,c=0;;){if(void 0==g[c]){if(b==a)return c;b++}c++}}function d(a){for(var b=[],d=0,e=0;e<f[a].length;e++){var h=f[a][e];h.field&&b.push([d,h.field]),d+=parseInt(h.colspan||"1")}for(var e=0;e<b.length;e++)b[e][0]=c(b[e][0]);for(var e=0;e<b.length;e++){var i=b[e];g[i[0]]=i[1]}}var e=a.options,f=1==b?e.frozenColumns||[[]]:e.columns;if(0==f.length)return[];for(var g=[],h=0;h<f.length;h++)d(h);return g}function getColumnOption(a,b){function c(a){if(a)for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.length;e++){var f=d[e];if(f.field==b)return f}return null}var d=a.options,e=c(d.columns);return e||(e=c(d.frozenColumns)),e}function getSelections(a){var b=a.options;if(b.idField)return a.selectedRows;var c=[];return b.finder.getTr(a,"","selected",2).each(function(){c.push(b.finder.getRow(a,$(this)))}),c}function getRowIndex(a,b){var c=a.options,d=a.data.rows;if("object"==typeof b)return indexOf(d,b);for(var e=0;e<d.length;e++)if(d[e][c.idField]==b)return e;return-1}function getChecked(a){var b=a.options;if(b.idField)return a.checkedRows;var c=[];return b.finder.getTr(a,"","checked",2).each(function(){c.push(b.finder.getRow(a,$(this)))}),c}function request(a,b){function c(){var b=d.loader.call(a,e,function(b){setTimeout(function(){a.loaded()},0),loadData(a,b),setTimeout(function(){history(a)},0)},function(){setTimeout(function(){a.loaded()},0),d.onLoadError.apply(a,arguments)});0==b&&a.loaded()}var d=a.options;b&&(d.queryParams=b);var e=$.extend({},d.queryParams);d.pagination&&$.extend(e,{page:d.pageNumber,rows:d.pageSize}),d.sortName&&$.extend(e,{sort:d.sortName,order:d.sortOrder}),0!=d.onBeforeLoad.call(a,e)&&(a.loading(),setTimeout(function(){c()},0))}function history(a){for(var b=a.data,c=b.rows,d=[],e=0;e<c.length;e++)d.push($.extend({},c[e]));a.originalRows=d,a.updatedRows=[],a.insertedRows=[],a.deletedRows=[]}function loadData(a,b){var c=(a.target,a.options),d=a.dc;if(b=c.loadFilter.call(a,b),b.total=parseInt(b.total),a.data=b,b.footer&&(a.footer=b.footer),!c.remoteSort&&c.sortName){var e=c.sortName.split(","),f=c.sortOrder.split(",");b.rows.sort(function(b,c){for(var d=0,g=0;g<e.length;g++){var h=e[g],i=f[g],j=getColumnOption(a,h),k=j.sorter||function(a,b){return a==b?0:a>b?1:-1};if(d=k(b[h],c[h])*("asc"==i?1:-1),0!=d)return d}return d})}var g=a.getPager();if(g){var h=g.options;h.total!=b.total&&g.refresh({total:b.total}),c.pageNumber!=h.pageNumber&&(c.pageNumber=h.pageNumber)}c.view.onBeforeRender&&c.view.onBeforeRender.call(c.view,a,b.rows),c.view.render.call(c.view,a,d.body2,!1),c.view.render.call(c.view,a,d.body1,!0),c.showFooter&&(c.view.renderFooter.call(c.view,a,d.footer2,!1),c.view.renderFooter.call(c.view,a,d.footer1,!0)),c.view.onAfterRender&&c.view.onAfterRender.call(c.view,a),a.ss.clean(),fixRowHeight(a),c.onLoadSuccess.call(a,b),c.fitRowNumbers&&fixRownumber(a),d.body2.triggerHandler("scroll"),setSelectionState(a),a.autoSizeColumn(),showCellTips(a)}function fixRownumber(a){var b=(a.options,a.getPanel()),c=$(".datagrid-cell-rownumber",b).last().clone();c.css({position:"absolute",left:-1e3}).appendTo("body");var d=c.width("auto").width();d>25?($(".datagrid-header-rownumber,.datagrid-cell-rownumber",b).width(d+5),a.resize()):$(".datagrid-header-rownumber,.datagrid-cell-rownumber",b).removeAttr("style"),c.remove(),c=null}function showCellTips(a){var b=a.options,c=b.showTip,d=a.data.rows;if(c)for(var e=a.dc,f=e.body2.find(".datagrid-row"),g=0;g<f.length;g++)for(var h=$(f[g]),i=h.find("td[field]"),j=0;j<i.length;j++){var k=i[j],l=$(k),m=l.attr("tip");if(m){var n=l.attr("field"),o=l.attr("gravity");erajs.Extra.showTipsy(l,{gravity:o,fallback:d[g][n]})}}}function autoSizeColumn(a,b){function c(b){function c(c){function e(a){return a.is(":visible")?a._outerWidth():f.html(a.html())._outerWidth()}var h=0;return"header"==c?h=e(g):d.finder.getTr(a,0,c).find('td[field="'+b+'"] div.datagrid-cell').each(function(){var a=e($(this));a>h&&(h=a)}),h}var g=e.view.find('div.datagrid-header td[field="'+b+'"] div.datagrid-cell');g.css("width","");var h=a.getColumnOption(b);h.width=void 0,h.boxWidth=void 0,h.auto=!0,a.fixColumnSize(b);var i=Math.max(c("header"),c("allbody"),c("allfooter"));g._outerWidth(i),h.width=i,h.boxWidth=parseInt(g[0].style.width),h.deltaWidth=i-h.boxWidth,g.css("width",""),a.fixColumnSize(b),d.onResizeColumn.call(a,b,h.width)}var d=a.options,e=a.dc,f=$('<div class="datagrid-cell" style="position:absolute;left:-9999px"></div>').appendTo("body");if(b)c(b),d.fitColumns&&(autoFit(a),fitColumns(a));else{for(var g=!1,h=getColumnFields(a,!0).concat(getColumnFields(a,!1)),i=0;i<h.length;i++){var b=h[i],j=getColumnOption(a,b);j.auto&&(c(b),g=!0)}g&&d.fitColumns&&(autoFit(a),fitColumns(a))}f.remove()}function fixRowHeight(a,b,c){function d(a,b){for(var c=0;c<b.length;c++){var d=$(a[c]),e=$(b[c]);d.css("height",""),e.css("height","");var f=Math.max(d.height(),e.height());d.css("height",f),e.css("height",f)}}function e(a){var b=0,c=0;return $(a).children().each(function(){var a=$(this);a.is(":visible")&&(c+=a._outerHeight(),b<a._outerWidth()&&(b=a._outerWidth()))}),{width:b,height:c}}var f=(a.data.rows,a.options),g=a.dc;if(!g.body1.is(":empty")&&(!f.nowrap||f.autoRowHeight||c))if(void 0!=b){var h=f.finder.getTr(a,b,"body",1),i=f.finder.getTr(a,b,"body",2);d(h,i)}else{var h=f.finder.getTr(a,0,"allbody",1),i=f.finder.getTr(a,0,"allbody",2);if(d(h,i),f.showFooter){var h=f.finder.getTr(a,0,"allfooter",1),i=f.finder.getTr(a,0,"allfooter",2);d(h,i)}}if(autoFit(a),"auto"==f.height){var j=g.body1.parent(),k=g.body2,l=e(k),m=l.height;l.width>k.width()&&(m+=18),j.height(m),k.height(m),g.view.height(g.view2.height())}g.body2.triggerHandler("scroll")}function fixColumnSize(a,b){function c(b){var c=getColumnOption(a,b);c.checkbox||a.ss.set("."+c.cellClass,c.boxWidth?c.boxWidth+"px":"auto")}var d=(a.options,a.dc),e=d.view.find("table.datagrid-btable,table.datagrid-ftable");if(e.css("table-layout","fixed"),b)c(b);else for(var f=getColumnFields(a,!0).concat(getColumnFields(a,!1)),g=0;g<f.length;g++)c(f[g]);e.css("table-layout","auto"),mergedCellWidth(a),setTimeout(function(){fixRowHeight(a),fixEditable(a)},0)}function mergedCellWidth(a){var b=a.dc;b.body1.add(b.body2).find("td.datagrid-td-merged").each(function(){for(var b=$(this),c=b.attr("colspan")||1,d=getColumnOption(a,b.attr("field")),e=d.boxWidth+d.deltaWidth-1,f=1;c>f;f++)b=b.next(),d=getColumnOption(a,b.attr("field")),e+=d.boxWidth+d.deltaWidth;$(this).children("div.datagrid-cell")._outerWidth(e)})}function fixEditable(a){var b=a.dc;b.view.find("div.datagrid-editable").each(function(){var b=$(this),c=b.parent().attr("field"),d=a.getColumnOption(c);b._outerWidth(d.boxWidth+d.deltaWidth-1);var e=$.data(this,"datagrid.editor");e.actions.resize&&e.actions.resize(e.component,b.width())})}function setSelectionState(a){function b(a,b){for(var d=0;d<a.length;d++)if(a[d][c.idField]==b[c.idField])return a[d]=b,!0;return!1}var c=a.options;if(c.idField){var d="treegrid"===erajs.getCmp(a.id).xtype?!0:!1,e=c.onSelect,f=c.onCheck;c.onSelect=c.onCheck=function(){};for(var g=c.finder.getRows(a),h=0;h<g.length;h++){var i=g[h],j=d?i[c.idField]:h;b(a.selectedRows,i)&&selectRow(a,j,!0),b(a.checkedRows,i)&&checkRow(a,j,!0)}c.onSelect=e,c.onCheck=f}}function sort(a,b){var c=a.options;b=b||{};var d={sortName:c.sortName,sortOrder:c.sortOrder};"object"==typeof b&&$.extend(d,b);var e=[],f=[];if(d.sortName&&(e=d.sortName.split(","),f=d.sortOrder.split(",")),"string"==typeof b){var g=b,h=getColumnOption(a,g);if(!h.sortable||a.resizing)return;var i=h.order||"asc",j=indexOf(e,g);if(j>=0){var k="asc"==f[j]?"desc":"asc";c.multiSort&&k==i?(e.splice(j,1),f.splice(j,1)):f[j]=k}else c.multiSort?(e.push(g),f.push(i)):(e=[g],f=[i]);d.sortName=e.join(","),d.sortOrder=f.join(",")}if(0!=c.onBeforeSortColumn.call(a,d.sortName,d.sortOrder)){$.extend(a.options,d);var l=a.dc,m=l.header1.add(l.header2);m.find("div.datagrid-cell").removeClass("datagrid-sort-asc datagrid-sort-desc");for(var n=0;n<e.length;n++){var h=getColumnOption(a,e[n]);m.find("div."+h.cellClass).addClass("datagrid-sort-"+f[n])}c.remoteSort?request(a):loadData(a,a.getData()),c.onSortColumn.call(a,c.sortName,c.sortOrder)}}function fitColumns(a){function b(){if(e.fitColumns){a.leftWidth||(a.leftWidth=0);for(var b=0,c=[],f=getColumnFields(a,!1),h=0;h<f.length;h++){var i=getColumnOption(a,f[h]);d(i)&&(b+=i.width,c.push({field:i.field,col:i,addingWidth:0}))}if(b){c[c.length-1].addingWidth-=a.leftWidth;var j=g.children("div.datagrid-header-inner").show(),k=g.width()-g.find("table").width()-e.scrollbarSize+a.leftWidth,l=k/b;e.showHeader||j.hide();for(var h=0;h<c.length;h++){var m=c[h],n=parseInt(m.col.width*l);m.addingWidth+=n,k-=n}c[c.length-1].addingWidth+=k;for(var h=0;h<c.length;h++){var m=c[h];m.col.boxWidth+m.addingWidth>0&&(m.col.boxWidth+=m.addingWidth,m.col.width+=m.addingWidth)}a.leftWidth=k,fixColumnSize(a)}}}function c(){var b=!1,c=getColumnFields(a,!0).concat(getColumnFields(a,!1));$.map(c,function(c){var d=getColumnOption(a,c);if(String(d.width||"").indexOf("%")>=0){var g=erajs.ui.parser.parseValue("width",d.width,f.view,e.scrollbarSize)-d.deltaWidth;g>0&&(d.boxWidth=g,b=!0)}}),b&&fixColumnSize(a)}function d(a){return String(a.width||"").indexOf("%")>=0?!1:a.hidden||a.checkbox||a.auto||a.fixed?void 0:!0}var e=a.options,f=a.dc,g=f.view2.children("div.datagrid-header");f.body2.css("overflow-x",""),c(),b(),g.width()>=g.find("table").width()&&f.body2.css("overflow-x","hidden")}function scrollTo(a,b){var c=a.dc,d=a.options,e=d.finder.getTr(a,b);if(e.length){if(e.closest("table").hasClass("datagrid-btable-frozen"))return;var f=c.view2.children("div.datagrid-header")._outerHeight(),g=c.body2,h=g.outerHeight(!0)-g.outerHeight(),i=e.position().top-f-h;0>i?g.scrollTop(g.scrollTop()+i):i+e._outerHeight()>g.height()-18&&g.scrollTop(g.scrollTop()+i+e._outerHeight()-g.height()+18)}}function freezeRow(a,b){function c(c){var f=c?1:2;if($.isArray(b))for(i=0;i<b.length;i++){var g=d.finder.getTr(a,b[i],"body",f);(c?e.body1:e.body2).children("table.datagrid-btable-frozen").append(g)}else if("number"==typeof b){var g=d.finder.getTr(a,b,"body",f);(c?e.body1:e.body2).children("table.datagrid-btable-frozen").append(g)}}var d=a.options,e=a.dc;e.body2.children("table.datagrid-btable-frozen").length||e.body1.add(e.body2).prepend('<table class="datagrid-btable datagrid-btable-frozen" cellspacing="0" cellpadding="0"></table>'),c(!0),c(!1),autoFit(a)}function highlightRow(a,b){var c=a.options;c.finder.getTr(a,a.highlightIndex).removeClass("datagrid-row-over"),c.finder.getTr(a,b).addClass("datagrid-row-over"),a.highlightIndex=b}function selectRow(a,b,c){var d=(a.dc,a.options),e=a.selectedRows;d.singleSelect&&(unselectAll(a),e.splice(0,e.length)),!c&&d.checkOnSelect&&checkRow(a,b,!0);var f=d.finder.getRow(a,b);d.idField&&_7(e,d.idField,f),d.finder.getTr(a,b).addClass("datagrid-row-selected"),d.onSelect.call(a,b,f),scrollTo(a,b)}function unselectRow(a,b,c){var d=(a.dc,a.options),e=a.selectedRows;!c&&d.checkOnSelect&&uncheckRow(a,b,!0),d.finder.getTr(a,b).removeClass("datagrid-row-selected");var f=d.finder.getRow(a,b);d.idField&&_4(e,d.idField,f[d.idField]),d.onUnselect.call(a,b,f)}function unselectAll(a,b){var c=a.options,d=c.finder.getRows(a),e=a.selectedRows;if(!b&&c.checkOnSelect&&uncheckAll(a,!0),c.finder.getTr(a,"","selected").removeClass("datagrid-row-selected"),c.idField)for(var f=0;f<d.length;f++)_4(e,c.idField,d[f][c.idField]);c.onUnselectAll.call(a,d)}function checkRow(a,b,c){var d=a.options;!c&&d.selectOnCheck&&selectRow(a,b,!0);var e=d.finder.getTr(a,b).addClass("datagrid-row-checked"),f=e.find("div.datagrid-cell-check input[type=checkbox]");if(f._propAttr("checked",!0),e=d.finder.getTr(a,"","checked",2),e.length==d.finder.getRows(a).length){var g=a.dc,h=g.header1.add(g.header2);h.find("input[type=checkbox]")._propAttr("checked",!0)}var i=d.finder.getRow(a,b);d.idField&&_7(a.checkedRows,d.idField,i),d.onCheck.call(a,b,i)}function uncheckRow(a,b,c){var d=a.options;!c&&d.selectOnCheck&&unselectRow(a,b,!0);var e=d.finder.getTr(a,b).removeClass("datagrid-row-checked"),f=e.find("div.datagrid-cell-check input[type=checkbox]");f._propAttr("checked",!1);var g=a.dc,h=g.header1.add(g.header2);h.find("input[type=checkbox]")._propAttr("checked",!1);var i=d.finder.getRow(a,b);d.idField&&_4(a.checkedRows,d.idField,i[d.idField]),d.onUncheck.call(a,b,i)}function uncheckAll(a,b){var c=a.options,d=c.finder.getRows(a);!b&&c.selectOnCheck&&unselectAll(a,!0);var e=a.dc,f=e.header1.add(e.header2).find("input[type=checkbox]"),g=c.finder.getTr(a,"","checked").removeClass("datagrid-row-checked").find("div.datagrid-cell-check input[type=checkbox]");if(f.add(g)._propAttr("checked",!1),c.idField)for(var h=0;h<d.length;h++)_4(a.checkedRows,c.idField,d[h][c.idField]);c.onUncheckAll.call(a,d)}function selectAll(a,b){var c=a.options,d=c.finder.getRows(a),e=a.selectedRows;if(!b&&c.checkOnSelect&&checkAll(a,!0),c.finder.getTr(a,"","allbody").addClass("datagrid-row-selected"),c.idField)for(var f=0;f<d.length;f++)_7(e,c.idField,d[f]);c.onSelectAll.call(a,d)}function checkAll(a,b){var c=a.options,d=c.finder.getRows(a);!b&&c.selectOnCheck&&selectAll(a,!0);var e=a.dc,f=e.header1.add(e.header2).find("input[type=checkbox]"),g=c.finder.getTr(a,"","allbody").addClass("datagrid-row-checked").find("div.datagrid-cell-check input[type=checkbox]");if(f.add(g)._propAttr("checked",!0),c.idField)for(var h=0;h<d.length;h++)_7(a.checkedRows,c.idField,d[h]);c.onCheckAll.call(a,d)}function mergeCells(a,b){var c=a.options;if(b.rowspan=b.rowspan||1,b.colspan=b.colspan||1,1!=b.rowspan||1!=b.colspan){var d=c.finder.getTr(a,void 0!=b.index?b.index:b.id);if(d.length){var e=c.finder.getRow(a,d),f=e[b.field],g=d.find('td[field="'+b.field+'"]');g.attr("rowspan",b.rowspan).attr("colspan",b.colspan),g.addClass("datagrid-td-merged");for(var h=1;h<b.colspan;h++)g=g.next(),g.hide(),e[g.attr("field")]=f;for(var h=1;h<b.rowspan&&(d=d.next(),d.length);h++){var e=c.finder.getRow(a,d),g=d.find('td[field="'+b.field+'"]').hide();e[g.attr("field")]=f;for(var i=1;i<b.colspan;i++)g=g.next(),g.hide(),e[g.attr("field")]=f}updateMergeCells(a)}}}function updateMergeCells(a){var b=a.dc;b.body1.add(b.body2).find("td.datagrid-td-merged").each(function(){for(var b=$(this),c=b.attr("colspan")||1,d=getColumnOption(a,b.attr("field")).width,e=1;c>e;e++)b=b.next(),d+=getColumnOption(a,b.attr("field")).width+1;
$(this).children("div.datagrid-cell")._outerWidth(d)})}function appendRow(a,b){var c=a.data,d=a.options.view,e=a.insertedRows;d.insertRow.call(d,a,null,b),e.push(b);var f=a.getPager();f&&f.refresh({total:c.total})}function insertRow(a,b){var c=a.data,d=a.options.view,e=a.insertedRows;d.insertRow.call(d,a,b.index,b.row),e.push(b.row);var f=a.getPager();f&&f.refresh({total:c.total})}function deleteRow(a,b){var c=a.options,d=a.data,e=a.insertedRows,f=a.deletedRows;a.cancelEdit(b);var g=c.finder.getRow(a,b);indexOf(e,g)>=0?_4(e,g):f.push(g),_4(a.selectedRows,c.idField,g[c.idField]),_4(a.checkedRows,c.idField,g[c.idField]),c.view.deleteRow.call(c.view,a,b),"auto"==c.height&&fixRowHeight(a);var h=a.getPager();h&&h.refresh({total:d.total})}function getChanges(a,b){var c=a.insertedRows,d=a.deletedRows,e=a.updatedRows;if(!b){var f=[];return f=f.concat(c),f=f.concat(d),f=f.concat(e)}return"inserted"==b?c:"deleted"==b?d:"updated"==b?e:[]}function acceptChanges(a){for(var b=a.data,c=!0,d=0,e=b.rows.length;e>d;d++)validateRow(a,d)?processEditRow(a,d,!1):c=!1;c&&history(a)}function rejectChanges(a){function b(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c][d.idField]);return b}function c(b,c){for(var d=0;d<b.length;d++){var e=_e3(a,b[d]);e>=0&&("s"==c?selectRow:checkRow)(a,e,!0)}}for(var d=a.options,e=a.originalRows,f=a.insertedRows,g=a.deletedRows,h=a.selectedRows,i=a.checkedRows,j=a.data,k=0;k<j.rows.length;k++)processEditRow(a,k,!0);var l=b(h),m=b(i);h.splice(0,h.length),i.splice(0,i.length),j.total+=g.length-f.length,j.rows=e,loadData(a,j),c(l,"s"),c(m,"c"),history(a)}function validateRow(a,b){var c=a.options.finder.getTr(a,b);if(!c.hasClass("datagrid-row-editing"))return!0;var d=c.find(".validatebox-invalid");return 0==d.length}function initEditor(a,b){var c=a.options,d=c.finder.getTr(a,b);d.children("td").each(function(){var b=$(this).find("div.datagrid-cell"),d=$(this).attr("field"),e=getColumnOption(a,d);if(e&&e.editor){var f,g;"string"==typeof e.editor?f=e.editor:(f=e.editor.type,g=e.editor.options);var h=c.editors[f];if(h){var i=b.html(),j=b._outerWidth();b.addClass("datagrid-editable"),b._outerWidth(j),b.html('<table border="0" cellspacing="0" cellpadding="1"><tr><td></td></tr></table>'),b.children("table").bind("click dblclick contextmenu",function(a){a.stopPropagation()}),$.data(b[0],"datagrid.editor",{actions:h,component:h.init(b.find("td"),g),field:d,type:f,oldHtml:i})}}}),fixRowHeight(a,b,!0)}function beginEdit(a,b){var c=a.options,d=c.finder.getTr(a,b),e=c.finder.getRow(a,b);d.hasClass("datagrid-row-editing")||0!=c.onBeforeEdit.call(a,b,e)&&(d.addClass("datagrid-row-editing"),initEditor(a,b),fixEditable(a),d.find("div.datagrid-editable").each(function(){var a=$(this).parent().attr("field"),b=$.data(this,"datagrid.editor");b.actions.setValue(b.component,e[a])}),validateRow(a,b),c.onBeginEdit.call(a,b,e))}function processEditRow(a,b,c){var d=a.options,e=a.updatedRows,f=a.insertedRows,g=d.finder.getTr(a,b),h=d.finder.getRow(a,b);if(g.hasClass("datagrid-row-editing")){if(!c){if(!validateRow(a,b))return;var i=!1,j={};g.find("div.datagrid-editable").each(function(){var a=$(this).parent().attr("field"),b=$.data(this,"datagrid.editor"),c=b.actions.getValue(b.component);h[a]!=c&&(h[a]=c,i=!0,j[a]=c)}),i&&-1==indexOf(f,h)&&-1==indexOf(e,h)&&e.push(h),d.onEndEdit.call(a,b,h,j)}g.removeClass("datagrid-row-editing"),destroyEdit(a,b),a.refreshRow(b),c?d.onCancelEdit.call(a,b,h):d.onAfterEdit.call(a,b,h,j)}}function destroyEdit(a,b){var c=a.options,d=c.finder.getTr(a,b);d.children("td").each(function(){var a=$(this).find("div.datagrid-editable");if(a.length){var b=$.data(a[0],"datagrid.editor");b.actions.destroy&&b.actions.destroy(b.component),a.html(b.oldHtml),$.removeData(a[0],"datagrid.editor"),a.removeClass("datagrid-editable"),a.css("width","")}})}function getEditors(a,b){var c=a.options,d=c.finder.getTr(a,b),e=[];return d.children("td").each(function(){var a=$(this).find("div.datagrid-editable");if(a.length){var b=$.data(a[0],"datagrid.editor");e.push(b)}}),e}function getEditor(a,b){for(var c=getEditors(a,void 0!=b.index?b.index:b.id),d=0;d<c.length;d++)if(c[d].field==b.field)return c[d];return null}function radomEditorName(a,b){var c="";return c=b&&b.name?b.name:a.closest("td[field]").attr("field")}var index=0;erajs.ui.Datagrid=function(a,b){a=a||{},b=b||{};var c,d=a.target;if(!d){var e=a.contentEl;e&&(d=$(e))}if(d){this.target=d,c=$.extend({},$.extend({},erajs.ui.Datagrid.defaults,{queryParams:{}}),b,erajs.ui.Datagrid.parseOptions(d),a),$(d).css("width","").css("height","");var f=init(this,c);c.columns||(c.columns=f.columns),c.frozenColumns||(c.frozenColumns=f.frozenColumns),c.columns=$.extend(!0,[],c.columns),c.frozenColumns=$.extend(!0,[],c.frozenColumns),c.view=$.extend({},c.view),this.options=c,this.panel=f.panel,this.dc=f.dc,this.ss=null,this.selectedRows=[],this.checkedRows=[],this.data={total:0,rows:[]},this.originalRows=[],this.updatedRows=[],this.insertedRows=[],this.deletedRows=[],this.id=this.options.id}this._render(d)},erajs.ui.Datagrid.prototype={datagrid:function(a){var b=$.extend(this.options,a);this.options=b,this._render()},setSelectionState:function(){setSelectionState(this)},createStyleSheet:function(){return createStyleSheet(this)},getPanel:function(){return this.panel.panel},getPager:function(){return this.pager},getColumnFields:function(a){return getColumnFields(this,a)},getColumnOption:function(a){return getColumnOption(this,a)},resize:function(a){setSize(this,a)},load:function(a){var b=this.options;b.pageNumber=1;var c=this.getPager();c&&c.refresh({pageNumber:1}),request(this,a)},reload:function(a){request(this,a)},reloadFooter:function(a){var b=this.options,c=this.dc;a&&(this.footer=a),b.showFooter&&(b.view.renderFooter.call(b.view,this,c.footer2,!1),b.view.renderFooter.call(b.view,this,c.footer1,!0),b.view.onAfterRender&&b.view.onAfterRender.call(b.view,this),this.fixRowHeight())},getSelected:function(){var a=getSelections(this);return a.length>0?a[0]:null},getSelections:function(){return getSelections(this)},autoSizeColumn:function(a){autoSizeColumn(this,a)},fixRowHeight:function(a){fixRowHeight(this,a)},fixColumnSize:function(a){fixColumnSize(this,a)},fitColumns:function(){fitColumns(this)},scrollTo:function(a){scrollTo(this,a)},freezeRow:function(a){freezeRow(this,a)},highlightRow:function(a){highlightRow(this,a),scrollTo(this,a)},loadData:function(a){loadData(this,a),history(this)},getRows:function(){return this.data.rows},getFooterRows:function(){return this.footer},getRowIndex:function(a){return getRowIndex(this,a)},getChecked:function(){return getChecked(this)},clearChecked:function(){var a=this,b=a.selectedRows,c=a.checkedRows;c.splice(0,c.length),uncheckAll(a),a.options.selectOnCheck&&b.splice(0,b.length)},getData:function(){return this.data},loading:function(){var a=this.options,b=this.getPager();if(b&&b.loading(),a.loadMsg){var c=this.panel.getBody();if(!c.children("div.datagrid-mask").length){$('<div class="datagrid-mask" style="display:block"></div>').appendTo(c);var d=$('<div class="datagrid-mask-msg" style="display:block;left:50%"></div>').html(a.loadMsg).appendTo(c);d._outerHeight(40),d.css({marginLeft:-d.outerWidth()/2,lineHeight:d.height()+"px"})}}},loaded:function(){var a=this.getPager();a&&a.loaded();var b=this.panel.getBody();b.children("div.datagrid-mask-msg").remove(),b.children("div.datagrid-mask").remove()},sort:function(a){sort(this,a)},selectRow:function(a){selectRow(this,a)},selectRecord:function(a){var b=this.options;if(b.idField){var c=getRowIndex(this,a);c>=0&&this.selectRow(c)}},unselectRow:function(a){unselectRow(this,a)},selectAll:function(){selectAll(this)},unselectAll:function(){unselectAll(this)},uncheckAll:function(){uncheckAll(this)},uncheckRow:function(a){uncheckRow(this,a)},checkRow:function(a){checkRow(this,a)},checkAll:function(){checkAll(this)},clearSelections:function(){var a=this,b=a.selectedRows,c=a.checkedRows;b.splice(0,b.length),unselectAll(this),a.options.checkOnSelect&&c.splice(0,c.length)},beginEdit:function(a){beginEdit(this,a)},endEdit:function(a){processEditRow(this,a,!1)},cancelEdit:function(a){processEditRow(this,a,!0)},getEditors:function(a){return getEditors(this,a)},getEditor:function(a){return getEditor(this,a)},refreshRow:function(a){var b=this.options;b.view.refreshRow.call(b.view,this,a)},validateRow:function(a){return validateRow(this,a)},updateRow:function(a){var b=this.options;b.view.updateRow.call(b.view,this,a.index,a.row)},appendRow:function(a){appendRow(this,a)},insertRow:function(a){insertRow(this,a)},deleteRow:function(a){deleteRow(this,a)},getChanges:function(a){return getChanges(this,a)},acceptChanges:function(){acceptChanges(this)},rejectChanges:function(){rejectChanges(this)},mergeCells:function(a){mergeCells(this,a)},showColumn:function(a){var b=this.panel.getPanel();b.find('td[field="'+a+'"]').show(),this.getColumnOption(a).hidden=!1,this.fitColumns()},hideColumn:function(a){var b=this.panel.getPanel();b.find('td[field="'+a+'"]').hide(),this.getColumnOption(a).hidden=!0,this.fitColumns()},destroy:function(a){var b=this;b.panel.destroy(a),erajs.destroy(this)},_render:function(){var a=this.options;if(_58(this),bindEvents(this),setSize(this),a.data)loadData(this,a.data),history(this);else{var b=erajs.ui.Datagrid.parseData(this);b.total>0&&(loadData(this,b),history(this))}if(a.autoLoad)request(this);else{var c=this.getPager();if(c){{c.options}c.refresh({total:0})}}}};var editors={text:{init:function(a,b){var c=radomEditorName(a,b),d=$('<input type="text" id="'+c+'" name="'+c+'" class="datagrid-editable-input">').appendTo(a);return d},destroy:function(a){$(a).remove()},getValue:function(a){return $(a).val()},setValue:function(a,b){$(a).val(b)},resize:function(a,b){$(a)._outerWidth(b)}},checkbox:{init:function(a,b){var c=radomEditorName(a,b),d=$("<input id='"+c+"' name='"+c+'\' type="checkbox">').appendTo(a);return d.val(b.on),d.attr("offval",b.off),d},getValue:function(a){return $(a).is(":checked")?$(a).val():$(a).attr("offval")},setValue:function(a,b){var c=!1;$(a).val()==b&&(c=!0),$(a)._propAttr("checked",c)}},textarea:{init:function(a,b){var c=radomEditorName(a,b),d=$("<textarea id='"+c+"' name='"+c+'\' class="datagrid-editable-input"></textarea>').appendTo(a);return d},getValue:function(a){return $(a).val()},setValue:function(a,b){$(a).val(b)},resize:function(a,b){$(a)._outerWidth(b)}},numberbox:{init:function(a,b){var c=b||{},d=radomEditorName(a,b),e=$("<input id='"+d+"' name='"+d+'\' xtype=\'numberbox\' type="text" class="datagrid-editable-input">').appendTo(a);return erajs.create("numberbox",$.extend({target:e[0]},c))},destroy:function(a){a.destroy()},getValue:function(a){var b=a.target;return $(b).blur(),a.getValue()},setValue:function(a,b){a.setValue(b)},resize:function(a,b){a.resize(b)}},textbox:{init:function(a,b){var c=b||{},d=radomEditorName(a,b),e=$("<input id='"+d+"' name='"+d+"' xtype='textbox' type=\"text\">").appendTo(a);return erajs.create("textbox",$.extend({target:e[0]},c))},destroy:function(a){a.destroy()},getValue:function(a){return a.getValue()},setValue:function(a,b){a.setValue(b)},resize:function(a,b){a.resize(b)}},datebox:{init:function(a,b){var c=b||{},d=radomEditorName(a,b),e=$("<input id='"+d+"' name='"+d+"' xtype='datebox' type=\"text\">").appendTo(a);return erajs.create("datebox",$.extend({target:e[0]},c))},destroy:function(a){a.destroy()},getValue:function(a){return a.getValue()},setValue:function(a,b){a.setValue(b)},resize:function(a,b){a.resize(b)}},combobox:{init:function(a,b){var c=b||{},d=radomEditorName(a,b),e=$("<input id='"+d+"' name='"+d+"' xtype='combobox' type=\"text\">").appendTo(a);return erajs.create("combobox",$.extend({target:e[0]},c))},destroy:function(a){a.destroy()},getValue:function(a){var b=a.options;return b.multiple?a.getValues().join(b.separator):a.getValue()},setValue:function(a,b){var c=a.options;c.multiple?b?a.setValues(b.split(c.separator)):a.clear():a.setValue(b)},resize:function(a,b){a.resize(b)}}},view={render:function(a,b,c){var d=a.options,e=a.data.rows,f=a.getColumnFields(c);if(!c||d.rownumbers||d.frozenColumns&&d.frozenColumns.length){for(var g=['<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>'],h=0;h<e.length;h++){var i=e[h],j=d.rowStyler?d.rowStyler.call(a,h,i):"",k="",l="";"string"==typeof j?l=j:j&&(k=j["class"]||"",l=j.style||"");var m='class="datagrid-row '+(h%2&&d.striped?"datagrid-row-alt ":" ")+k+'"',n=l?'style="'+l+'"':"",o=a.rowIdPrefix+"-"+(c?1:2)+"-"+h;g.push('<tr id="'+o+'" datagrid-row-index="'+h+'" '+m+" "+n+">"),g.push(this.renderRow.call(this,a,f,c,h,i)),g.push("</tr>")}g.push("</tbody></table>"),$(b).html(g.join(""))}},renderFooter:function(a,b,c){for(var d=(a.options,a.footer||[]),e=a.getColumnFields(c),f=['<table class="datagrid-ftable" cellspacing="0" cellpadding="0" border="0"><tbody>'],g=0;g<d.length;g++)f.push('<tr class="datagrid-row" datagrid-row-index="'+g+'">'),f.push(this.renderRow.call(this,a,e,c,g,d[g])),f.push("</tr>");f.push("</tbody></table>"),$(b).html(f.join(""))},renderRow:function(a,b,c,d,e){var f=a.options,g=f.onBeforeRenderRow.call(a,e,d,c);if(g)return g;var h=[];if(c&&f.rownumbers){var i=d+1;f.pagination&&(i+=(f.pageNumber-1)*f.pageSize),h.push('<td class="datagrid-td-rownumber"><div class="datagrid-cell-rownumber">'+i+"</div></td>")}for(var j=0;j<b.length;j++){var k=b[j],l=a.getColumnOption(k);if(l){var m=e[k],n=l.styler?l.styler(m,e,d)||"":"",o="",p="",q=l.tip||!1;"string"==typeof n?p=n:n&&(o=n["class"]||"",p=n.style||"");var r=o?'class="'+o+'"':"",s=q?'tip="'+q+'"':"",t="";if(q){var u=l.gravity||"w";t='gravity="'+u+'"'}var v=l.hidden?'style="display:none;'+p+'"':p?'style="'+p+'"':"";h.push('<td field="'+k+'" '+s+" "+t+" "+r+" "+v+">");var v="";l.checkbox||(l.align&&(v+="text-align:"+l.align+";"),f.nowrap?f.autoRowHeight&&(v+="height:auto;"):v+="white-space:normal;height:auto;"),h.push('<div style="'+v+'" '),h.push(l.checkbox?'class="datagrid-cell-check"':'class="datagrid-cell '+l.cellClass+'"'),h.push(">"),l.checkbox?(h.push('<input type="checkbox" '+(e.checked?'checked="checked"':"")),h.push(' name="'+k+'" value="'+(void 0!=m?m:"")+'">')):h.push(l.formatter?l.formatter(m,e,d):m),h.push("</div>"),h.push("</td>")}}return h.join("")},refreshRow:function(a,b){this.updateRow.call(this,a,b,{})},updateRow:function(a,b,c){function d(c){var d=a.getColumnFields(c),g=e.finder.getTr(a,b,"body",c?1:2),j=g.find("div.datagrid-cell-check input[type=checkbox]").is(":checked");g.html(this.renderRow.call(this,a,d,c,b,f[b])),g.attr("style",i).attr("class",g.hasClass("datagrid-row-selected")?h+" datagrid-row-selected":h),j&&g.find("div.datagrid-cell-check input[type=checkbox]")._propAttr("checked",!0)}var e=a.options,f=a.getRows();$.extend(f[b],c);var g=e.rowStyler?e.rowStyler.call(a,b,f[b]):"",h="",i="";"string"==typeof g?i=g:g&&(h=g["class"]||"",i=g.style||"");var h="datagrid-row "+(b%2&&e.striped?"datagrid-row-alt ":" ")+h;d.call(this,!0),d.call(this,!1),a.fixRowHeight(b)},insertRow:function(a,b,c){function d(c){for(var d=c?1:2,e=h.rows.length-1;e>=b;e--){var g=f.finder.getTr(a,e,"body",d);if(g.attr("datagrid-row-index",e+1),g.attr("id",a.rowIdPrefix+"-"+d+"-"+(e+1)),c&&f.rownumbers){var i=e+2;f.pagination&&(i+=(f.pageNumber-1)*f.pageSize),g.find("div.datagrid-cell-rownumber").html(i)}f.striped&&g.removeClass("datagrid-row-alt").addClass((e+1)%2?"datagrid-row-alt":"")}}function e(c){var d=c?1:2,e=a.rowIdPrefix+"-"+d+"-"+b,i='<tr id="'+e+'" class="datagrid-row" datagrid-row-index="'+b+'"></tr>';if(b>=h.rows.length)if(h.rows.length)f.finder.getTr(a,"","last",d).after(i);else{var j=c?g.body1:g.body2;j.html('<table cellspacing="0" cellpadding="0" border="0"><tbody>'+i+"</tbody></table>")}else f.finder.getTr(a,b+1,"body",d).before(i)}var f=a.options,g=a.dc,h=a.data;(void 0==b||null==b)&&(b=h.rows.length),b>h.rows.length&&(b=h.rows.length),d.call(this,!0),d.call(this,!1),e.call(this,!0),e.call(this,!1),h.total+=1,h.rows.splice(b,0,c),this.refreshRow.call(this,a,b)},deleteRow:function(a,b){function c(c){for(var f=c?1:2,g=b+1;g<e.rows.length;g++){var h=d.finder.getTr(a,g,"body",f);if(h.attr("datagrid-row-index",g-1),h.attr("id",a.rowIdPrefix+"-"+f+"-"+(g-1)),c&&d.rownumbers){var i=g;d.pagination&&(i+=(d.pageNumber-1)*d.pageSize),h.find("div.datagrid-cell-rownumber").html(i)}d.striped&&h.removeClass("datagrid-row-alt").addClass((g-1)%2?"datagrid-row-alt":"")}}var d=a.options,e=a.data;d.finder.getTr(a,b).remove(),c.call(this,!0),c.call(this,!1),e.total-=1,e.rows.splice(b,1)},onBeforeRender:function(){},onAfterRender:function(a){var b=a.options;if(b.showFooter){var c=a.panel.getPanel().find("div.datagrid-footer");c.find("div.datagrid-cell-rownumber,div.datagrid-cell-check").css("visibility","hidden")}}};erajs.ui.Datagrid.defaults=$.extend({},erajs.ui.Panel.defaults,{autoLoad:!0,sharedStyleSheet:!1,frozenColumns:void 0,columns:void 0,fitColumns:!1,fitRowNumbers:!1,resizeHandle:"right",autoRowHeight:!0,toolbar:null,striped:!1,method:"post",nowrap:!0,idField:null,url:null,data:null,showTip:!1,loadMsg:"Processing, please wait ...",rownumbers:!1,singleSelect:!1,ctrlSelect:!1,selectOnCheck:!0,checkOnSelect:!0,pagination:!1,pagePosition:"bottom",pageNumber:1,pageSize:10,pageList:[10,20,30,40,50],queryParams:{},sortName:null,sortOrder:"asc",multiSort:!1,remoteSort:!1,showHeader:!0,showFooter:!1,scrollbarSize:18,rowStyler:function(){},loader:function(a,b,c){var d=this.options;return d.url?void $.ajax({type:d.method,url:d.url,data:a,dataType:"json",success:function(a){b(a)},error:function(){c.apply(this,arguments)}}):!1},loadFilter:function(a){return"number"==typeof a.length&&"function"==typeof a.splice?{total:a.length,rows:a}:a},finder:{getTr:function(a,b,c,d){c=c||"body",d=d||0;var e=a.dc,f=a.options;if(0==d){var g=f.finder.getTr(a,b,c,1),h=f.finder.getTr(a,b,c,2);return g.add(h)}if("body"==c){var i=$("#"+a.rowIdPrefix+"-"+d+"-"+b);return i.length||(i=(1==d?e.body1:e.body2).find(">table>tbody>tr[datagrid-row-index="+b+"]")),i}return"footer"==c?(1==d?e.footer1:e.footer2).find(">table>tbody>tr[datagrid-row-index="+b+"]"):"selected"==c?(1==d?e.body1:e.body2).find(">table>tbody>tr.datagrid-row-selected"):"highlight"==c?(1==d?e.body1:e.body2).find(">table>tbody>tr.datagrid-row-over"):"checked"==c?(1==d?e.body1:e.body2).find(">table>tbody>tr.datagrid-row-checked"):"last"==c?(1==d?e.body1:e.body2).find(">table>tbody>tr[datagrid-row-index]:last"):"allbody"==c?(1==d?e.body1:e.body2).find(">table>tbody>tr[datagrid-row-index]"):"allfooter"==c?(1==d?e.footer1:e.footer2).find(">table>tbody>tr[datagrid-row-index]"):void 0},getRow:function(a,b){var b="object"==typeof b?b.attr("datagrid-row-index"):b;return a.data.rows[parseInt(b)]},getRows:function(a){return a.getRows()}},editors:editors,view:view,onBeforeRenderRow:function(){},onBeforeLoad:function(){},onLoadSuccess:function(){},onLoadError:function(){},onClickRow:function(){},onDblClickRow:function(){},onClickCell:function(){},onDblClickCell:function(){},onBeforeSortColumn:function(){},onSortColumn:function(){},onResizeColumn:function(){},onSelect:function(){},onUnselect:function(){},onSelectAll:function(){},onUnselectAll:function(){},onCheck:function(){},onUncheck:function(){},onCheckAll:function(){},onUncheckAll:function(){},onBeforeEdit:function(){},onBeginEdit:function(){},onEndEdit:function(){},onAfterEdit:function(){},onCancelEdit:function(){},onHeaderContextMenu:function(){},onRowContextMenu:function(){}}),erajs.ui.Datagrid.parseData=function(a){var b=$(a.target),c={total:0,rows:[]},d=getColumnFields(a,!0).concat(getColumnFields(a,!1));return b.find("tbody tr").each(function(){c.total++;var a={},b=$(this);$.extend(a,erajs.ui.parser.parseOptions(b,["iconCls","state"]));for(var e=0;e<d.length;e++)a[d[e]]=b.find("td:eq("+e+")").html();c.rows.push(a)}),c},erajs.ui.Datagrid.parseOptions=function(target){var t=$(target);return $.extend({},erajs.ui.Panel.parseOptions(target),erajs.ui.parser.parseOptions(t,["url","toolbar","idField","sortName","sortOrder","pagePosition","resizeHandle",{sharedStyleSheet:"boolean",fitColumns:"boolean",autoRowHeight:"boolean",striped:"boolean",nowrap:"boolean"},{rownumbers:"boolean",singleSelect:"boolean",ctrlSelect:"boolean",checkOnSelect:"boolean",selectOnCheck:"boolean"},{pagination:"boolean",pageSize:"number",pageNumber:"number"},{multiSort:"boolean",remoteSort:"boolean",showHeader:"boolean",showFooter:"boolean"},{scrollbarSize:"number"}]),{pageList:t.attr("pageList")?eval(t.attr("pageList")):void 0,loadMsg:void 0!=t.attr("loadMsg")?t.attr("loadMsg"):void 0,rowStyler:t.attr("rowStyler")?eval(t.attr("rowStyler")):void 0})}}(),function(){function a(a){var b=$(a);return b.addClass("tree"),b}function b(a){var b=a.options,d=a.target;$(d).unbind().bind("mouseover",function(a){var b=$(a.target),c=b.closest("div.tree-node");c.length&&(c.addClass("tree-node-hover"),b.hasClass("tree-hit")&&b.addClass(b.hasClass("tree-expanded")?"tree-expanded-hover":"tree-collapsed-hover"),a.stopPropagation())}).bind("mouseout",function(a){var b=$(a.target),c=b.closest("div.tree-node");c.length&&(c.removeClass("tree-node-hover"),b.hasClass("tree-hit")&&b.removeClass(b.hasClass("tree-expanded")?"tree-expanded-hover":"tree-collapsed-hover"),a.stopPropagation())}).bind("click",function(d){var e=$(d.target),f=e.closest("div.tree-node");if(f.length){if(e.hasClass("tree-hit"))return c(a,f[0]),!1;if(e.hasClass("tree-checkbox"))return v(a,f[0],!e.hasClass("tree-checkbox1")),!1;n(a,f[0]),b.onClick.call(a,y(a,f[0])),d.stopPropagation()}}).bind("dblclick",function(c){var d=$(c.target).closest("div.tree-node");d.length&&(n(a,d[0]),b.onDblClick.call(a,y(a,d[0])),c.stopPropagation())}).bind("contextmenu",function(c){var d=$(c.target).closest("div.tree-node");d.length&&(b.onContextMenu.call(a,c,y(a,d[0])),c.stopPropagation())})}function c(a,b){var c=$(b).children("span.tree-hit");0!=c.length&&(c.hasClass("tree-expanded")?d(a,b):e(a,b))}function d(a,b){var c=a.options,d=$(b).children("span.tree-hit");if(0!=d.length&&!d.hasClass("tree-collapsed")){var e=y(a,b);if(0!=c.onBeforeCollapse.call(a,e)){d.removeClass("tree-expanded tree-expanded-hover").addClass("tree-collapsed"),d.next().removeClass("tree-folder-open");var f=$(b).next();c.animate?f.slideUp("normal",function(){e.state="closed",c.onCollapse.call(a,e)}):(f.css("display","none"),e.state="closed",c.onCollapse.call(a,e))}}}function e(a,b,c){var d=a.options,e=$(b).children("span.tree-hit");if(0!=e.length&&!e.hasClass("tree-expanded")){var f=y(a,b);if(0!=d.onBeforeExpand.call(a,f)){e.removeClass("tree-collapsed tree-collapsed-hover").addClass("tree-expanded"),e.next().addClass("tree-folder-open");var g=$(b).next();if(g.length)d.animate?g.slideDown("normal",function(){f.state="open",d.onExpand.call(a,f),c&&c()}):(g.css("display","block"),f.state="open",d.onExpand.call(a,f),c&&c());else{var h=$('<ul style="display:none"></ul>').insertAfter(b);H(a,h[0],{id:f.id},function(){h.is(":empty")&&h.remove(),d.animate?h.slideDown("normal",function(){f.state="open",d.onExpand.call(a,f),c&&c()}):(h.css("display","block"),f.state="open",d.onExpand.call(a,f),c&&c())})}}}}function f(a,b){for(var c=[],d=x(a,b);d;)c.unshift(d),d=x(a,d.target);for(var f=0;f<c.length;f++)e(a,c[f].target)}function g(a,b){for(var c=a.target,d=$(c).parent();"BODY"!=d[0].tagName&&"auto"!=d.css("overflow-y");)d=d.parent();var e=$(b),f=e.offset().top;if("BODY"!=d[0].tagName){var g=d.offset().top;g>f?d.scrollTop(d.scrollTop()+f-g):f+e.outerHeight()>g+d.outerHeight()-18&&d.scrollTop(d.scrollTop()+f+e.outerHeight()-g-d.outerHeight()+18)}else d.scrollTop(f)}function c(a,b){var c=$(b).children("span.tree-hit");0!=c.length&&(c.hasClass("tree-expanded")?d(a,b):e(a,b))}function h(a,b){var c=$(b.parent),d=b.data;if(d&&(d=$.isArray(d)?d:[d],d.length)){var e;if(0==c.length)e=$(a.target);else{if(B(a,c[0])){var f=c.find("span.tree-icon");f.removeClass("tree-file").addClass("tree-folder tree-folder-open");var g=$('<span class="tree-hit tree-expanded"></span>').insertBefore(f);g.prev().length&&g.prev().remove()}e=c.next(),e.length||(e=$("<ul></ul>").insertAfter(c))}o(a,e[0],d,!0),i(a,e.prev())}}function i(a,b){var c=a.options;if(c.checkbox){var d=$(b);if(B(a,b)){var e=d.find(".tree-checkbox");e.length?e.hasClass("tree-checkbox1")?v(a,b,!0):v(a,b,!1):c.onlyLeafCheck&&$('<span class="tree-checkbox tree-checkbox0"></span>').insertBefore(d.find(".tree-title"))}else{var e=d.find(".tree-checkbox");if(c.onlyLeafCheck)e.remove();else if(e.hasClass("tree-checkbox1"))v(a,b,!0);else if(e.hasClass("tree-checkbox2")){for(var f=!0,g=!0,h=w(a,b),i=0;i<h.length;i++)h[i].checked?g=!1:f=!1;f&&v(a,b,!0),g&&v(a,b,!1)}}}}function j(a,b){var c=b.before||b.after,d=(a.target,x(a,c)),e=b.data;if(e&&(e=$.isArray(e)?e:[e],e.length)){h(a,{parent:d?d.target:null,data:e});for(var f=d?d.children:a.getRoots(),g=0;g<f.length;g++)if(f[g].domId==$(c).attr("id")){for(var i=e.length-1;i>=0;i--)f.splice(b.before?g:g+1,0,e[i]);f.splice(f.length-e.length,e.length);break}for(var j=$(),g=0;g<e.length;g++)j=j.add($("#"+e[g].domId).parent());b.before?j.insertBefore($(c).parent()):j.insertAfter($(c).parent())}}function k(a,b){function c(b){for(var c=$(b).attr("id"),d=x(a,b),e=d?d.children:a.data,f=0;f<e.length;f++)if(e[f].domId==c){e.splice(f,1);break}return d}var d=c(b);if($(b).parent().remove(),d){if(!d.children||!d.children.length){var e=$(d.target);e.find(".tree-icon").removeClass("tree-folder").addClass("tree-file"),e.find(".tree-hit").remove(),$('<span class="tree-indent"></span>').prependTo(e),e.next().remove()}u(a,d),i(a,d.target)}E(a,a.target)}function l(a,b){var c=w(a,b);b&&c.unshift(y(a,b));for(var e=0;e<c.length;e++)d(a,c[e].target)}function m(a,b){var c=w(a,b);b&&c.unshift(y(a,b));for(var d=0;d<c.length;d++)e(a,c[d].target)}function n(a,b){var c=a.options,d=a.target,e=y(a,b);0!=c.onBeforeSelect.call(a,e)&&($(d).find("div.tree-node-selected").removeClass("tree-node-selected"),$(b).addClass("tree-node-selected"),c.onSelect.call(a,e))}function o(a,b,c,d){var e=a.options,f=$(b).prevAll("div.tree-node:first");c=e.loadFilter.call(a,c,f[0]);var g=D(a,"domId",f.attr("id"));d?g?g.children=g.children?g.children.concat(c):c:a.data=a.data.concat(c):(g?g.children=c:a.data=c,$(b).empty()),e.view.render.call(e.view,a,b,c),e.dnd&&p(a),g&&u(a,g);for(var h=[],i=[],j=0;j<c.length;j++){var k=c[j];k.checked||h.push(k)}G(c,function(a){a.checked&&i.push(a)});var l=e.onCheck;e.onCheck=function(){},h.length&&v(a,$("#"+h[0].domId)[0],!1);for(var j=0;j<i.length;j++)v(a,$("#"+i[j].domId)[0],!0);e.onCheck=l,setTimeout(function(){E(a,a.target)},0),e.onLoadSuccess.call(a,g,c)}function p(a){function b(a,b){var c=a.target;return b?a.pop(c):a.getData(c)}function c(a,b){var c=a.target,d=$(c).draggable("proxy").find("span.tree-dnd-icon");d.removeClass("tree-dnd-yes tree-dnd-no").addClass(b?"tree-dnd-yes":"tree-dnd-no")}function d(a,c){function d(){var d=b(a,!0);a.append({parent:c,data:[d]}),g.onDrop.call(a,c,d,"append")}"closed"==y(a,c).state?e(a,c,function(){d()}):d()}function f(a,c,d){var e={};"top"==d?e.before=c:e.after=c;var f=b(a,!0);e.data=f,a.insert(e),g.onDrop.call(a,c,f,d)}var g=a.options,h=a.tree;a.disabledNodes=[],g.dnd=!0,h.find("div.tree-node").draggable({disabled:!1,revert:!0,cursor:"pointer",proxy:function(a){var b=$('<div class="tree-node-proxy"></div>').appendTo("body");return b.html('<span class="tree-dnd-icon tree-dnd-no">&nbsp;</span>'+$(a).find(".tree-title").html()),b.hide(),b},deltaX:15,deltaY:15,onBeforeDrag:function(b){if(0==g.onBeforeDrag.call(a,y(a,this)))return!1;if($(b.target).hasClass("tree-hit")||$(b.target).hasClass("tree-checkbox"))return!1;if(1!=b.which)return!1;$(this).next("ul").find("div.tree-node").droppable({accept:"no-accept"});var c=$(this).find("span.tree-indent");c.length&&(b.data.offsetWidth-=c.length*c.width())},onStartDrag:function(){$(this).draggable("proxy").css({left:-1e4,top:-1e4}),g.onStartDrag.call(a,y(a,this));var b=y(a,this);void 0==b.id&&(b.id="erajs_tree_node_id_temp",u(a,b)),a.draggingNodeId=b.id},onDrag:function(a){var b=a.pageX,c=a.pageY,d=a.data.startX,e=a.data.startY,f=Math.sqrt((b-d)*(b-d)+(c-e)*(c-e));f>3&&$(this).draggable("proxy").show(),this.pageY=a.pageY},onStopDrag:function(){$(this).next("ul").find("div.tree-node").droppable({accept:"div.tree-node"});for(var b=0;b<a.disabledNodes.length;b++)$(a.disabledNodes[b]).droppable("enable");a.disabledNodes=[];var c=C(a,a.draggingNodeId);c&&"erajs_tree_node_id_temp"==c.id&&(c.id="",u(a,c)),g.onStopDrag.call(a,c)}}).droppable({accept:"div.tree-node",onDragEnter:function(){0==g.onDragEnter.call(a,this,b(a))&&(c(a,!1),$(this).removeClass("tree-node-append tree-node-top tree-node-bottom"),$(this).droppable("disable"),a.disabledNodes.push(this))},onDragOver:function(d,e){if(!$(this).droppable("options").disabled){var f=e.pageY,h=$(this).offset().top,i=h+$(this).outerHeight();c(a,!0),$(this).removeClass("tree-node-append tree-node-top tree-node-bottom"),$(this).addClass(f>h+(i-h)/2?5>i-f?"tree-node-bottom":"tree-node-append":5>f-h?"tree-node-top":"tree-node-append"),0==g.onDragOver.call(a,this,b(a))&&(c(a,!1),$(this).removeClass("tree-node-append tree-node-top tree-node-bottom"),$(this).droppable("disable"),a.disabledNodes.push(this))}},onDragLeave:function(){c(a,!1),$(this).removeClass("tree-node-append tree-node-top tree-node-bottom"),g.onDragLeave.call(a,this,b(a))},onDrop:function(){var c,e,h=this;return $(this).hasClass("tree-node-append")?(c=d,e="append"):(c=f,e=$(this).hasClass("tree-node-top")?"top":"bottom"),0==g.onBeforeDrop.call(a,h,b(a),e)?void $(this).removeClass("tree-node-append tree-node-top tree-node-bottom"):(c(a,h,e),void $(this).removeClass("tree-node-append tree-node-top tree-node-bottom"))}})}function q(a){var b=a.options,c=a.target;b.dnd=!1;var d=$(c).find("div.tree-node");d.draggable("disable"),d.css("cursor","pointer")}function r(a,b){var c=a.options,d=y(a,b);if(0!=c.onBeforeEdit.call(a,d)){$(b).css("position","relative");var e=$(b).find(".tree-title"),f=e.outerWidth();e.empty();var g=$('<input class="tree-editor">').appendTo(e);g.val(d.text).focus(),g.width(f+20),g.height("CSS1Compat"==document.compatMode?18-(g.outerHeight()-g.height()):18),g.bind("click",function(){return!1}).bind("mousedown",function(a){a.stopPropagation()}).bind("mousemove",function(a){a.stopPropagation()}).bind("keydown",function(c){return 13==c.keyCode?(s(a,b),!1):27==c.keyCode?(t(a,b),!1):void 0}).bind("blur",function(c){c.stopPropagation(),s(a,b)})}}function s(a,b){var c=a.options;$(b).css("position","");var d=$(b).find("input.tree-editor"),e=d.val();d.remove();var f=y(a,b);f.text=e,u(a,f),c.onAfterEdit.call(a,f)}function t(a,b){var c=a.options;$(b).css("position",""),$(b).find("input.tree-editor").remove();var d=y(a,b);u(a,d),c.onCancelEdit.call(a,d)}function u(a,b){var c=a.options,d=$(b.target),e=y(a,b.target),f=e.checked;e.iconCls&&d.find(".tree-icon").removeClass(e.iconCls),$.extend(e,b),d.find(".tree-title").html(c.formatter.call(a,e)),e.iconCls&&d.find(".tree-icon").addClass(e.iconCls),f!=e.checked&&v(a,b.target,e.checked)}function v(a,b,c){function d(a){var b=a.next().find(".tree-checkbox");b.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2"),b.addClass(a.find(".tree-checkbox").hasClass("tree-checkbox1")?"tree-checkbox1":"tree-checkbox0")}function e(b){function c(a){var b=a.find(".tree-checkbox");if(b.hasClass("tree-checkbox0")||b.hasClass("tree-checkbox2"))return!1;var c=!0;return a.parent().siblings().each(function(){$(this).children("div.tree-node").children(".tree-checkbox").hasClass("tree-checkbox1")||(c=!1)}),c}function d(a){var b=a.find(".tree-checkbox");if(b.hasClass("tree-checkbox1")||b.hasClass("tree-checkbox2"))return!1;var c=!0;return a.parent().siblings().each(function(){$(this).children("div.tree-node").children(".tree-checkbox").hasClass("tree-checkbox0")||(c=!1)}),c}var f=x(a,b[0]);if(f){var g=$(f.target).find(".tree-checkbox");g.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2"),g.addClass(c(b)?"tree-checkbox1":d(b)?"tree-checkbox0":"tree-checkbox2"),e($(f.target))}}var f=a.options;
if(f.checkbox){var g=y(a,b);if(0!=f.onBeforeCheck.call(a,g,c)){var h=$(b),i=h.find(".tree-checkbox");i.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2"),i.addClass(c?"tree-checkbox1":"tree-checkbox0"),f.cascadeCheck&&(e(h),d(h)),f.onCheck.call(a,g,c)}}}function w(a,b){var c=[],d=y(a,b),e=d?d.children:a.data;return G(e,function(a){c.push(F(a))}),c}function x(a,b){var c=$(b).closest("ul").prevAll("div.tree-node:first");return y(a,c[0])}function y(a,b){return D(a,"domId",$(b).attr("id"))}function z(a,b){b=b||"checked";var c=a.target;$.isArray(b)||(b=[b]);for(var d=[],e=0;e<b.length;e++){var f=b[e];"checked"==f?d.push("span.tree-checkbox1"):"unchecked"==f?d.push("span.tree-checkbox0"):"indeterminate"==f&&d.push("span.tree-checkbox2")}var g=[];return $(c).find(d.join(",")).each(function(){var b=$(this).parent();g.push(y(a,b[0]))}),g}function A(a){var b=a.target,c=$(b).find("div.tree-node-selected");return c.length?y(a,c[0]):null}function B(a,b){return 0==$(b).children("span.tree-hit").length}function C(a,b){return D(a,"id",b)}function D(a,b,c){var d=a.data,e=null;return G(d,function(a){return a[b]==c?(e=F(a),!1):void 0}),e}function E(a,b,c){function d(a){var b=a.find("span.tree-icon");b.prev("span.tree-indent").addClass("tree-join")}function e(a){var b=a.find("span.tree-indent, span.tree-hit").length;a.next().find("div.tree-node").each(function(){$(this).children("span:eq("+(b-1)+")").addClass("tree-line")})}var f=a.options,g=a.target;if(!f.lines)return void $(g).removeClass("tree-lines");if($(g).addClass("tree-lines"),!c){c=!0,$(g).find("span.tree-indent").removeClass("tree-line tree-join tree-joinbottom"),$(g).find("div.tree-node").removeClass("tree-node-last tree-root-first tree-root-one");var h=a.getRoots();h.length>1?$(h[0].target).addClass("tree-root-first"):1==h.length&&$(h[0].target).addClass("tree-root-one")}$(b).children("li").each(function(){var b=$(this).children("div.tree-node"),f=b.next("ul");f.length?($(this).next().length&&e(b),E(a,f,c)):d(b)});var i=$(b).children("li:last").children("div.tree-node").addClass("tree-node-last");i.children("span.tree-join").removeClass("tree-join").addClass("tree-joinbottom")}function F(a){var b=$("#"+a.domId);return a.target=b[0],a.checked=b.find(".tree-checkbox").hasClass("tree-checkbox1"),a}function G(a,b){var c=[];if(a){for(var d=0;d<a.length;d++)c.push(a[d]);for(;c.length;){var e=c.shift();if(0==b(e))return;if(e.children)for(var d=e.children.length-1;d>=0;d--)c.unshift(e.children[d])}}}function H(a,b,c,d){var e=a.options,f=a.target;c=$.extend({},e.queryParams,c||{});var g=null;if(f!=b){var h=$(b).prev();g=y(a,h[0])}if(0!=e.onBeforeLoad.call(a,g,c)){var i=$(b).prev().children("span.tree-folder");i.addClass("tree-loading");var j=e.loader.call(a,c,function(c){i.removeClass("tree-loading"),o(a,b,c),d&&d()},function(){i.removeClass("tree-loading"),e.onLoadError.apply(a,arguments),d&&d()});0==j&&i.removeClass("tree-loading")}}function I(a,b){var c=y(a,b);return c&&c.children&&G(c.children,function(a){F(a)}),c}function J(a,b){if(b){for(var c=x(a,b);c;)b=c.target,c=x(a,b);return y(a,b)}var d=K(a);return d.length?d[0]:null}function K(a){for(var b=a.data,c=0;c<b.length;c++)F(b[c]);return b}erajs.ui.Tree=function(b){b=b||{};var c=b.target;if(!c){var d=b.contentEl;d&&(c=$(d)[0])}if(c){this.target=c,this.options=$.extend({},erajs.ui.Tree.defaults,erajs.ui.Tree.parseOptions(c),b),this.data=[],this.tree=a(c),this.id=this.options.id;var e=erajs.ui.Tree.parseData(this);e.length&&o(this,c,e)}this._render(c)},erajs.ui.Tree.prototype={updateTree:function(a){var b=this,c=$.extend(b.options,a);b.options=c,b._render()},loadData:function(a){var b=this,c=b.target;o(b,c,a)},getNode:function(a){return y(this,a)},getData:function(a){return I(this,a)},reload:function(a){var b=this,c=b.target;if(a){var d=$(a),f=d.children("span.tree-hit");f.removeClass("tree-expanded tree-expanded-hover").addClass("tree-collapsed"),d.next().remove(),e(b,a)}else $(c).empty(),H(b,c)},getRoot:function(a){return J(this,a)},getRoots:function(){return K(this)},getParent:function(a){return x(this,a)},getChildren:function(a){return w(this,a)},getChecked:function(a){return z(this,a)},getSelected:function(){return A(this)},isLeaf:function(a){return B(this,a)},find:function(a){return C(this,a)},select:function(a){n(this,a)},check:function(a){v(this,a,!0)},uncheck:function(a){v(this,a,!1)},collapse:function(a){d(this,a)},expand:function(a){e(this,a)},collapseAll:function(a){l(this,a)},expandAll:function(a){m(this,a)},expandTo:function(a){f(this,a)},scrollTo:function(a){g(this,a)},toggle:function(a){c(this,a)},append:function(a){h(this,a)},insert:function(a){j(this,a)},remove:function(a){k(this,a)},pop:function(a){var b=this.getData(a);return this.remove(a),b},update:function(a){u(this,a)},enableDnd:function(){p(this)},disableDnd:function(){q(this)},beginEdit:function(a){r(this,a)},endEdit:function(a){s(this,a)},cancelEdit:function(a){t(this,a)},destroy:function(){this.tree.remove(),erajs.destroy(this)},_render:function(a){var c=this,d=c.options,a=a||c.target;b(c),d.data&&o(c,a,$.extend(!0,[],d.data)),H(c,a)}},erajs.ui.Tree.parseData=function(a){function b(a,c){c.children("li").each(function(){var c=$(this),d=$.extend({},erajs.ui.parser.parseOptions(c,["id","iconCls","state"]),{checked:c.attr("checked")?!0:void 0});d.text=c.children("span").html(),d.text||(d.text=c.html());var e=c.children("ul");e.length&&(d.children=[],b(d.children,e)),a.push(d)})}var c=[],d=a.target;return b(c,$(d)),c};var L=1,M={render:function(a,b,c){function d(b,c){for(var f=[],g=0;g<c.length;g++){var h=c[g];"open"!=h.state&&"closed"!=h.state&&(h.state="open"),h.domId="_erajs_tree_"+L++,f.push("<li>"),f.push('<div id="'+h.domId+'" class="tree-node">');for(var i=0;b>i;i++)f.push('<span class="tree-indent"></span>');var j=!1;if("closed"==h.state?(f.push('<span class="tree-hit tree-collapsed"></span>'),f.push('<span class="tree-icon tree-folder '+(h.iconCls?h.iconCls:"")+'"></span>')):h.children&&h.children.length?(f.push('<span class="tree-hit tree-expanded"></span>'),f.push('<span class="tree-icon tree-folder tree-folder-open '+(h.iconCls?h.iconCls:"")+'"></span>')):(f.push('<span class="tree-indent"></span>'),f.push('<span class="tree-icon tree-file '+(h.iconCls?h.iconCls:"")+'"></span>'),j=!0),e.checkbox&&(!e.onlyLeafCheck||j)&&f.push('<span class="tree-checkbox tree-checkbox0"></span>'),f.push('<span class="tree-title">'+e.formatter.call(a,h)+"</span>"),f.push("</div>"),h.children&&h.children.length){var k=d(b+1,h.children);f.push('<ul style="display:'+("closed"==h.state?"none":"block")+'">'),f=f.concat(k),f.push("</ul>")}f.push("</li>")}return f}var e=a.options,f=$(b).prev("div.tree-node").find("span.tree-indent, span.tree-hit").length,g=d(f,c);$(b).append(g.join(""))}};erajs.ui.Tree.defaults={id:null,url:null,method:"post",showIcon:!0,animate:!1,checkbox:!1,cascadeCheck:!0,onlyLeafCheck:!1,lines:!1,dnd:!1,data:null,queryParams:{},formatter:function(a){return a.text},loader:function(a,b,c){var d=this,e=d.options;return e.url?void $.ajax({type:e.method,url:e.url,data:a,dataType:"json",success:function(a){b(a)},error:function(){c.apply(this,arguments)}}):!1},loadFilter:function(a){return a},view:M,onBeforeLoad:function(){},onLoadSuccess:function(){},onLoadError:function(){},onClick:function(){},onDblClick:function(){},onBeforeExpand:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeCheck:function(){},onCheck:function(){},onBeforeSelect:function(){},onSelect:function(){},onContextMenu:function(){},onBeforeDrag:function(){},onStartDrag:function(){},onStopDrag:function(){},onDragEnter:function(){},onDragOver:function(){},onDragLeave:function(){},onBeforeDrop:function(){},onDrop:function(){},onBeforeEdit:function(){},onAfterEdit:function(){},onCancelEdit:function(){}},erajs.ui.Tree.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.parser.parseOptions(b,["id","url","method",{checkbox:"boolean",showIcon:"boolean",cascadeCheck:"boolean",onlyLeafCheck:"boolean"},{animate:"boolean",lines:"boolean",dnd:"boolean"}]))}}(),function(){function a(a){var c=a.options,e=a.target,f=$.extend({},c,{target:e,url:null,data:null,loader:function(){return!1},onBeforeLoad:function(){return!1},finder:{getTr:function(b,c,d,e){d=d||"body",e=e||0;var f=a.dc,g=a.datagrid;if(0==e){var h=a.options,i=h.finder.getTr(a,c,d,1),j=h.finder.getTr(a,c,d,2);return i.add(j)}if("body"==d){var k=$("#"+g.rowIdPrefix+"-"+e+"-"+c);return k.length||(k=(1==e?f.body1:f.body2).find('tr[node-id="'+c+'"]')),k}return"footer"==d?(1==e?f.footer1:f.footer2).find('tr[node-id="'+c+'"]'):"selected"==d?(1==e?f.body1:f.body2).find("tr.datagrid-row-selected"):"highlight"==d?(1==e?f.body1:f.body2).find("tr.datagrid-row-over"):"checked"==d?(1==e?f.body1:f.body2).find("tr.datagrid-row-checked"):"last"==d?(1==e?f.body1:f.body2).find("tr:last[node-id]"):"allbody"==d?(1==e?f.body1:f.body2).find("tr[node-id]"):"allfooter"==d?(1==e?f.footer1:f.footer2).find("tr[node-id]"):void 0},getRow:function(b,c){var d="object"==typeof c?c.attr("node-id"):c;return k(a,d)},getRows:function(){return i(a)}},onLoadSuccess:function(){},onResizeColumn:function(b,d){g(a),c.onResizeColumn.call(a,b,d)},onSortColumn:function(e,f){if(c.sortName=e,c.sortOrder=f,c.remoteSort)b(a);else{var g=a.getData();d(a,0,g)}c.onSortColumn.call(a,e,f)},onBeforeEdit:function(b,d){return 0==c.onBeforeEdit.call(a,d)?!1:void 0},onAfterEdit:function(b,d,e){c.onAfterEdit.call(a,d,e)},onCancelEdit:function(b,d){c.onCancelEdit.call(a,d)},onUnselect:function(b,d){c.onUnselect.call(a,d)},onCheck:function(b,d){c.onCheck.call(a,d)},onUncheck:function(b,d){c.onUncheck.call(a,d)},onClickRow:function(b,d){c.onClickRow.call(a,d)},onDblClickRow:function(b,d){c.onDblClickRow.call(a,d)},onClickCell:function(b,d){c.onClickCell.call(a,d,k(a,b))},onDblClickCell:function(b,d){c.onDblClickCell.call(a,d,k(a,b))},onRowContextMenu:function(b,d,e){c.onContextMenu.call(a,b,e)}}),h=a.datagrid;if(h?h.datagrid(f):h=new erajs.ui.Datagrid(f),a.datagrid=h,!c.columns){var j=h.options;c.columns=j.columns,c.frozenColumns=j.frozenColumns}if(a.dc=h.dc,c.pagination){var l=h.getPager();l&&(l.pagination({pageNumber:c.pageNumber,pageSize:c.pageSize,pageList:c.pageList,onSelectPage:function(d,e){c.pageNumber=d,c.pageSize=e,b(a)}}),c.pageSize=l.options.pageSize)}}function b(a,b,c,e,f){var g=a.options,h=a.datagrid,i=h.getPanel(),j=i.find("div.datagrid-body");c&&(g.queryParams=c);var l=$.extend({},g.queryParams);g.pagination&&$.extend(l,{page:g.pageNumber,rows:g.pageSize}),g.sortName&&$.extend(l,{sort:g.sortName,order:g.sortOrder});var m=k(a,b);if(0!=g.onBeforeLoad.call(a,m,l)){var n=j.find('tr[node-id="'+b+'"] span.tree-folder');n.addClass("tree-loading"),h.loading();var o=g.loader.call(a,l,function(c){n.removeClass("tree-loading"),h.loaded(),d(a,b,c,e),f&&f()},function(){n.removeClass("tree-loading"),h.loaded(),g.onLoadError.apply(a,arguments),f&&f()});0==o&&(n.removeClass("tree-loading"),h.loaded())}}function c(a){var b=a.dc,c=b.body1.add(b.body2),d=($.data(c[0],"events")||$._data(c[0],"events")).click[0].handler;b.body1.add(b.body2).bind("mouseover",function(a){var b=$(a.target),c=b.closest("tr.datagrid-row");c.length&&b.hasClass("tree-hit")&&b.addClass(b.hasClass("tree-expanded")?"tree-expanded-hover":"tree-collapsed-hover")}).bind("mouseout",function(a){var b=$(a.target),c=b.closest("tr.datagrid-row");c.length&&b.hasClass("tree-hit")&&b.removeClass(b.hasClass("tree-expanded")?"tree-expanded-hover":"tree-collapsed-hover")}).unbind("click").bind("click",function(b){var c=$(b.target),e=c.closest("tr.datagrid-row");e.length&&(c.hasClass("tree-hit")?n(a,e.attr("node-id")):d(b))})}function d(a,b,c,d){var h=a.options,i=a.dc,j=a.datagrid;c=h.loadFilter.call(a,c,b);var l,m,n=k(a,b);if(n){var o=h.finder.getTr(a,b,"body",1),p=h.finder.getTr(a,b,"body",2);l=o.next("tr.treegrid-tr-tree").children("td").children("div"),m=p.next("tr.treegrid-tr-tree").children("td").children("div"),d||(n.children=[])}else l=i.body1,m=i.body2,d||(a.data=[]);if(d||(l.empty(),m.empty()),h.view.onBeforeRender&&h.view.onBeforeRender.call(h.view,a,b,c),h.view.render.call(h.view,a,l,!0),h.view.render.call(h.view,a,m,!1),h.showFooter&&(h.view.renderFooter.call(h.view,a,i.footer1,!0),h.view.renderFooter.call(h.view,a,i.footer2,!1)),h.view.onAfterRender&&h.view.onAfterRender.call(h.view,j),!b&&h.pagination){var q=a.total,r=j.getPager();r.options.total!=q&&r.pagination({total:q})}g(a),f(a),a.showLines(),j.setSelectionState(),j.autoSizeColumn(),h.onLoadSuccess.call(a,n,c),e(a)}function e(a){var b=a.options,c=b.treeField,d=b.showTip;if(d)for(var e=a.dc,f=e.body2.find("td[tip='true']"),g=0;g<f.length;g++){var h=f[g],i=$(h),j=i.attr("field"),k="";if(k=j==c?i.find("div.datagrid-cell > span:last").text():i.find("div.datagrid-cell").text()){var l=i.attr("gravity");i.tipsy({gravity:l,fallback:k})}}}function f(a){var b=a.dc,c=a.options;c.rownumbers&&b.body1.find("div.datagrid-cell-rownumber").each(function(a){$(this).html(a+1)})}function g(a,b){function c(b){var c=d.finder.getTr(a,b,"body",1),e=d.finder.getTr(a,b,"body",2);c.css("height",""),e.css("height","");var f=Math.max(c.height(),e.height());c.css("height",f),e.css("height",f)}var d=a.options,e=a.dc,f=a.datagrid;if(!e.body1.is(":empty")&&(!d.nowrap||d.autoRowHeight)&&void 0!=b)for(var g=i(a,b),h=0;h<g.length;h++)c(g[h][d.idField]);f.fixRowHeight(b)}function h(a){function b(a){$.map(a,function(a){if(a.children&&a.children.length)b(a.children);else{var c=d(a);c.find(e.showIcon?".tree-icon":".tree-title").prev().addClass("tree-join")}});var c=d(a[a.length-1]);c.addClass("tree-node-last"),c.find(".tree-join").removeClass("tree-join").addClass("tree-joinbottom")}function c(b){$.map(b,function(a){a.children&&a.children.length&&c(a.children)});for(var d=0;d<b.length-1;d++){var f=b[d],g=m(a,f[e.idField]),h=e.finder.getTr(a,f[e.idField]),i=h.next().find('tr.datagrid-row td[field="'+e.treeField+'"] div.datagrid-cell');i.find("span:eq("+(g-1)+")").addClass("tree-line")}}function d(b){var c=e.finder.getTr(a,b[e.idField]),d=c.find('td[field="'+e.treeField+'"] div.datagrid-cell');return d}var e=a.options,f=(a.dc,$(a.target),a.datagrid),g=f.panel.getBody();if(!e.lines)return void g.removeClass("tree-lines");g.addClass("tree-lines"),g.find("span.tree-indent").removeClass("tree-line tree-join tree-joinbottom"),g.find("div.datagrid-cell").removeClass("tree-node-last tree-root-first tree-root-one");var h=j(a);h.length>1?d(h[0]).addClass("tree-root-first"):1==h.length&&d(h[0]).addClass("tree-root-one"),b(h),c(h)}function i(a,b){function c(b){var f=k(a,b);if(f&&f.children)for(var g=0,h=f.children.length;h>g;g++){var i=f.children[g];e.push(i),c(i[d.idField])}}var d=a.options,e=(a.datagrid,[]);if(b)c(b);else for(var f=j(a),g=0;g<f.length;g++)e.push(f[g]),c(f[g][d.idField]);return e}function j(a){return a.data}function k(a,b){for(var c=a.options,d=a.data,e=[d];e.length;)for(var f=e.shift(),g=0;g<f.length;g++){var h=f[g];if(h[c.idField]==b)return h;h.children&&e.push(h.children)}return null}function l(a,b){var c=k(a,b);return c.parentId?k(a,c.parentId):null}function m(a,b){if(!b)return 0;var c=a.options,d=a.datagrid,e=d.panel.getBody().children("div.datagrid-view"),f=e.find('div.datagrid-body tr[node-id="'+b+'"]').children('td[field="'+c.treeField+'"]');return f.find("span.tree-indent,span.tree-hit").length}function n(a,b){var c=a.options,d=c.finder.getTr(a,b),e=d.find("span.tree-hit");e.hasClass("tree-expanded")?q(a,b):o(a,b)}function o(a,c){function d(b){j.state="open",e.animate?b.slideDown("normal",function(){f.autoSizeColumn(),g(a,c),e.onExpand.call(a,j)}):(b.show(),f.autoSizeColumn(),g(a,c),e.onExpand.call(a,j))}var e=a.options,f=a.datagrid,h=e.finder.getTr(a,c),i=h.find("span.tree-hit"),j=k(a,c);if(0!=i.length&&!i.hasClass("tree-expanded")&&0!=e.onBeforeExpand.call(a,j)){i.removeClass("tree-collapsed tree-collapsed-hover").addClass("tree-expanded"),e.showIcon&&i.next().addClass("tree-folder-open");var l=h.next("tr.treegrid-tr-tree");if(l.length){var m=l.children("td").children("div");d(m)}else{p(a,j[e.idField]);var l=h.next("tr.treegrid-tr-tree"),m=l.children("td").children("div");m.hide();var n=$.extend({},e.queryParams||{});n.id=j[e.idField],b(a,j[e.idField],n,!0,function(){m.is(":empty")?l.remove():d(m)})}}}function p(a,b){function c(a,b){$('<tr class="treegrid-tr-tree"><td style="border:0px" colspan="'+b+'"><div></div></td></tr>').insertAfter(a)}var d=a.options,e=a.datagrid,f=d.finder.getTr(a,b,"body",1),g=d.finder.getTr(a,b,"body",2),h=e.getColumnFields(!0).length+(d.rownumbers?1:0),i=e.getColumnFields(!1).length;c(f,h),c(g,i)}function q(a,b){var c=a.options,d=k(a,b),e=a.datagrid,f=c.finder.getTr(a,b),h=f.find("span.tree-hit");if(0!=h.length&&!h.hasClass("tree-collapsed")&&0!=c.onBeforeCollapse.call(a,d)){h.removeClass("tree-expanded tree-expanded-hover").addClass("tree-collapsed"),c.showIcon&&h.next().removeClass("tree-folder-open"),d.state="closed",f=f.next("tr.treegrid-tr-tree");var i=f.children("td").children("div");c.animate?i.slideUp("normal",function(){e.autoSizeColumn(),g(a,b),c.onCollapse.call(a,d)}):(i.hide(),e.autoSizeColumn(),g(a,b),c.onCollapse.call(a,d))}}function r(a){var b=j(a);return b.length?b[0]:null}function s(a,b){var c=a.options,d=i(a,b);b&&d.unshift(k(a,b));for(var e=0;e<d.length;e++)q(a,d[e][c.idField])}function t(a,b){var c=a.options,d=i(a,b);b&&d.unshift(k(a,b));for(var e=0;e<d.length;e++)o(a,d[e][c.idField])}function u(a,b){for(var c=a.options,d=[],e=l(a,b);e;){var b=e[c.idField];d.unshift(b),e=l(a,b)}for(var f=0;f<d.length;f++)o(a,d[f])}function v(a,b){var c=a.options;if(b.parent){var e=c.finder.getTr(a,b.parent);0==e.next("tr.treegrid-tr-tree").length&&p(a,b.parent);var f=e.children('td[field="'+c.treeField+'"]').children("div.datagrid-cell"),g=c.showIcon;if(g){var h=f.children("span.tree-icon");if(h.hasClass("tree-file")){h.removeClass("tree-file").addClass("tree-folder tree-folder-open");var i=$('<span class="tree-hit tree-expanded"></span>').insertBefore(h);i.prev().length&&i.prev().remove()}}else{var j=f.children("span.tree-title"),i=$('<span class="tree-hit tree-expanded"></span>').insertBefore(j);i.prev().length&&i.prev().remove()}}d(a,b.parent,b.data,!0)}function w(a,b){function c(c){var f=c?1:2,g=e.finder.getTr(a,b.data[e.idField],"body",f),h=g.closest("table.datagrid-btable");g=g.parent().children();var i=e.finder.getTr(a,d,"body",f);if(b.before)g.insertBefore(i);else{var j=i.next("tr.treegrid-tr-tree");g.insertAfter(j.length?j:i)}h.remove()}var d=b.before||b.after,e=a.options,g=l(a,d);v(a,{parent:g?g[e.idField]:null,data:[b.data]});for(var h=g?g.children:a.getRoots(),i=0;i<h.length;i++)if(h[i][e.idField]==d){var j=h[h.length-1];h.splice(b.before?i:i+1,0,j),h.splice(h.length-1,1);break}c(!0),c(!1),f(a),a.showLines()}function x(a,b){var c=a.datagrid;c.deleteRow(b),f(a),a.total-=1;var d=c.getPager();d&&d.refresh({total:a.total}),a.showLines()}erajs.ui.Treegrid=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Treegrid.defaults,erajs.ui.Treegrid.parseOptions(b),a),this.data=[],this.id=this.options.id),this._render(b)},erajs.ui.Treegrid.prototype={updateTreegrid:function(a){var b=this,c=$.extend(b.options,a);b.options=c,b._render()},resize:function(a){var b=this,c=b.datagrid;c.resize(a)},loadData:function(a){d(this,a.parent,a)},load:function(a){var b=this,c=b.options,d=b.datagrid;c.pageNumber=1;var e=d.getPager();e&&e.pagination({pageNumber:1}),b.reload(a)},reload:function(a){var c=this,d=c.options,e=(c.datagrid,{});if("object"==typeof a?e=a:(e=$.extend({},d.queryParams),e.id=a),e.id){var f=c.find(e.id);f.children&&f.children.splice(0,f.children.length),d.queryParams=e;var g=d.finder.getTr(c,e.id);g.next("tr.treegrid-tr-tree").remove(),g.find("span.tree-hit").removeClass("tree-expanded tree-expanded-hover").addClass("tree-collapsed"),o(c,e.id)}else b(c,null,e)},reloadFooter:function(a){var b=this,c=b.options,d=b.datagrid,e=d.dc;a&&(b.footer=a),c.showFooter&&(c.view.renderFooter.call(c.view,b,e.footer1,!0),c.view.renderFooter.call(c.view,b,e.footer2,!1),c.view.onAfterRender&&c.view.onAfterRender.call(c.view,d),b.fixRowHeight())},getData:function(){return this.data},getFooterRows:function(){return this.footer},getRoot:function(){return r(this)},getRoots:function(){return j(this)},getParent:function(a){return l(this,a)},getChildren:function(a){return i(this,a)},getLevel:function(a){return m(this,a)},getSelected:function(){var a=this,b=a.datagrid;return b.getSelected()},find:function(a){return k(this,a)},isLeaf:function(a){var b=this,c=b.options,d=c.finder.getTr(b,a),e=d.find("span.tree-hit");return 0==e.length},select:function(a){var b=this,c=b.datagrid;c.selectRow(a)},unselect:function(a){var b=this,c=b.datagrid;c.unselectRow(a)},fixRowHeight:function(a){g(this,a)},showLines:function(){h(this)},toggle:function(a){n(this,a)},expand:function(a){o(this,a)},collapse:function(a){q(this,a)},collapseAll:function(a){s(this,a)},expandAll:function(a){t(this,a)},expandTo:function(a){u(this,a)},append:function(a){v(this,a)},insert:function(a){w(this,a)},remove:function(a){x(this,a)},pop:function(a){var b=this,c=b.find(a);return b.remove(a),c},refresh:function(a){var b=this,c=this.options;c.view.refreshRow.call(c.view,b,a)},update:function(a){var b=this,c=b.options;c.view.updateRow.call(c.view,b,a.id,a.row)},beginEdit:function(a){var b=this,c=b.datagrid;c.beginEdit(a),b.fixRowHeight(a)},endEdit:function(a){var b=this,c=b.datagrid;c.endEdit(a)},cancelEdit:function(a){var b=this,c=b.datagrid;c.cancelEdit(a)},destroy:function(a){var b=this;b.datagrid.destroy(a)},_render:function(d){var e=this,d=d||e.target,f=e.options;a(this);var g=f.data;g&&e.loadData(g),f.autoLoad&&b(this),c(this)}};var y=$.extend({},erajs.ui.Datagrid.defaults.view,{render:function(a,b,c){function d(b,c,f){for(var k=a.getParent(f[0][e.idField]),l=(k?k.children.length:j(a).length)-f.length,m=['<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>'],n=0;n<f.length;n++){var o=f[n];"open"!=o.state&&"closed"!=o.state&&(o.state="open");var p=e.rowStyler?e.rowStyler.call(a,o):"",q="",r="";"string"==typeof p?r=p:p&&(q=p["class"]||"",r=p.style||"");var s='class="datagrid-row '+(l++%2&&e.striped?"datagrid-row-alt ":" ")+q+'"',t=r?'style="'+r+'"':"",u=h+"-"+(b?1:2)+"-"+o[e.idField];if(m.push('<tr id="'+u+'" node-id="'+o[e.idField]+'" '+s+" "+t+">"),m=m.concat(i.renderRow.call(i,a,g,b,c,o)),m.push("</tr>"),o.children&&o.children.length){var v=d(b,c+1,o.children),w="closed"==o.state?"none":"block";m.push('<tr class="treegrid-tr-tree"><td style="border:0px" colspan='+(g.length+(e.rownumbers?1:0))+'><div style="display:'+w+'">'),m=m.concat(v),m.push("</div></td></tr>")}}return m.push("</tbody></table>"),m}a=a.xtype?a:erajs.getCmp(a.id);var e=a.options,f=a.datagrid,g=f.getColumnFields(c),h=f.rowIdPrefix;if(!c||e.rownumbers||e.frozenColumns&&e.frozenColumns.length){var i=this;if(this.treeNodes&&this.treeNodes.length){var k=d(c,this.treeLevel,this.treeNodes);$(b).append(k.join(""))}}},renderFooter:function(a,b,c){a=a.xtype?a:erajs.getCmp(a.id);for(var d=a.options,e=a.footer||[],f=a.datagrid,g=f.getColumnFields(c),h=['<table class="datagrid-ftable" cellspacing="0" cellpadding="0" border="0"><tbody>'],i=0;i<e.length;i++){var j=e[i];j[d.idField]=j[d.idField]||"foot-row-id"+i,h.push('<tr class="datagrid-row" node-id="'+j[d.idField]+'">'),h.push(this.renderRow.call(this,a,g,c,0,j)),h.push("</tr>")}h.push("</tbody></table>"),$(b).html(h.join(""))},renderRow:function(a,b,c,d,e){a=a.xtype?a:erajs.getCmp(a.id);var f=a.options,g=[],h=a.datagrid,i=f.onBeforeRenderRow.call(a,e,d,c);if(i)return i;c&&f.rownumbers&&g.push('<td class="datagrid-td-rownumber"><div class="datagrid-cell-rownumber">0</div></td>');for(var j=0;j<b.length;j++){var k=b[j],l=h.getColumnOption(k);if(l){var m=l.styler?l.styler(e[k],e)||"":"",n="",o="";"string"==typeof m?o=m:g&&(n=m["class"]||"",o=m.style||"");var p=n?'class="'+n+'"':"",q=l.tip||!1,r=q?'tip="'+q+'"':"",s="";if(q){var t=l.gravity||"w";s='gravity="'+t+'"'}var u=l.hidden?'style="display:none;'+o+'"':o?'style="'+o+'"':"";g.push('<td field="'+k+'" '+r+" "+s+" "+p+" "+u+">");var u="";if(l.checkbox||(l.align&&(u+="text-align:"+l.align+";"),f.nowrap?f.autoRowHeight&&(u+="height:auto;"):u+="white-space:normal;height:auto;"),g.push('<div style="'+u+'" '),g.push(l.checkbox?'class="datagrid-cell-check ':'class="datagrid-cell '+l.cellClass),g.push('">'),l.checkbox)g.push(e.checked?'<input type="checkbox" checked="checked"':'<input type="checkbox"'),g.push(' name="'+k+'" value="'+(void 0!=e[k]?e[k]:"")+'">');else{var v=null;if(v=l.formatter?l.formatter(e[k],e):e[k],k==f.treeField){for(var w=0;d>w;w++)g.push('<span class="tree-indent"></span>');"closed"==e.state?(g.push('<span class="tree-hit tree-collapsed"></span>'),f.showIcon&&g.push('<span class="tree-icon tree-folder '+(e.iconCls?e.iconCls:"")+'"></span>')):e.children&&e.children.length?(g.push('<span class="tree-hit tree-expanded"></span>'),f.showIcon&&g.push('<span class="tree-icon tree-folder tree-folder-open '+(e.iconCls?e.iconCls:"")+'"></span>')):(g.push('<span class="tree-indent"></span>'),f.showIcon&&g.push('<span class="tree-icon tree-file '+(e.iconCls?e.iconCls:"")+'"></span>')),g.push('<span class="tree-title">'+v+"</span>")}else g.push(v)}g.push("</div>"),g.push("</td>")}}return g.join("")},refreshRow:function(a,b){a=a.xtype?a:erajs.getCmp(a.id),this.updateRow.call(this,a,b,{})},updateRow:function(a,b,c){function d(c){var d=f.getColumnFields(c),l=e.finder.getTr(a,b,"body",c?1:2),m=l.find("div.datagrid-cell-rownumber").html(),n=l.find("div.datagrid-cell-check input[type=checkbox]").is(":checked");l.html(this.renderRow(a,d,c,h,g)),l.attr("style",i||""),l.find("div.datagrid-cell-rownumber").html(m),n&&l.find("div.datagrid-cell-check input[type=checkbox]")._propAttr("checked",!0),k!=b&&(l.attr("id",j+"-"+(c?1:2)+"-"+k),l.attr("node-id",k))}a=a.xtype?a:erajs.getCmp(a.id);var e=a.options,f=a.datagrid,g=a.find(b);$.extend(g,c);var h=a.getLevel(b)-1,i=e.rowStyler?e.rowStyler.call(a,g):"",j=f.rowIdPrefix,k=g[e.idField];d.call(this,!0),d.call(this,!1),a.fixRowHeight(b)},deleteRow:function(a,b){function c(b){var c,e=a.getParent(b);c=e?e.children:a.getData();for(var f=0;f<c.length;f++)if(c[f][d.idField]==b){c.splice(f,1);break}return e}a=a.xtype?a:erajs.getCmp(a.id);var d=a.options,e=d.finder.getTr(a,b);e.next("tr.treegrid-tr-tree").remove(),e.remove();var f=c(b);if(f&&0==f.children.length){e=d.finder.getTr(a,f[d.idField]),e.next("tr.treegrid-tr-tree").remove();var g=e.children('td[field="'+d.treeField+'"]').children("div.datagrid-cell");d.showIcon&&g.find(".tree-icon").removeClass("tree-folder").addClass("tree-file"),g.find(".tree-hit").remove(),$('<span class="tree-indent"></span>').prependTo(g)}},onBeforeRender:function(a,b,c){function d(a,b){for(var c=0;c<a.length;c++){var f=a[c];f.parentId=b,f.children&&f.children.length&&d(f.children,f[e.idField])}}if(a=a.xtype?a:erajs.getCmp(a.id),$.isArray(b)&&(c={total:b.length,rows:b},b=null),!c)return!1;var e=a.options;void 0==c.length?(c.footer&&(a.footer=c.footer),erajs.isEmpty(c.total)||(a.total=c.total),c=this.transfer(a,b,c.rows)):d(c,b);var f=k(a,b);f?f.children=f.children?f.children.concat(c):c:a.data=a.data.concat(c),this.sort(a,c),this.treeNodes=c,this.treeLevel=m(a,b)},sort:function(a,b){function c(a){a.sort(function(a,b){for(var c=0,d=0;d<f.length;d++){var h=f[d],i=g[d],j=e.getColumnOption(h),k=j.sorter||function(a,b){return a==b?0:a>b?1:-1};if(c=k(a[h],b[h])*("asc"==i?1:-1),0!=c)return c}return c});for(var b=0;b<a.length;b++){var d=a[b].children;d&&d.length&&c(d)}}a=a.xtype?a:erajs.getCmp(a.id);var d=a.options,e=a.datagrid;if(!d.remoteSort&&d.sortName){var f=d.sortName.split(","),g=d.sortOrder.split(",");c(b)}},transfer:function(a,b,c){a=a.xtype?a:erajs.getCmp(a.id);for(var d=a.options,e=[],f=0;f<c.length;f++)e.push(c[f]);for(var g=[],f=0;f<e.length;f++){var h=e[f];b?h.parentId==b&&(g.push(h),e.splice(f,1),f--):h.parentId||(g.push(h),e.splice(f,1),f--)}for(var i=[],f=0;f<g.length;f++)i.push(g[f]);for(;i.length;)for(var j=i.shift(),f=0;f<e.length;f++){var h=e[f];h.parentId==j[d.idField]&&(j.children?j.children.push(h):j.children=[h],i.push(h),e.splice(f,1),f--)}return g}});erajs.ui.Treegrid.defaults=$.extend({},erajs.ui.Datagrid.defaults,{treeField:null,lines:!1,showIcon:!0,animate:!1,singleSelect:!0,view:y,loader:function(a,b,c){var d=this.options;return d.url?void $.ajax({type:d.method,url:d.url,data:a,dataType:"json",success:function(a){b(a)},error:function(){c.apply(this,arguments)}}):!1},finder:{getTr:function(a,b,c,d){c=c||"body",d=d||0;var e=a.dc,f=a.datagrid;if(0==d){var g=a.options,h=g.finder.getTr(a,b,c,1),i=g.finder.getTr(a,b,c,2);return h.add(i)}if("body"==c){var j=$("#"+f.rowIdPrefix+"-"+d+"-"+b);return j.length||(j=(1==d?e.body1:e.body2).find('tr[node-id="'+b+'"]')),j}return"footer"==c?(1==d?e.footer1:e.footer2).find('tr[node-id="'+b+'"]'):"selected"==c?(1==d?e.body1:e.body2).find("tr.datagrid-row-selected"):"highlight"==c?(1==d?e.body1:e.body2).find("tr.datagrid-row-over"):"checked"==c?(1==d?e.body1:e.body2).find("tr.datagrid-row-checked"):"last"==c?(1==d?e.body1:e.body2).find("tr:last[node-id]"):"allbody"==c?(1==d?e.body1:e.body2).find("tr[node-id]"):"allfooter"==c?(1==d?e.footer1:e.footer2).find("tr[node-id]"):void 0},getRow:function(a,b){var c="object"==typeof b?b.attr("node-id"):b;return k(a,c)},getRows:function(a){return i(a)}},loadFilter:function(a){return a},onBeforeRenderRow:function(){},onBeforeLoad:function(){},onLoadSuccess:function(){},onLoadError:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeExpand:function(){},onExpand:function(){},onClickRow:function(){},onDblClickRow:function(){},onClickCell:function(){},onDblClickCell:function(){},onContextMenu:function(){},onBeforeEdit:function(){},onAfterEdit:function(){},onCancelEdit:function(){}}),erajs.ui.Treegrid.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Datagrid.parseOptions(a),erajs.ui.parser.parseOptions(b,["treeField",{animate:"boolean"}]))}}(),function(){function a(a){var c=a.options,d=a.target,e=a.tree,f=a.combo;f||($(d).addClass("combotree-f"),f=new erajs.ui.Combo($.extend({},c,{target:d})),a.combo=f);var g=$.extend({},c,{checkbox:c.multiple,onLoadSuccess:function(b,d){var e=this,g=f.getValues();if(c.multiple)for(var h=e.getChecked(),i=0;i<h.length;i++){var j=h[i].id;!function(){for(var a=0;a<g.length;a++)if(j==g[a])return;g.push(j)}()}var k=e.options,l=k.onCheck,m=k.onSelect;k.onCheck=k.onSelect=function(){},a.setValues(g),k.onCheck=l,k.onSelect=m,c.onLoadSuccess.call(e,b,d)},onClick:function(d){var e=this;c.multiple?d.checked?e.uncheck(d.target):e.check(d.target):f.hidePanel(),b(a),c.onClick.call(this,d)},onCheck:function(d,e){b(a),c.onCheck.call(this,d,e)}}),h=f.panel.getBody();if(e)e.updateTree(g);else{var i=$("<ul></ul>").appendTo(h);e=new erajs.ui.Tree($.extend({},g,{target:i[0]})),a.tree=e}}function b(a){var b=a.options,c=a.tree,d=a.combo,e=[],f=[];if(b.multiple)for(var g=c.getChecked(),h=0;h<g.length;h++)e.push(g[h].id),f.push(g[h].text);else{var i=c.getSelected();i&&(e.push(i.id),f.push(i.text))}d.setValues(e),d.setText(f.join(b.separator))}function c(a,b){var c=a.options,d=a.combo,e=a.tree,f=e.tree;f.find("span.tree-checkbox").addClass("tree-checkbox0").removeClass("tree-checkbox1 tree-checkbox2");for(var g=[],h=[],i=0;i<b.length;i++){var j=b[i],k=j,l=e.find(j);l&&(k=l.text,e.check(l.target),e.select(l.target)),g.push(j),h.push(k)}d.setValues(g),d.setText(h.join(c.separator))}erajs.ui.Combotree=function(b){b=b||{};var c=b.target;if(!c){var d=b.contentEl;d&&(c=$(d)[0])}c&&(this.target=c,this.options=$.extend({},erajs.ui.Combotree.defaults,erajs.ui.Combotree.parseOptions(c),b),this.id=this.options.id),a(this)},erajs.ui.Combotree.prototype={updateCombotree:function(a){var b=this,c=$.extend({},b.options,a);b.options=c,b._render()},getTree:function(){return this.tree},loadData:function(a){var b=this,c=b.tree;
b.data=a,c.loadData(a)},reload:function(a){var b=this,c=b.options,d=b.tree;a&&(c.url=a),d.updateTree({url:c.url})},setValues:function(a){c(this,a)},setValue:function(a){c(this,[a])},getValue:function(){return this.combo.getValue()},getValues:function(){return this.combo.getValues()},disable:function(){this.combo.disable()},enable:function(){this.combo.enable()},readonly:function(a){this.combo.readonly(a)},hidePanel:function(){this.combo.hidePanel()},destroy:function(){this.combo.destroy(),erajs.destroy(this)},_render:function(){a(this)}},erajs.ui.Combotree.defaults=$.extend({},erajs.ui.Combo.defaults,erajs.ui.Tree.defaults,{editable:!1}),erajs.ui.Combotree.parseOptions=function(a){return $.extend({},erajs.ui.Combo.parseOptions(a),erajs.ui.Tree.parseOptions(a))}}(),function(){function a(a,b){var c=a.options,d=a.grid,e=d.getRows().length;if(e){var f=c.finder.getTr(d,null,"highlight");f.length||(f=c.finder.getTr(d,null,"selected"));var g;if(f.length){var g=parseInt(f.attr("datagrid-row-index"));g+="next"==b?1:-1,0>g&&(g=e-1),g>=e&&(g=0)}else g="next"==b?0:e-1;d.highlightRow(g),c.selectOnNavigation&&(a.remainText=!1,d.selectRow(g))}}function b(a){var b=a.options,c=a.grid,d=b.finder.getTr(c,null,"highlight");if(a.remainText=!1,d.length){var e=parseInt(d.attr("datagrid-row-index"));b.multiple&&d.hasClass("datagrid-row-selected")?c.unselectRow(e):c.selectRow(e)}var f=[];$.map(c.getSelections(),function(a){f.push(a[b.idField])}),a.setValues(f),b.multiple||a.hidePanel()}function c(a,b){var c=a.options,d=a.grid;if(a.remainText=!0,c.multiple&&!b?e(a,[],!0):e(a,[b],!0),"remote"==c.mode)d.clearSelections(),d.load($.extend({},c.queryParams,{q:b}));else{if(!b)return;d.clearSelections(),d.highlightRow(-1);var f=d.getRows(),g=c.multiple?b.split(c.separator):[b];$.map(g,function(b){b=$.trim(b),b&&$.map(f,function(e,f){b==e[c.textField]?d.selectRow(f):c.filter.call(a,b,e)&&d.highlightRow(f)})})}}function d(d){function f(a,b){d.remainText=!1,g(),h.multiple||k.hidePanel(),h.onClickRow.call(d,a,b)}function g(){for(var a=j.getSelections(),b=[],c=[],e=0;e<a.length;e++)b.push(a[e][h.idField]),c.push(a[e][h.textField]);k.setValues(h.multiple?b:b.length?b:[""]),d.remainText||k.setText(c.join(h.separator))}var h=d.options,i=d.target,j=d.grid,k=d.combo;k||($(i).addClass("combogrid-f"),k=new erajs.ui.Combo($.extend({},h,{target:i,onShowPanel:function(){h.autoLoad===!1&&d.loaded===!1&&(j.load(),d.loaded=!0),j.resize(),h.onShowPanel.call(d)},keyHandler:{up:function(b){a(d,"prev"),b.preventDefault()},down:function(b){a(d,"next"),b.preventDefault()},left:function(){},right:function(){},enter:function(){b(d)},query:function(a){c(d,a)}}})),d.combo=k);var l=$.extend({},h,{border:!1,singleSelect:!h.multiple,onLoadSuccess:function(){var a=k.getValues(),b=h.onSelect;h.onSelect=function(){},e(d,a,d.remainText),h.onSelect=b,h.onLoadSuccess.apply(d,arguments)},onClickRow:f,onSelect:function(a,b){g(),h.onSelect.call(d,a,b)},onUnselect:function(a,b){g(),h.onUnselect.call(d,a,b)},onSelectAll:function(a){g(),h.onSelectAll.call(d,a)},onUnselectAll:function(a){h.multiple&&g(),h.onUnselectAll.call(d,a)}}),m=k.panel.getBody();if(j)j.datagrid(l);else{var n=$("<table></table>").appendTo(m);j=new erajs.ui.Datagrid($.extend({},l,{target:n[0],fit:!0})),d.grid=j}}function e(a,b,c){{var d=a.options,e=a.grid,f=a.combo,g=e.getRows(),h=[],i=f.getValues(),j=f.options;j.onChange}j.onChange=function(){},e.clearSelections();for(var k=0;k<b.length;k++){var l=e.getRowIndex(b[k]);l>=0?(e.selectRow(l),h.push(g[l][d.textField])):h.push(b[k])}if(f.setValues(i),f.setValues(b),!c){var m=h.join(d.separator);f.getText()!=m&&f.setText(m)}}erajs.ui.Combogrid=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}b&&(this.target=b,this.options=$.extend({},erajs.ui.Combogrid.defaults,erajs.ui.Combogrid.parseOptions(b),a),this.id=this.options.id,this.loaded=!1),d(this)},erajs.ui.Combogrid.prototype={getGrid:function(){return this.grid},setValues:function(a){e(this,a)},setValue:function(a){e(this,[a])},getValues:function(){return this.combo.getValues()},getValue:function(){return this.combo.getValue()},disable:function(){this.combo.disable()},enable:function(){this.combo.enable()},readonly:function(a){this.combo.readonly(a)},clear:function(){var a=this,b=a.grid,c=a.combo;b.clearSelections(),c.clear()},reset:function(){{var a=this,b=a.options;a.grid}b.multiple?a.setValues(b.originalValue):a.setValue(b.originalValue)},hidePanel:function(){this.combo.hidePanel()},destroy:function(){this.combo.destroy(),erajs.destroy(this)},_render:function(){var a=this;d(a)}},erajs.ui.Combogrid.defaults=$.extend({},erajs.ui.Combo.defaults,erajs.ui.Datagrid.defaults,{height:22,loadMsg:null,idField:null,textField:null,mode:"local",filter:function(a,b){var c=this.options;return 0==b[c.textField].toLowerCase().indexOf(a.toLowerCase())}}),erajs.ui.Combogrid.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Combo.parseOptions(a),erajs.ui.Datagrid.parseOptions(a),erajs.ui.parser.parseOptions(b,["idField","textField","mode"]))}}(),function(){function a(a){var e=a.target,f=a.options,g=a.datagrid,h=$.extend({},f,{cls:"propertygrid",view:f.showGroup?f.groupView:f.view,onClickCell:function(g,h,i){var j=this;d!=e&&(b(d),d=this.target);var k=j.getRows()[g];if(f.editIndex!=g&&k.editor){var l=j.getColumnOption("value");l.editor=k.editor,b(d,a),j.beginEdit(g);var m=j.getEditor({index:g,field:h});m||(m=j.getEditor({index:g,field:"value"})),m&&(c(m).focus(),f.editIndex=g)}f.onClickCell.call(a,g,h,i)},loadFilter:function(c){return b(e,a),f.loadFilter.call(this,c)}});g?g.datagrid(h):g=new erajs.ui.Datagrid($.extend({},h,{target:e})),a.datagrid=g,$(document).unbind(".propertygrid").bind("mousedown.propertygrid",function(c){var e=$(c.target).closest("div.datagrid-view,div.combo-panel");e.length||(b(d,a),d=void 0)})}function b(a,b){var d=$(a);if(d.length){var e=b.datagrid,f=b.options,g=f.editIndex;if(void 0!=g){var h=e.getEditors(g);h.length&&($.map(h,function(a){c(a).blur()}),e.endEdit(g)),f.editIndex=void 0}}}function c(a){return $(a.component)}var d;erajs.ui.Propertygrid=function(a){a=a||{};var b=a.target;if(!b){var c=a.contentEl;c&&(b=$(c)[0])}if(b){this.target=b;var d=$.extend({},erajs.ui.Propertygrid.defaults,erajs.ui.Propertygrid.parseOptions(b),a);d.frozenColumns=$.extend(!0,[],d.frozenColumns),d.columns=$.extend(!0,[],d.columns),this.options=d,this.id=this.options.id}this._render(b)},erajs.ui.Propertygrid.prototype={updateProgrid:function(a){var b=this,c=$.extend({},b.options,a);b.options=c,b._render()},expandGroup:function(a){var b=this.datagrid,c=b.dc.view,d=c.find(void 0!=a?'div.datagrid-group[group-index="'+a+'"]':"div.datagrid-group"),e=d.find("span.datagrid-row-expander");e.hasClass("datagrid-row-expand")&&(e.removeClass("datagrid-row-expand").addClass("datagrid-row-collapse"),d.next("table").show()),b.fixRowHeight()},collapseGroup:function(a){var b=this.datagrid,c=b.dc.view,d=c.find(void 0!=a?'div.datagrid-group[group-index="'+a+'"]':"div.datagrid-group"),e=d.find("span.datagrid-row-expander");e.hasClass("datagrid-row-collapse")&&(e.removeClass("datagrid-row-collapse").addClass("datagrid-row-expand"),d.next("table").hide()),b.fixRowHeight()},destroy:function(a){var b=this;b.datagrid.destroy(a)},_render:function(){var b=this;a(b)}};var e=$.extend({},erajs.ui.Datagrid.defaults.view,{render:function(a,b,c){a=a.xtype?a:erajs.getCmp(a.id),table=[],groups=a.groups;for(var d=0;d<groups.length;d++)table.push(this.renderGroup.call(this,a,d,groups[d],c));$(b).html(table.join(""))},renderGroup:function(a,b,c,d){a=a.xtype?a:erajs.getCmp(a.id),opts=a.options,target=a.target,state=a.datagrid,fields=state.getColumnFields(d);var e=[];e.push('<div class="datagrid-group" group-index='+b+">"),e.push('<table cellspacing="0" cellpadding="0" border="0" style="height:100%"><tbody>'),e.push("<tr>"),(d&&(opts.rownumbers||opts.frozenColumns.length)||!d&&!opts.rownumbers&&!opts.frozenColumns.length)&&e.push('<td style="border:0;text-align:center;width:25px"><span class="datagrid-row-expander datagrid-row-collapse" style="display:inline-block;width:16px;height:16px;cursor:pointer">&nbsp;</span></td>'),e.push('<td style="border:0;">'),d||(e.push('<span class="datagrid-group-title">'),e.push(opts.groupFormatter.call(a,c.value,c.rows)),e.push("</span>")),e.push("</td>"),e.push("</tr>"),e.push("</tbody></table>"),e.push("</div>"),e.push('<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>');for(var f=c.startIndex,g=0;g<c.rows.length;g++){var h=opts.rowStyler?opts.rowStyler.call(a,f,c.rows[g]):"",i="",j="";"string"==typeof h?j=h:h&&(i=h["class"]||"",j=h.style||"");var k='class="datagrid-row '+(f%2&&opts.striped?"datagrid-row-alt ":" ")+i+'"',l=j?'style="'+j+'"':"",m=state.rowIdPrefix+"-"+(d?1:2)+"-"+f;e.push('<tr id="'+m+'" datagrid-row-index="'+f+'" '+k+" "+l+">"),e.push(this.renderRow.call(this,state,fields,d,f,c.rows[g])),e.push("</tr>"),f++}return e.push("</tbody></table>"),e.join("")},bindEvents:function(a){var b=a.datagrid,c=b.dc,d=c.body1.add(c.body2),e=($.data(d[0],"events")||$._data(d[0],"events")).click[0].handler;d.unbind("click").bind("click",function(b){var c=$(b.target),d=c.closest("span.datagrid-row-expander");if(d.length){var f=d.closest("div.datagrid-group").attr("group-index");d.hasClass("datagrid-row-collapse")?a.collapseGroup(f):a.expandGroup(f)}else e(b);b.stopPropagation()})},onBeforeRender:function(a,b){function c(a){for(var b=0;b<e.length;b++){var c=e[b];if(c.value==a)return c}return null}function d(){$("#datagrid-group-style").length||$("head").append('<style id="datagrid-group-style">.datagrid-group{height:25px;overflow:hidden;font-weight:bold;border-bottom:1px solid #ccc;}</style>')}a=a.xtype?a:erajs.getCmp(a.id),state=a.datagrid,opts=a.options,d();for(var e=[],f=0;f<b.length;f++){var g=b[f],h=c(g[opts.groupField]);h?h.rows.push(g):(h={value:g[opts.groupField],rows:[g]},e.push(h))}for(var i=0,j=[],f=0;f<e.length;f++){var h=e[f];h.startIndex=i,i+=h.rows.length,j=j.concat(h.rows)}state.data.rows=j,a.groups=e;var k=this;setTimeout(function(){k.bindEvents(a)},0)}});erajs.ui.Propertygrid.defaults=$.extend({},erajs.ui.Datagrid.defaults,{singleSelect:!0,remoteSort:!1,fitColumns:!0,loadMsg:"",frozenColumns:[[{field:"f",width:16,resizable:!1}]],columns:[[{field:"name",title:"Name",width:100,sortable:!0},{field:"value",title:"Value",width:100,resizable:!1}]],showGroup:!1,groupView:e,groupField:"group",groupFormatter:function(a){return a}}),erajs.ui.Propertygrid.parseOptions=function(a){var b=$(a);return $.extend({},erajs.ui.Datagrid.parseOptions(a),erajs.ui.parser.parseOptions(b,[{showGroup:"boolean"}]))}}(),function(a){a.extend(a.fn,{validate:function(b){if(!this.length)return void(b&&b.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));this.setUiNameAttribute();var c=a.data(this[0],"validator");return c?c:(this.attr("novalidate","novalidate"),c=new a.validator(b,this[0]),a.data(this[0],"validator",c),c.settings.onsubmit&&(this.validateDelegate(":submit","click",function(b){c.settings.submitHandler&&(c.submitButton=b.target),a(b.target).hasClass("cancel")&&(c.cancelSubmit=!0),void 0!==a(b.target).attr("formnovalidate")&&(c.cancelSubmit=!0)}),this.submit(function(b){function d(){var d;return c.settings.submitHandler?(c.submitButton&&(d=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(a(c.submitButton).val()).appendTo(c.currentForm)),c.settings.submitHandler.call(c,c.currentForm,b),c.submitButton&&d.remove(),!1):!0}return c.settings.debug&&b.preventDefault(),c.cancelSubmit?(c.cancelSubmit=!1,d()):c.form()?c.pendingRequest?(c.formSubmitted=!0,!1):d():(c.focusInvalid(),!1)})),c)},valid:function(){var b,c;return a(this[0]).is("form")?b=this.validate().form():(b=!0,c=a(this[0].form).validate(),this.each(function(){b=c.element(this)&&b})),b},removeAttrs:function(b){var c={},d=this;return a.each(b.split(/\s/),function(a,b){c[b]=d.attr(b),d.removeAttr(b)}),c},rules:function(b,c){var d,e,f,g,h,i,j=this[0];if(b)switch(d=a.data(j.form,"validator").settings,e=d.rules,f=a.validator.staticRules(j),b){case"add":a.extend(f,a.validator.normalizeRule(c)),delete f.messages;var k=erajs.getUiNameAttribute(j);e[k]=f,c.messages&&(d.messages[k]=a.extend(d.messages[k],c.messages));break;case"remove":if(!c){var k=erajs.getUiNameAttribute(j);return delete e[k],f}return i={},a.each(c.split(/\s/),function(b,c){i[c]=f[c],delete f[c],"required"===c&&a(j).removeAttr("aria-required")}),i}return g=a.validator.normalizeRules(a.extend({},a.validator.classRules(j),a.validator.attributeRules(j),a.validator.dataRules(j),a.validator.staticRules(j)),j),g.required&&(h=g.required,delete g.required,g=a.extend({required:h},g),a(j).attr("aria-required","true")),g.remote&&(h=g.remote,delete g.remote,g=a.extend(g,{remote:h})),g}}),a.extend(a.expr[":"],{blank:function(b){return!a.trim(""+a(b).val())},filled:function(b){return!!a.trim(""+a(b).val())},unchecked:function(b){return!a(b).prop("checked")}}),a.validator=function(b,c){this.settings=a.extend(!0,{},a.validator.defaults,b),this.currentForm=c,this.init()},a.validator.format=function(b,c){return 1===arguments.length?function(){var c=a.makeArray(arguments);return c.unshift(b),a.validator.format.apply(this,c)}:(arguments.length>2&&c.constructor!==Array&&(c=a.makeArray(arguments).slice(1)),c.constructor!==Array&&(c=[c]),a.each(c,function(a,c){b=b.replace(new RegExp("\\{"+a+"\\}","g"),function(){return c})}),b)},a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a){this.lastActive=a,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(a)))},onfocusout:function(a){var b=erajs.getUiNameAttribute(a);this.checkable(a)||!(b in this.submitted)&&this.optional(a)||this.element(a)},onkeyup:function(a,b){var c=erajs.getUiNameAttribute(a);(9!==b.which||""!==this.elementValue(a))&&(c in this.submitted||a===this.lastElement)&&this.element(a)},onclick:function(a){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).removeClass(c).addClass(d):a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function b(b){var c=a.data(this[0].form,"validator"),d="on"+b.type.replace(/^validate/,""),e=c.settings;e[d]&&!this.is(e.ignore)&&e[d].call(c,this[0],b)}this.labelContainer=a(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm),this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var c,d=this.groups={};a.each(this.settings.groups,function(b,c){"string"==typeof c&&(c=c.split(/\s/)),a.each(c,function(a,c){d[c]=b})}),c=this.settings.rules,a.each(c,function(b,d){c[b]=a.validator.normalizeRule(d)}),a(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox']","focusin focusout keyup",b).validateDelegate("select, option, [type='radio'], [type='checkbox']","click",b),this.settings.invalidHandler&&a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler),a(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),a.extend(this.submitted,this.errorMap),this.invalid=a.extend({},this.errorMap),this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(b){var c=this.clean(b),d=this.validationTargetFor(c),e=!0;if(this.lastElement=d,void 0===d)delete this.invalid[c.name];else{this.prepareElement(d),this.currentElements=a(d),e=this.check(d)!==!1;var f=erajs.getUiNameAttribute(d);e?delete this.invalid[f]:this.invalid[f]=!0}return a(b).attr("aria-invalid",!e),this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e},showErrors:function(b){if(b){a.extend(this.errorMap,b),this.errorList=[];for(var c in b)this.errorList.push({message:b[c],element:this.findByName(c)[0]});this.successList=a.grep(this.successList,function(a){return!(a.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue").removeAttr("aria-invalid")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b,c=0;for(b in a)c++;return c},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(a){a.not(this.containers).text(""),this.addWrapper(a).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&1===a.grep(this.errorList,function(a){return a.element.name===b.name}).length&&b},baseElements:function(){var b=this,c={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&b.settings.debug&&window.console&&console.error("%o has no name assigned",this);var d=this.name||this.getAttribute("uiname");return d in c||!b.objectLength(a(this).rules())?!1:(c[d]=!0,!0)})},elements:function(){return this.baseElements()},clean:function(b){return a(b)[0]},errors:function(){var b=this.settings.errorClass.split(" ").join(".");return a(this.settings.errorElement+"."+b,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=a([]),this.toHide=a([]),this.currentElements=a([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset(),this.toHide=this.errorsFor(a)},elementValue:function(b){function c(){var a,b=e.attr("uiname");if(void 0===b)a=e.val();else{var c=e.attr("uiid");if(c){var d=erajs.getCmp(c);if(d){var f=d.options;if(f){var g=f.multiple;try{a=g?d.getValues():d.getValue()}catch(h){}}}}}return a}var d,e=a(b),f=b.type;return"radio"===f||"checkbox"===f?a("input[name='"+b.name+"']:checked").val():"number"===f&&"undefined"!=typeof b.validity?b.validity.badInput?!1:e.val():(d=c(),"string"==typeof d&&(d=a.trim(d.replace(/\r/g,""))),d)},check:function(b){b=this.validationTargetFor(this.clean(b));var c,d,e,f=a(b).rules(),g=a.map(f,function(a,b){return b}).length,h=!1,i=this.elementValue(b);for(d in f){e={method:d,parameters:f[d]};try{if(c=a.validator.methods[d].call(this,i,b,e.parameters),"dependency-mismatch"===c&&1===g){h=!0;continue}if(h=!1,"pending"===c)return void(this.toHide=this.toHide.not(this.errorsFor(b)));if(!c)return this.formatAndAdd(b,e),!1}catch(j){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+b.id+", check the '"+e.method+"' method.",j),j}}if(!h)return this.objectLength(f)&&this.successList.push(b),!0},customDataMessage:function(b,c){return a(b).data("msg"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase())||a(b).data("msg")},customMessage:function(a,b){var c=this.settings.messages[a];return c&&(c.constructor===String?c:c[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a];return void 0},defaultMessage:function(b,c){var d=b.name||b.getAttribute("uiname");return this.findDefined(this.customMessage(d,c),this.customDataMessage(b,c),!this.settings.ignoreTitle&&b.title||void 0,a.validator.messages[c],"<strong>Warning: No message defined for "+d+"</strong>")},formatAndAdd:function(b,c){var d=this.defaultMessage(b,c.method),e=/\$?\{(\d+)\}/g;"function"==typeof d?d=d.call(this,c.parameters,b):e.test(d)&&(d=a.validator.format(d.replace(e,"{$1}"),c.parameters)),this.errorList.push({message:d,element:b,method:c.method});var f=erajs.getUiNameAttribute(b);this.errorMap[f]=d,this.submitted[f]=d},addWrapper:function(a){return this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper))),a},defaultShowErrors:function(){var a,b,c;for(a=0;this.errorList[a];a++)c=this.errorList[a],this.settings.highlight&&this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass),this.showLabel(c.element,c.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight)for(a=0,b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,c){var d,e,f,g=this.errorsFor(b),h=this.idOrName(b),i=a(b).attr("aria-describedby");g.length?(g.removeClass(this.settings.validClass).addClass(this.settings.errorClass),g.html(c)):(g=a("<"+this.settings.errorElement+">").attr("id",h+"-error").addClass(this.settings.errorClass).html(c||""),d=g,this.settings.wrapper&&(d=g.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(d):this.settings.errorPlacement?this.settings.errorPlacement(d,a(b)):d.insertAfter(b),g.is("label")?g.attr("for",h):0===g.parents("label[for='"+h+"']").length&&(f=g.attr("id"),i?i.match(new RegExp("\b"+f+"\b"))||(i+=" "+f):i=f,a(b).attr("aria-describedby",i),e=this.groups[b.name],e&&a.each(this.groups,function(b,c){c===e&&a("[name='"+b+"']",this.currentForm).attr("aria-describedby",g.attr("id"))}))),!c&&this.settings.success&&(g.text(""),"string"==typeof this.settings.success?g.addClass(this.settings.success):this.settings.success(g,b)),this.toShow=this.toShow.add(g)},errorsFor:function(b){var c=this.idOrName(b),d=a(b).attr("aria-describedby"),e="label[for='"+c+"'], label[for='"+c+"'] *";return d&&(e=e+", #"+d.replace(/\s+/g,", #")),this.errors().filter(e)},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){return this.checkable(a)&&(a=this.findByName(a.name).not(this.settings.ignore)[0]),a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(b){return a(this.currentForm).find("[name='"+b+"']")},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case"select":return a("option:selected",c).length;case"input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{"boolean":function(a){return a},string:function(b,c){return!!a(b,c.form).length},"function":function(a,b){return a(b)}},optional:function(b){var c=this.elementValue(b);return!a.validator.methods.required.call(this,c,b)&&"dependency-mismatch"},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(b,c){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[b.name],c&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(a(this.currentForm).submit(),this.formSubmitted=!1):!c&&0===this.pendingRequest&&this.formSubmitted&&(a(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:!0,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(b,c){b.constructor===String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(b){var c={},d=a(b).attr("class");return d&&a.each(d.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])}),c},attributeRules:function(b){var c,d,e={},f=a(b),g=b.getAttribute("type");for(c in a.validator.methods)"required"===c?(d=b.getAttribute(c),""===d&&(d=!0),d=!!d):d=f.attr(c),/min|max/.test(c)&&(null===g||/number|range|text/.test(g))&&(d=Number(d)),d||0===d?e[c]=d:g===c&&"range"!==g&&(e[c]=!0);return e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)&&delete e.maxlength,e},dataRules:function(b){var c,d,e={},f=a(b);for(c in a.validator.methods)d=f.data("rule"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase()),void 0!==d&&(e[c]=d);return e},staticRules:function(b){var c={},d=a.data(b.form,"validator");return d.settings.rules&&(c=a.validator.normalizeRule(d.settings.rules[erajs.getUiNameAttribute(b)])||{}),c},normalizeRules:function(b,c){return a.each(b,function(d,e){if(e===!1)return void delete b[d];if(e.param||e.depends){var f=!0;switch(typeof e.depends){case"string":f=!!a(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c)}f?b[d]=void 0!==e.param?e.param:!0:delete b[d]}}),a.each(b,function(d,e){b[d]=a.isFunction(e)?e(c):e}),a.each(["minlength","maxlength"],function(){b[this]&&(b[this]=Number(b[this]))}),a.each(["rangelength","range"],function(){var c;b[this]&&(a.isArray(b[this])?b[this]=[Number(b[this][0]),Number(b[this][1])]:"string"==typeof b[this]&&(c=b[this].replace(/[\[\]]/g,"").split(/[\s,]+/),b[this]=[Number(c[0]),Number(c[1])]))}),a.validator.autoCreateRanges&&(b.min&&b.max&&(b.range=[b.min,b.max],delete b.min,delete b.max),b.minlength&&b.maxlength&&(b.rangelength=[b.minlength,b.maxlength],delete b.minlength,delete b.maxlength)),b},normalizeRule:function(b){if("string"==typeof b){var c={};a.each(b.split(/\s/),function(){c[this]=!0}),b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c,a.validator.messages[b]=void 0!==d?d:a.validator.messages[b],c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";if("select"===c.nodeName.toLowerCase()){var e=a(c).val();return e&&e.length>0}return this.checkable(c)?this.getLength(b,c)>0:a.trim(b).length>0},email:function(a,b){return this.optional(b)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)},url:function(a,b){return this.optional(b)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a).toString())},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 \-]+/.test(a))return!1;var c,d,e=0,f=0,g=!1;if(a=a.replace(/\D/g,""),a.length<13||a.length>19)return!1;for(c=a.length-1;c>=0;c--)d=a.charAt(c),f=parseInt(d,10),g&&(f*=2)>9&&(f-=9),e+=f,g=!g;return e%10===0},minlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||e>=d},maxlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||d>=e},rangelength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(a.trim(b),c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||c>=a},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},equalTo:function(b,c,d){var e=a(d);return this.settings.onfocusout&&e.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(c).valid()}),b===e.val()},remote:function(b,c,d){if(this.optional(c))return"dependency-mismatch";var e,f,g=this.previousValue(c);return this.settings.messages[c.name]||(this.settings.messages[c.name]={}),g.originalMessage=this.settings.messages[c.name].remote,this.settings.messages[c.name].remote=g.message,d="string"==typeof d&&{url:d}||d,g.old===b?g.valid:(g.old=b,e=this,this.startRequest(c),f={},f[c.name]=b,a.ajax(a.extend(!0,{url:d,mode:"abort",port:"validate"+c.name,dataType:"json",data:f,context:e.currentForm,success:function(b){var d,f,h,i;if("object"===a.type(b)){var j=b.success;if(!j)return;var k=b.data;k.hasOwnProperty("valid")&&(i=k.valid)}else i=b===!0||"true"===b;e.settings.messages[c.name].remote=g.originalMessage,i?(h=e.formSubmitted,e.prepareElement(c),e.formSubmitted=h,e.successList.push(c),delete e.invalid[c.name],e.showErrors()):(d={},f=b&&b.hasOwnProperty("message")?b.message:e.defaultMessage(c,"remote"),d[c.name]=g.message=f,e.invalid[c.name]=!0,e.showErrors(d)),g.valid=i,e.stopRequest(c,i)
}},d)),"pending")}}}),a.format=function(){throw"$.format has been deprecated. Please use $.validator.format instead."};var b,c={};a.ajaxPrefilter?a.ajaxPrefilter(function(a,b,d){var e=a.port;"abort"===a.mode&&(c[e]&&c[e].abort(),c[e]=d)}):(b=a.ajax,a.ajax=function(d){var e=("mode"in d?d:a.ajaxSettings).mode,f=("port"in d?d:a.ajaxSettings).port;return"abort"===e?(c[f]&&c[f].abort(),c[f]=b.apply(this,arguments),c[f]):b.apply(this,arguments)}),a.extend(a.fn,{validateDelegate:function(b,c,d){return this.bind(c,function(c){var e=a(c.target);return e.is(b)?d.apply(e,arguments):void 0})}})}(jQuery),function(a){jQuery.validator.addMethod("byterangelength",function(a,b,c){for(var d=a.length,e=0;e<a.length;e++)a.charCodeAt(e)>127&&d++;return this.optional(b)||d>=c[0]&&d<=c[1]},a.validator.format("Please enter a value which the byte length between {0} and {1}.(one chinese word count 2 bytes)")),a.validator.addMethod("datetime",function(a,b,c){return this.optional(b)||void 0!==erajs.Date.parse(a,c)},"Please enter a valid datetime value in {0} format"),a.validator.addMethod("datetimeboxformat",function(a,b){if(a)return!0;var c=erajs.getCmp(b.getAttribute("uiid")),d=c.datebox.combo.getText();return d?!1:!0},a.validator.format("Please enter a valid datetime text with hour,minute,second in '{0}' format")),a.validator.addMethod("datetimeformat",function(a,b){if(a)return!0;var c=erajs.getCmp(b.getAttribute("uiid")),d=c.combo.getText();return d?!1:!0},a.validator.format("Please enter a valid datetime text in '{0}' format")),a.validator.addMethod("filetype",function(a,b,c){if(a){var d=a.match(/^(.*)(\.)(.{1,8})$/)[3],e=c.indexOf(d);return this.optional(b)||e>-1}return!0},"Do not support the type of file, please upload file of {0} suffixes"),a.validator.addMethod("idcard",function(a,b){var c=/((11|12|13|14|15|21|22|23|31|32|33|34|35|36|37|41|42|43|44|45|46|50|51|52|53|54|61|62|63|64|65)[0-9]{4})(([1|2][0-9]{3}[0|1][0-9][0-3][0-9][0-9]{3}[Xx0-9])|([0-9]{2}[0|1][0-9][0-3][0-9][0-9]{3}))/;return this.optional(b)||c.test(a)},"Please enter a valid idcard number"),a.validator.addMethod("cellphone",function(a,b){var c=/^(((1[3|5|8][0-9]{1}))+\d{8})$/;return this.optional(b)||c.test(a)},"Please enter a valid phone number"),a.validator.addMethod("fax",function(a,b){var c=/(^[0-9]{3,4}\-[0-9]{7,8}$)|(^[0-9]{7,8}$)|(^\([0-9]{3,4}\)[0-9]{3,8}$)|(^0{0,1}13[0-9]{9}$)/;return this.optional(b)||c.test(a)},"Please enter a valid fax number"),a.validator.addMethod("telephone",function(a,b){var c=/^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/,d=/^(((1[3|5|8][0-9]{1}))+\d{8})$/;return this.optional(b)||c.test(a)||d.test(a)},"Please enter a valid telephone number"),a.validator.addMethod("zipcode",function(a,b){var c=/^[0-9]{6}$/;return this.optional(b)||c.test(a)},"Please enter a valid zip code"),a.validator.addMethod("pattern",function(a,b,c){return c=new RegExp(c),this.optional(b)||c.test(a)},"Input content and regexp don't match"),a.validator.addMethod("time",function(a,b){return this.optional(b)||/^([01]\d|2[0-3])(:[0-5]\d){1,2}$/.test(a)},"Please enter a valid time, between 00:00 and 23:59"),a.validator.addMethod("time12h",function(a,b){return this.optional(b)||/^((0?[1-9]|1[012])(:[0-5]\d){1,2}(\ ?[AP]M))$/i.test(a)},"Please enter a valid time in 12-hour am/pm format")}(jQuery),window.Messenger=function(){function a(a,b,c){var d="";if(arguments.length<2?d="target error - target and name are both required":"object"!=typeof a?d="target error - target itself must be window object":"string"!=typeof b&&(d="target error - target name must be string type"),d)throw new Error(d);this.target=a,this.name=b,this.prefix=c}function b(a,b){this.targets={},this.name=a,this.listenFunc=[],this.prefix=b||c,this.initListen()}var c="[PROJECT_NAME]",d="postMessage"in window;return a.prototype.send=d?function(a){this.target.postMessage(this.prefix+"|"+this.name+"__Messenger__"+a,"*")}:function(a){var b=window.navigator[this.prefix+this.name];if("function"!=typeof b)throw new Error("target callback function is not defined");b(this.prefix+a,window)},b.prototype.addTarget=function(b,c){var d=new a(b,c,this.prefix);this.targets[c]=d},b.prototype.initListen=function(){var a=this,b=function(b){"object"==typeof b&&b.data&&(b=b.data);for(var c=b.split("__Messenger__"),b=c[1],d=c[0].split("|"),e=d[0],f=d[1],g=0;g<a.listenFunc.length;g++)e+f===a.prefix+a.name&&a.listenFunc[g](b)};d?"addEventListener"in document?window.addEventListener("message",b,!1):"attachEvent"in document&&window.attachEvent("onmessage",b):window.navigator[this.prefix+this.name]=b},b.prototype.listen=function(a){for(var b=0,c=this.listenFunc.length,d=!1;c>b;b++)if(this.listenFunc[b]==a){d=!0;break}d||this.listenFunc.push(a)},b.prototype.clear=function(){this.listenFunc=[]},b.prototype.send=function(a){var b,c=this.targets;for(b in c)c.hasOwnProperty(b)&&c[b].send(a)},b}(),function(a){var b=erajs.framework.LogicWarpper={needValidated:!0,ajaxTimeout:12e4,warpReqJson:!0,actionRegExp:/do|action/,pageNumber:"pageStart",pageSize:"pageLimit",onReady:function(a,b){var c=this;$(document).ready(function(){if(a){var d=a(b);if(d===!1)return}c.executeDefaultOnReady(b)})},executeDefaultOnReady:function(a){var b=this;if(b.needValidated){var c=a||{},d=c.validationPath,e=void 0!=c.needValidated?c.needValidated:!0,f=void 0!=c.loadValidationXml?c.loadValidationXml:!0;if(e){f&&erajs.loadValidationXml(d);var g=c.targetForm;if(!erajs.isEmpty(g))return erajs.isString(g)?void erajs.prepareValidateRules(g):erajs.isArray(g)?void erajs.Array.each(g,function(a){erajs.prepareValidateRules(a)}):void erajs.Extra.showInfo("Temporarily does not support the argument types.");var h=b.getPageForm();h.length&&erajs.prepareValidateRules(h)}}},extButtonCfg:{dlgtitle:"",dlgw:550,dlgh:350,url:"",dataUrl:"",mustSelected:!0,singleSelect:!0,needAuthorized:!1,isEdit:!1,autoRefresh:!1,actionType:"html",openWith:"inline",btnType:"toolbar",refDgId:"",refFormName:"",paramPrefix:"",mask:!0,maskEl:"",maskMsg:"",async:!0,inWindow:!0,controlTrigger:!0,intervalValue:1,intervalUnit:erajs.Date.SECOND,showTriggerWarnMsg:!1,triggerWarnMsg:"framework.BUTTON_TRIGGER_WARN_MSG"},extDatagridCfg:{identifyField:"id",queryFormName:"",queryParamPrefix:"queryParam",grid2excel:!1,exportAll2excel:!1,showMsg:!0,total:"data.result.total",rows:"data.result.datals"},extCombobox:{dataNode:"",showAllOption:!1,refCombo:"",refUrl:"",reqParam:"",defaultText:"全部",defaultValue:"",langid:"framework.extraUiCfg.DEFAULTCOMBOBOXTEXT"},btnGridRef:new erajs.util.HashMap,parserCustomOptions:function(a,b,c){var d=this,e={};switch(b=erajs.encodeToJsonStr(b),b=erajs.decode(b),a){case"button":e=this.parserButton(b,c);break;case"panel":e=this.parserPanel(b,c);break;case"datagrid":e=this.parserDatagrid(b,c);break;case"combobox":e=this.parserCombobox(b,c);break;default:d.showInfo(erajs.String.format(erajs.getMessage("framework.UNKNOW_PARSER"),a))}return e},controlBtnTrigger:function(a){var b=!1;if(a.controlTrigger){var c=a.lastTriggerTime,d=a.lastTriggerTime=new Date;if(c){var e=erajs.Date.add(c,a.intervalUnit,a.intervalValue);if(b=erajs.Date.between(d,c,e),b&&a.showTriggerWarnMsg){var f=a.triggerWarnMsg;erajs.Extra.showWarnInfo(erajs.String.format(erajs.getMessage(f)))}}}return b},parserButton:function(a,b){var c={},d=this;return a=$.extend({},d.extButtonCfg,a),c={onClick:function(){b=this;var c=d.controlBtnTrigger(a);if(1!=c){var e=a.needAuthorized;if(!e||d.returnAuth(b))switch(a.btnType){case"toolbar":d.parserToolbar(a,b);break;case"submit":d.parserSubmitBtn(a,b);break;case"cancel":d.parserCancelBtn(a,b);break;case"reset":d.parserResetBtn(a,b);break;case"base":d.parserBaseBtn(a,b);break;case"event":d.parserEventBtn(a,b);break;case"query":d.parserQueryBtn(a,b);break;case"ztree":d.parserZtreeBtn(a,b);break;case"native":d.parserNativeBtn(a,b);break;default:d.showInfo(erajs.String.format(erajs.getMessage("framework.UNREALIZE_BTN_PARSER"),a.btnType))}}}}},parserNativeBtn:function(a,b){var c=erajs.clone(a);c.handler&&c.handler.call(b)},parserBaseBtn:function(a){var b=erajs.clone(a);erajs.Extra.replaceKeys(b,{dlgh:"height",dlgw:"width",dlgtitle:"title",url:"href"}),erajs.Extra.filterDataByKey(b,["actionType","autoRefresh","btnType","isEdit","mask","maskEl","mustSelected","paramPrefix","refDgId","refFormName","singleSelect"]),erajs.Extra.openNewWindow(b)},parserSubmitBtn:function(a,b){function c(a,b){j&&(a=e.addPrefixForParam(a,j)),e.executeRequest(b,a,function(a,b,c){return d(a,b,c)})}function d(c){var d=e.executeExtraEvent(p,c);if(d===!1)return!1;if(erajs.isSuccess(c)){a.inWindow&&e.closeSelfWindow(b);var f=a.refDgId;if(f){var g=e.getDgRefFormName(f),h={};g&&(h=e.getQueryFormParams(g)),e.crudSearch(f,h)}}return!0}var e=this,f=e.getFormElement(a,b);if(!f.length)return void e.showInfo(erajs.String.format(erajs.getMessage("framework.UNFIND_MATCH_FORM"),$(b).text()));var g=a.mask,h=a.maskEl||f,i=a.maskMsg,j=a.paramPrefix;g&&erajs.Extra.showMask(h,i);var k=a.beforeValidate,l=e.executeExtraEvent(k,f,{hideMask:g,target:h});if(l!==!1)if(!e.needValidated||erajs.validateForm(f)){var m=a.url||f.attr("action"),n=a.async,o=a.multipart,p=a.callback,q=a.beforeExecute;if(o===!0){var r=e.executeExtraEvent(q,f,{hideMask:g,target:h});if(r===!1)return;return void e.executeAjaxSubmit(f,function(a,b,c){return d(a,b,c)})}var s=erajs.Extra.getFormSerializeValues(f),t=erajs.clone(s),u=e.executeExtraEvent(q,t,{hideMask:g,target:h});if(u===!1&&n)return;if(u!==!1||n)c(t,m);else{var v=a.confireMsg||"framework.CONFIRM_INFO";erajs.Messager.confirm(erajs.getMessage("framework.ALERT_TITLE_SHOW"),erajs.getMessage(v),function(a){a&&(g&&erajs.Extra.showMask(h,i),c(t,m))})}}else g&&erajs.Extra.hideMask(h)},executeAjaxSubmit:function(a,b,c){var d=this,e=d.afterReceiveAjaxResult||erajs.emptyFn;a.ajaxSubmit({dataType:"json",type:"post",timeout:d.ajaxTimeout,success:function(c,f,g){erajs.isObject(c)||(c=erajs.decode(c));var h=e(c);if(h!==!1){if(erajs.Extra.hideMask(a),c.hasOwnProperty("url")){var i=d.afterExecuteToOpenWindow(c);if(i===!1)return}if(b){var j=b(c);if(j===!1)return}d.showDefaultSuccess(c,f,g)}},error:function(b,e,f){erajs.Extra.hideMask(a),c&&c(b),d.showDefaultError(b,e,f)}})},showDefaultSuccess:function(a){var b=this,c=a.message?b.parseResultMessage(a.message):"";erajs.isSuccess(a)?(c=c||erajs.getMessage("framework.EXECUTE_SUCCESS"),erajs.Extra.showInfo(c)):(c=c||erajs.getMessage("framework.EXECUTE_FAILRE"),erajs.Extra.showWarnInfo(c))},showDefaultError:function(a){var b=this,c=a.status;"404"==c&&b.showErrorInfo(erajs.String.format(erajs.getMessage("framework.UNFIND_REQUEST_URL"),c))},parserEventBtn:erajs.emptyFn,parserCancelBtn:function(a,b){var c=this;c.closeSelfWindow(b)},getComboInitData:function(a,b,c,d,e){var f=this;f.executeRequest(a,b,function(a){var b=erajs.isSuccess(a);if(b){var g=null;return g=d?erajs.Extra.getField(a,d):a.data,e&&e(g),g&&erajs.merge(f.comboDataNodes,g),c&&f.initComboboxData(c),!1}})},getComboInitDataSync:function(a,b,c,d,e){var f=this,g={async:!1},h=null;return g=erajs.isString(a)?$.extend(g,{url:a}):$.extend(g,a),f.executeRemoteRequest(g,function(a){var e=erajs.isSuccess(a);return e?(h=c?erajs.Extra.getField(a,c):a.data,d&&d(h),h&&erajs.merge(f.comboDataNodes,h),b&&f.initComboboxData(b),!1):void 0},!1,e),h},comboDataNodes:{},initComboboxData:function(a){var b=this,c=null;if(c=erajs.isString(a)?$(a):form,c.length){var d=$(c).find('[xtype="combobox"][custom-options]');erajs.each(d,function(a){var c=a.id,d=erajs.getCmp(c);if(d){{var e=d.data,f=e.length,g=d.options,h=g.showAllOption;g.valueField}(!f||h&&1==f)&&b.setComboData(d,b.comboDataNodes)}})}},setComboData:function(a,b){var c=a.target.getAttribute("custom-options");if(!erajs.isEmpty(c)&&(c=erajs.ui.parser.getOptionsObject(c),c.hasOwnProperty("dataNode"))){var d=c.dataNode,e=erajs.Extra.getField(b,d),f=[];e&&(f=erajs.Array.clone(e)),a.loadData(f)}},insertDefaultAllOption:function(a,b,c,d,e){var f=this,g={};g[a]=d.defaultText,g[b]=d.defaultValue,g.selected=!0,erajs.localize&&e&&f.localizeProp(g,a,e),erajs.Array.insert(c,0,new Array(g))},getFormElement:function(a,b){var c=null;return a.refFormName?c=$("form[name='"+a.refFormName+"']"):(c=$(b).closest("form"),c.length||(c=$(b).parents("div.layout-panel").siblings().find("form"))),c},parserResetBtn:function(a,b){var c=this,d=c.getFormElement(a,b);d.length&&erajs.Extra.resetForm(d)},closeSelfWindow:function(a){var b=this,c=null;if(erajs.isString(a))c=a;else{var d=$(a).closest("div[class~='window-body']");d.length&&(c=d.attr("id"))}if(c)erajs.getCmp(c).destroy();else{var e=b.getIframeByElement(a);if(e&&(c=$(e).closest("div").attr("id")))try{window.parent.erajs.getCmp(c).destroy()}catch(f){}}},getIframeByElement:function(a){var b;return parent.$("iframe").each(function(){return a.ownerDocument===this.contentWindow.document&&(b=this),!b}),b},parserQueryBtn:function(a,b){var c=this,d=a.refDgId;if(!d)return void c.showWarnInfo(erajs.String.format(erajs.getMessage("framework.UNDEFINE_REFDGID"),$(b).text()));var e=c.getQueryFormParams(b),f=a.beforeExecute,g=c.executeExtraEvent(f,e);g!==!1&&c.crudSearch(d,e)},parserZtreeBtn:function(a){var b={height:a.dlgh,width:a.dlgw,title:a.dlgtitle},c=a.setting,d=a.extraOptions,e=a.showButtons,f=a.afterInitZtree;void 0!==e&&(b.showButtons=e);var g={setting:c,extraOptions:d,window:b};erajs.showZtreeWindow(g,f)},getPagingPrams:function(a){var b=this,c=a.options,d={};return d[b.pageNumber]=c.pageNumber,d[b.pageSize]=c.pageSize,d},crudSearch:function(a,b,c,d){var e=this,f=b||{};if(e.needValidated){var g=e.getDgRefFormName(a);if(!erajs.isEmpty(g)&&!erajs.validateForm(g))return}var h=e.getQmPrefix(a),i=erajs.getCmp(a);i.loading(),i.unselectAll();var j=i.getPager();j&&e.customPageParam(j,f,c,d),h&&(f=e.addPrefixForParam(f,h));var k=i.options.url;e.executeRequest(k,f,function(b){var c=erajs.isSuccess(b);if(c){if(i.loadData(b),i.loaded(),e.getBtnGridRefProp(a,"showMsg")){var d=e.getField(b,e.getBtnGridRefProp(a,"total"));if(!d){var f=e.getField(b,e.getBtnGridRefProp(a,"rows"));d=f?f.length:0}d&&e.showAutoSlideMsg(erajs.String.format(erajs.getMessage("framework.RESULT_QUERY_SUCCESS"),'<span style="color:red;">'+d+"</span>"))}return!1}i.loaded()},function(){i.loaded()})},transformDataGridData:function(a){return a},customPageParam:function(a,b,c,d){var e=this;if(a){var f=a.options;null==c&&(a.pagination({pageNumber:1}),c=1),null==d&&(d=f.pageSize),b[e.pageNumber]=c,b[e.pageSize]=d}},getField:function(a,b){if(!a||!b)return a;b=b.replace(/\[/g,".").replace(/\]/g,"");for(var c=b.split("."),d=0;d<c.length;d++){var e=c[d];if("undefined"==typeof a[e])return void 0;a=a[e]}return a},getQmPrefix:function(a){var b=this,c=b.btnGridRef.get(a);return c.queryParamPrefix||""},getDgRefFormName:function(a){var b=this,c=b.btnGridRef.get(a);return c.queryFormName||""},getQueryFormParams:function(a,b){var c=this,d={};if(a){var e=null;return(e=erajs.isString(a)?$("form[name='"+a+"']"):$(a).closest("form"))?(d=erajs.Extra.getFormSerializeValues(e),b&&(d=c.addPrefixForParam(d,b)),d):void c.showWarnInfo(erajs.String.format(erajs.getMessage("framework.UNFIND_MATCH_FORM"),$(a).text()))}},addPrefixForParam:function(a,b){if(!erajs.isEmpty(b))if(erajs.isArray(a)){var c=a;delete a,a={},a[b]=c}else erajs.Object.each(a,function(c,d){-1===c.indexOf(".")&&(a[b+"."+c]=d,delete a[c])});return a},parserToolbar:function(a,b){var c=this,d=c.getBtnId(b),e=c.checkIsSelected(a,b,d);if(e){var f=a.actionType;c.actionRegExp.exec(f)?c.executeDo(a,b):c.createWindow(a,b)}},executeExtraEvent:function(a,b,c){var d,e=!1,f=null;return c&&(c.hasOwnProperty("hideMask")&&(e=c.hideMask),c.hasOwnProperty("target")&&(f=c.target)),a&&(d=a(b)),0==d&&e&&erajs.Extra.hideMask(f),d},openNewWindow:function(a){var b=this,c=erajs.clone(a),d=c.beforeRender,e=c.openWith||"inside",f="inside",g="";if(d){var h=b.executeExtraEvent(d,a);if(h===!1)return}erajs.localize&&c.hasOwnProperty("langid")&&b.localizeProp(c,"title",c.langid);var i=e.split("-");if(2==i.length?(f=i[0],g=i[1]):f=e,!c.hasOwnProperty("contentEl")){var j=c.id||c.winId||erajs.id(null,erajs.windowId),k=c.targetScope||"body",l="inside"==f?$(k):$(k,window.parent.document);l.append('<div id="'+j+'"></div>');var m="inside"==f?$("#"+j):$("#"+j,window.parent.document);erajs.merge(c,{contentEl:m})}g&&!erajs.isEmpty(c.href)&&(c.content=b.prepareIframeHtml(c.href,c.iframeId),delete c.href),b._fitBrowserResolution(c),b.deleteExtraProps(c,["beforeRender","langid","winId","openWith","iframeId"]);var n=g?!0:!1;c=$.extend({},{iniframe:n,onLoad:function(){var a=this.target,d=b.getPageForm(a);if(d.length){if(c.hasOwnProperty("dataUrl")||c.hasOwnProperty("formDatas")){var e=c.dataUrl||c.formDatas;erajs.Extra.loadForm(d,e,{},c.editEvents,c.dataNode)}else{var f=$(a).find("input[type=hidden][name='dataUrl']").val();f&&erajs.Extra.loadForm(d,f,{},c.editEvents,c.dataNode)}b.needValidated&&c.validate&&d.length&&erajs.prepareValidateRules(d)}}},c),"inside"==f?erajs.create("window",c):window.parent.erajs.create("window",c)},windowFitBrowser:!1,_fitBrowserResolution:function(a){function b(a,b){a.height>b&&(a.height=b-100),a.maxHeight&&(a.maxHeight>b?(a.maxHeight=b,a.height=b-100):a.maxHeight>a.height&&a.maxHeight<b?(a.height=a.maxHeight,a.maxHeight=b):a.maxHeight<a.height&&(a.height=a.maxHeight)),a.minHeight&&(a.minHeight>b?a.minHeight=a.height=b-100:a.minHeight>a.height&&a.minHeight<b&&(a.height=a.minHeight))}function c(a,b){a.width>b&&(a.width=b-100),a.maxWidth&&(a.maxWidth>b?(a.maxWidth=b,a.width=b-100):a.maxWidth>a.width&&a.maxWidth<b?(a.width=a.maxWidth,a.maxWidth=b):a.maxWidth<a.width&&(a.width=a.maxWidth)),a.minWidth&&(a.minWidth>b?a.minWidth=a.width=b-100:a.minWidth>a.width&&a.minWidth<b&&(a.width=a.minWidth))}var d=this,e=a.openWith,f=a.hasOwnProperty("fitBrowser")?a.fitBrowser:d.windowFitBrowser;if(f){var g=d.getClientWidth(e),h=d.getClientHeight(e);b(a,h),c(a,g)}return a},getClientWidth:function(a){var b=0;return b=a&&"outside-iframe"==a?parent.window.innerWidth||parent.document.documentElement.clientWidth||parent.document.body.clientWidth:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},getClientHeight:function(a){var b=0;return b=a&&""==a?parent.window.innerHeight||parent.document.documentElement.clientHeight||parent.document.body.clientHeight:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},deleteExtraProps:function(a,b){erajs.isArray(b)&&erajs.Array.each(b,function(b){a.hasOwnProperty(b)&&delete a[b]})},localizeProp:function(a,b,c){if(!c)return a;var d=erajs.getMessage(c,!1);if(d){var e={};return e[b]=d,erajs.merge(a,e)}return a},createWindow:function(a,b){var c=this,d=c.makeToolbarParams(a,b),e=a.beforeRender,f=c.executeExtraEvent(e,d);if(f!==!1){var g=erajs.id(null,erajs.windowId);$("body").append('<div id="'+g+'"></div>');var h=a.dlgtitle;if(erajs.localize){var i=a.langid;if(i){var j=erajs.getMessage(i,!1);j&&(h=j)}}var k={contentEl:"#"+g,height:a.dlgh,width:a.dlgw,title:h,queryParams:d,onLoad:function(){var e=c.getPageForm(this.target);c.needValidated&&e.length&&erajs.prepareValidateRules(e);var f=a.callback;if(f){var g=f(e,d);if(g===!1)return}if(a.isEdit&&e.length){var h=a.dataUrl,i=null;if(erajs.isEmpty(h)){var j=c.getDgId(b);if(j){var k=erajs.getCmp(j);if(k){var l=k.getSelected(),m=erajs.clone(l),n=a.paramPrefix;i=n?c.addPrefixForParam(m,n):m}}}else i=h;erajs.Extra.loadForm(e,i,d,a.editEvents,a.dataNode,a.mask)}}};"inline"==a.openWith?k.href=a.url:k.content=c.prepareIframeHtml(a.url,"iframe-"+g);var l=a.winCfgs;l&&erajs.merge(k,l);{erajs.create("window",k)}}},prepareIframeHtml:function(a,b){var c=b||erajs.id(null,"erajs_iframe"),d=(new Date).getTime(),e='<div id="load_'+c+'" class="loading-icon"></div><iframe style="visibility:hidden;margin-bottom: -15px;" onreadystatechange=loadifr'+d+"_stateChangeIE(this) onload=loadifr"+d+'_stateChangeFirefox(this) name="'+c+'" id="'+c+'"  width="100%" height="100%" frameborder="0" allowTransparency="true" scrolling="0" src="'+a+'"></iframe><script> function loadifr'+d+'_stateChangeIE(_frame){if (_frame.readyState=="interactive"){$("#load_'+c+'").remove();_frame.style.visibility = "visible";}} function loadifr'+d+'_stateChangeFirefox(_frame){$("#load_'+c+'").remove();_frame.style.visibility = "visible";}</script>';return e},getPageForm:function(a){var b=null;return b=a?$(a).find("form[id],form[name]"):$("body").find("form[id],form[name]")},executeDo:function(a,b){var c=this;erajs.Messager.confirm(erajs.getMessage("framework.ALERT_TITLE_SHOW"),erajs.getMessage("framework.CONFIRM_INFO"),function(d){if(d){var e=c.makeToolbarParams(a,b),f=a.beforeExecute,g=c.executeExtraEvent(f,e);if(g===!1)return;a.mask&&erajs.Extra.showMask(a.maskEl,a.maskMsg);var h=a.callback||function(d){c.executoCallback(d,a.autoRefresh,b)};c.executeRequest(a.url,e,h)}})},executoCallback:function(a,b,c){var d=this;if(erajs.isSuccess(a)&&b){var e=d.getDgId(c);if(e){var f=d.getDgRefFormName(e),g={};f&&(g=d.getQueryFormParams(f)),d.crudSearch(e,g)}}},makeToolbarParams:function(a,b){var c=this,d=a.mustSelected,e=a.extraParams||{};if(d){var f=c.getDgId(b);if(f){var g=c.btnGridRef.get(f);if(void 0!=g){var h=g.identifyField,i=erajs.getCmp(f),j=i.getSelections(),k=a.singleSelect,l=c.getFieldValues(j,h);erajs.Object.isEmpty(e)||erajs.Array.forEach(l,function(a){erajs.merge(a,e)}),k&&(l=l[0]);var m=a.singleSelect,n=a.paramPrefix;if(n)l=c.addPrefixForParam(l,n);else if(!m){var o={};erajs.each(l,function(a){erajs.Object.each(a,function(a,b){if(o.hasOwnProperty(a))o[a].push(b);else{var c=new Array;c.push(b),o[a]=c,delete c}})}),l=o}return l}}}return e},warpReqParams:function(a,b){var c=this,d=void 0===b?c.warpReqJson:b;return d&&(a={reqJson:erajs.encode(a)}),a},getFieldValues:function(a,b){var c=this,d=erajs.isArray(b)?b:new Array(b),e=!1,f=[];return erajs.each(a,function(a){var b={};erajs.Array.each(d,function(c){a.hasOwnProperty(c)?b[c]=a[c]:e=!0}),f.push(b)}),e&&c.showWarnInfo(erajs.String.format(erajs.getMessage("framework.UNFIND_DATA_FIELD"),d)),f},executeRequest:function(a,b,c,d,e,f){var g=this,f=void 0===f?!0:f;e=e||"json";var h=g.afterReceiveAjaxResult||erajs.emptyFn;$.ajax({url:a,type:"post",timeout:g.ajaxTimeout,traditional:!0,dataType:e,data:f?g.warpReqParams(b,f):b,success:function(a,i,j){erajs.isObject(a)||(a=erajs.decode(a));var k=h(a);if(k!==!1){if(a.hasOwnProperty("redirect"))return void g.executeRequest.call(g,a.redirect,b,c,d,e,f);if(erajs.Extra.hideMask(),a.hasOwnProperty("url")){var l=g.afterExecuteToOpenWindow(a);if(l===!1)return}if(c){var m=c(a);if(m===!1)return}g.showDefaultSuccess(a,i,j)}},error:function(a,b,c){erajs.Extra.hideMask(),d&&d(status),g.showDefaultError(a,b,c)}})},executeRemoteRequest:function(a,b,c,d,e){var f=this,d=void 0===d?f.warpReqJson:d,g=void 0===c?!0:c,h=a.data,i=f.afterReceiveAjaxResult||erajs.emptyFn;$.ajax($.extend({},{method:"post",timeout:f.ajaxTimeout,traditional:!0,dataType:"json",success:function(a,c,d){erajs.isObject(a)||(a=erajs.decode(a));var e=i(a);if(e!==!1){if(erajs.Extra.hideMask(),a.hasOwnProperty("url")){var h=f.afterExecuteToOpenWindow(a);if(h===!1)return}if(b){var j=b(a);if(j===!1)return}g&&f.showDefaultSuccess(a,c,d)}},error:function(a,b,c){erajs.Extra.hideMask(),e&&e(status),f.showDefaultError(a,b,c)}},a,{data:h?f.warpReqParams(h,d):{}}))},afterReceiveAjaxResult:function(){return!0},afterExecuteToOpenWindow:function(a){var b=erajs.JSON.decode(a.windowParam||"{}"),c=a.url,d="",e=erajs.String.startsWith(c,"!");e&&(c=c.substr(1));var f=erajs.Extra.getField(a,"data.result");erajs.isArray(f)&&f.length&&(f=f[0]);var g=erajs.lastWindow;return!e&&g&&(d=g.id,d&&erajs.isInstantiate(d)&&erajs.getCmp(d).destroy()),erajs.Extra.openNewWindow(erajs.merge({width:370,height:400,winId:e?erajs.id(null,erajs.windowId):d,href:c,formDatas:f},b)),!1},parseResultMessage:function(a){if(!a)return"";var b=this,c=a.split("|@|"),d=a,e=!1;return c.length>1&&(e=!0,d=c[0]),a=erajs.getMessage(d),e&&a!==d&&(a=b.format(a,erajs.Array.slice(c,1))),a},format:function(a,b){var c=b,d=/\{(\d+)\}/g;return a.replace(d,function(a,b){return c[b]})},parserDatagrid:function(a,b){var c=this,d={},e=[];a=$.extend({},c.extDatagridCfg,a);var f=a.queryParamPrefix,g=b.id;return c.btnGridRef.add(g,{identifyField:a.identifyField,queryParamPrefix:f,queryFormName:a.queryFormName,toolbars:[],transformKeyMap:a.transformKeyMap||{},showMsg:a.showMsg,rows:a.rows,total:a.total}),a.grid2excel&&e.push({iconCls:"icon-xls",tipsy:{gravity:"s",fallback:"导出当前页",langid:"framework.toolTips.GRID2EXCEL"},handler:function(){c.exportExcel(g,a.exportUrl,!0)}}),a.exportAll2excel&&e.push({iconCls:"icon-down",tipsy:{gravity:"s",fallback:"导出全部",langid:"framework.toolTips.EXPORTALL2EXCEL"},handler:function(){c.exportExcel(g,a.exportUrl,!1)}}),d={onBeforeLoad:function(b){var d=c.getQueryFormParams(a.queryFormName,f);$.extend(b,d),b.hasOwnProperty("page")&&(b[f?f+"."+c.pageNumber:c.pageNumber]=b.page,delete b.page),b.hasOwnProperty("rows")&&(b[f?f+"."+c.pageSize:c.pageSize]=b.rows,delete b.rows),c.warpReqJson&&(erajs.Object.merge(b,c.warpReqParams(b)),erajs.Object.each(b,function(a){"reqJson"!==a&&delete b[a]}))},pagingButtons:e}},exportExcel:function(a,b,c){var d=this,e=d.btnGridRef.get(a),f=e.queryFormName,g=e.queryParamPrefix;d.exportGrid2excel(b,a,c,f,g)},exportGrid2excel:function(a,b,c,d,e){var f=this,g={},h={},i={};if(c){var j=erajs.getCmp(b);if(j){var k=j.getPager();k&&(g=f.getPagingPrams(k))}}g.pageCtrl=c,d&&(h=f.getQueryFormParams(d)),i=erajs.Object.merge(h,g),e&&(i=f.addPrefixForParam(i,e));var l=erajs.Object.toQueryString(i);a=erajs.String.urlAppend(a,l),location.href=a},parserCombobox:function(a){function b(b,d,e){var f=d.options,g=a.reqParam||b.options.valueField,h=a.refUrl||f.url;c(d),d.enable();var i={};i[g]=e,erajs.Extra.executeRequest(h,i,function(a){return d.loadData(a),!1})}function c(a){var b=(a.options,a.disabled);a.clear(),b||a.disable(),a.loadData([]);var d=a.target.getAttribute("custom-options");if(!erajs.isEmpty(d)&&(d=erajs.ui.parser.getOptionsObject(d),d.hasOwnProperty("refCombo"))){var e=erajs.getCmp(d.refCombo);e&&c(e)}}var d={},e=this,a=$.extend({},e.extCombobox,a),f=a.dataNode,g=a.refCombo;return erajs.merge(d,{showAllOption:a.showAllOption,data:f?e.parserDataNode(f):[],loadFilter:function(b){return e.loadComboFilter(this,b,f,erajs.clone(a))}}),g&&erajs.merge(d,{onChange:function(a){var c=this,d=erajs.getCmp(g);d&&b(c,d,a)}}),d},loadComboFilter:function(a,b,c,d){var e=[],f=this,g=d.langid,h=d.showAllOption;if(erajs.isArray(b)&&(e=b),b&&erajs.isEmpty(e)){var i=erajs.Extra.getField(b,c);erajs.isEmpty(i)||(e=i)}if(h){var j=a.options;f.insertDefaultAllOption(j.textField,j.valueField,e,{defaultText:d.defaultText,defaultValue:d.defaultValue},g)}return e},parserDataNode:function(a){var b=this,c=[],d=erajs.Extra.getField(b.comboDataNodes,a);return d&&(c=erajs.Array.clone(d)),c},parserPanel:function(a,b){var c=this,d=a.treeid||erajs.id(null,"ztree"),e=$(b).find("ul.ztree");e.length||$(b).append(c.ztreeConfigs.ztreePanelContent(d));var f=a.afterInitZtree;erajs.framework.LogicWarpper.initZtree("#"+d,{setting:a.setting,extraOptions:a.extraOptions},f)},getBtnGridRefProp:function(a,b){var c=this,d=c.btnGridRef.get(a);return d&&d.hasOwnProperty(b)?d[b]:null},returnAuth:function(){return!0},checkIsSelected:function(a,b,c){var d=this,e=a.mustSelected,f=a.singleSelect;if(!e)return!0;var g=d.getDgId(b,c);if(g){var h=erajs.getCmp(g);if(h){var i=h.getSelections(),j=i.length;if(j)return f&&j>1?(d.showWarnInfo(erajs.getMessage("framework.ONLY_SELECT_ONE_ROW")),!1):!0;d.showWarnInfo(erajs.getMessage("framework.UNSELECT_LESS_ONE_ROW"))}}return!1},getDgId:function(a,b){var c=this;b||(b=c.getBtnId(a));var d=c.isExistRef(b);return d||c.getBtnBelongDgId(a,b)},isExistRef:function(a){var b=this,c=null;return b.btnGridRef.each(function(b,d){erajs.each(d,function(d){var e=d.toolbars;return erajs.Array.contains(e,a)?(c=b,!1):void 0})}),c},getBtnBelongDgId:function(a,b){var c=this,d=$(a).closest(".datagrid-wrap");if(d.length){var e=d.attr("id");if(e){var f=c.btnGridRef.get(e),g=f.toolbars;return erajs.Array.contains(g,b)||g.push(b),e}c.showWarnInfo(erajs.getMessage("framework.UNDEFINE_ID_PROPERTY"))}else{var h=$(a).text();c.showWarnInfo(erajs.String.format(erajs.getMessage("framework.UNFIND_BELONGS_DATAGRID"),h))}return null},getBtnId:function(a){var b=this,c=$(a).attr("id");return c?c:(b.showWarnInfo(erajs.String.format(erajs.getMessage("framework.UNDEFINE_ID_PROPERTY"),$(a).text())),null)},showAlertInfo:function(a,b,c){erajs.Messager.alert(a,b,c)},showWarnInfo:function(a){var b=this;b.showAlertInfo(erajs.getMessage("framework.ALERT_TITLE_WARNING"),a,"warning")},showInfo:function(a){var b=this;b.showAlertInfo(erajs.getMessage("framework.ALERT_TITLE_SHOW"),a,"info")},showErrorInfo:function(a){var b=this;b.showAlertInfo(erajs.getMessage("framework.ALERT_TITLE_ERROR"),a,"error")},showAutoSlideMsg:function(a,b,c){var b=b||erajs.getMessage("framework.ALERT_TITLE_SHOW"),c=c||5e3;erajs.Messager.show({title:b,msg:a,timeout:c,showType:"slide"})}},c=erajs.Extra={clearForm:function(a,b,c,d){var c=void 0!=c?c:!0,d=void 0!=d?d:!0,e=$(a);e.clearForm(b,c,d),$("[xtype]",e).each(function(){var a=this.id;if(a){var b=erajs.getCmp(a),e=b.xtype;if("button"==e)return;var f=b.options,g=f.readonly,h=f.disabled;if(f&&(!c&&(g||"numberbox"==e&&$(b.target).hasClass("eraui-readonly"))||!d&&h))return;try{b.clear()}catch(i){}}})},resetForm:function(a){var b=$(a),c=b.formFields();erajs.isEmpty(c)||(b.resetForm(),erajs.Array.forEach(c,function(a){var b=erajs.isInstantiate(a);if(b){var c=erajs.getCmp(a);try{c.reset()}catch(d){}}}))},enableForm:function(a,b){var c=this,d=$(a),e=d.formFields(!1);erajs.isEmpty(e)||c.enableFields(e,b)},readonlyForm:function(a,b){var c=this,d=$(a),e=d.formFields(!0);erajs.isEmpty(e)||c.readonlyFields(e,b)},enableFields:function(a,b){var c=[];if(void 0===b&&(b=!0),erajs.isString(a))c=a.split(",");else{if(!erajs.isArray(a))return void erajs.Extra.showWarnInfo(erajs.String.format("Currently does not support {0} type param,please check it."),typeof a);c=a}erajs.Array.forEach(c,function(a){var c=erajs.isInstantiate(a);if(c){var d=erajs.getCmp(a);try{b?d.enable():d.disable()}catch(e){erajs.debug&&erajs.Extra.showErrorInfo(d.xtype+" Exception infomation："+e)}}else{var f="#"+a+",[name='"+a+"']";$(f).enable(b)}})},readonlyFields:function(a,b){var c=[];if(void 0===b&&(b=!0),erajs.isString(a))c=a.split(",");else{if(!erajs.isArray(a))return void erajs.Extra.showWarnInfo(erajs.String.format("Currently does not support {0} type param,please check it."),typeof a);c=a}erajs.Array.forEach(c,function(a){var c=erajs.isInstantiate(a);if(c){var d=erajs.getCmp(a),e=d.xtype;if("numberbox"!=e){try{d.readonly(b)}catch(f){}return}}$("#"+a+",[name="+a+"]").readonly(b)})},formatDate:function(a,b,c){return a?(erajs.isDate(a)||(a=erajs.Date.parse(a,b)),erajs.Date.format(a,c||erajs.Date.defaultFormat)):""},formatMilliDate:function(a,b){return a?(erajs.isDate(a)||(a=new Date(a)),erajs.Date.dateFormat(a,b||erajs.Date.patterns.ISO8601Long)):""},dateRenderer:function(a,b,d){return c.formatDate(a,b||"Ymd",d||erajs.Date.patterns.ISO8601Short)},timeRenderer:function(a,b,d){return c.formatDate(a,b||"His",d||"H:i:s")},dateTimeRenderer:function(a,b,d){return c.formatDate(a,b||"YmdHis",d||erajs.Date.patterns.ISO8601Long)},getBaseURL:function(){var a=window.document.location,b=a.href,c=a.pathname,d=b.indexOf(c),e=b.substring(0,d),f=c.substring(0,c.substr(1).indexOf("/")+1);return e+f+"/"},getUrlVars:function(){var a=window.location.href,b=a.slice(a.indexOf("?")+1);return erajs.Object.fromQueryString(b,!0)},templateToHTML:function(a,b){return b=b||{},template(a,b)},findObjectBy:function(a,b,c){if(erajs.isEmpty(b))return{};var d={};return erajs.isObject(a)&&erajs.Object.each(a,function(e,f){erajs.Array.contains(b,e)&&(d[e]=f,c&&delete a[e])}),d},showMask:function(a,b){var c=erajs.getMessage(b?b:"framework.IN_PROCESSING"),d=$(a?a:"body");if(!d.children("div.erajs-mask").length){var e=$('<div class="erajs-mask" style="display:block"></div>').appendTo(d),f=$('<div class="erajs-mask-msg" style="display:block;left:50%"></div>').html(c).appendTo(d);
e.css({zIndex:erajs.zIndex++}),f._outerHeight(40),f.css({marginLeft:-f.outerWidth()/2,lineHeight:f.height()+"px",zIndex:erajs.zIndex++})}},hideMask:function(a){var b=a||$("body");a&&erajs.isString(a)&&(b=$(a)),$(b).find("div.erajs-mask-msg").remove(),$(b).find("div.erajs-mask").remove()}};erajs.apply(c,{closeSelfWindow:a(b,"closeSelfWindow"),crudSearch:a(b,"crudSearch"),getQueryFormParams:a(b,"getQueryFormParams"),addPrefixForParam:a(b,"addPrefixForParam"),createWindow:a(b,"createWindow"),openNewWindow:a(b,"openNewWindow"),executeRequest:a(b,"executeRequest"),executeRemoteRequest:a(b,"executeRemoteRequest"),returnAuth:a(b,"returnAuth"),showAlertInfo:a(b,"showAlertInfo"),showWarnInfo:a(b,"showWarnInfo"),showInfo:a(b,"showInfo"),showErrorInfo:a(b,"showErrorInfo"),showAutoSlideMsg:a(b,"showAutoSlideMsg"),toDataObjects:function(a,b,d){var e,f,g=c.toDataObjects,h={};if(erajs.isArray(a)&&!erajs.isPrimitiveArray(a))for(e=0,f=a.length;f>e;e++)b?erajs.Object.merge(h,g(a[e],!0)):h[d]=a[e];else if(erajs.isObject(a))for(e in a)a.hasOwnProperty(e)&&(b?erajs.Object.merge(h,g(a[e],!0,(d?d+".":"")+e)):h[d]=a[e]);else h[d]=a;return h},replaceKeys:function(a,b,c,d){var e=this,c=void 0!=c?c:!1;d=void 0!=d?d:!0,erajs.isEmpty(a)||erajs.isEmpty(b)||(erajs.isObject(a)&&erajs.Object.each(a,function(f,g){if(b.hasOwnProperty(f)){var h=b[f];erajs.isEmpty(h)||(a[h]=g,d&&delete a[f])}c&&e.replaceKeys(g,b,c,d)}),erajs.isArray(a)&&erajs.Array.each(a,function(a){e.replaceKeys(a,b,c,d)}))},formDataIdentify:"originalData",isBindOriginalData:!0,defaultTipsyCfg:{opacity:.95,html:!0,gravity:$.fn.tipsy.autoNS},formKeywords:["dataUrl"],showTipsy:function(a,b){var c=this,d=c.defaultTipsyCfg,e=b||{};e=$.extend({},d,e),$(a).tipsy(e)},getFormSerializeValues:function(a,b,c){var d=this,e=a,f=c&&erajs.isArray(c)?erajs.Array.union(d.formKeywords,c):d.formKeywords;erajs.isString(a)&&(e=$(a));var g=d.trimSerialize(e.serialize()),h=erajs.Object.fromQueryString(g);d._mergeFormSpecialUiValues(e,h),d.filterDataByKey(h,f,!1);var i=d.getBindDatas(e);return i&&(h=erajs.merge(i,h)),b&&d.addPrefixForParam(h,b),h},_mergeFormSpecialUiValues:function(a,b){var c={},d=a.find("[xtype^=combo]");d.each(function(){var a=this.id;if(erajs.isInstantiate(a)){var b=erajs.getCmp(a);if(b){var d=b.options;if(d&&d.multiple)try{c[d.name]=b.getValues()}catch(e){}}}}),erajs.Object.isEmpty(c)||erajs.merge(b,c)},filterDataByKey:function(a,b,c){var d=this;erajs.isEmpty(b)||(erajs.isObject(a)&&erajs.Object.each(a,function(e,f){erajs.Array.contains(b,e)?delete a[e]:(erajs.isObject(f)||erajs.isArray(f))&&c&&d.filterDataByKey(f,b,c)}),erajs.isArray(a)&&erajs.Array.each(a,function(a){d.filterDataByKey(a,b,c)}))},trimSerialize:function(a){return a.replace(/\+/g," ")},setBindDatas:function(a,b,c){var d=this,e=$(a),f=void 0!=c?c:!1;if(!e.length)return void erajs.Extra.showWarnInfo(erajs.String.format(erajs.getMessage("framework.UNDEFINE_ID_PROPERTY"),a));if(f){var g=d.getBindDatas(e);g&&(b=erajs.merge(g,b))}e.data(d.formDataIdentify,b)},getBindDatas:function(a){var b=this,c=$(a);return c.length?c.data(b.formDataIdentify):(erajs.Extra.showWarnInfo(erajs.String.format(erajs.getMessage("framework.UNDEFINE_ID_PROPERTY"),a)),null)},loadForm:function(a,b,c,d,e,f,g){var h=this,c=c||{},d=d||{},i=d.onBeforeLoad||erajs.emptyFn,j=d.onLoadSuccess||erajs.emptyFn,k=d.onLoadError||erajs.emptyFn,l=d.onLoadFailure||erajs.emptyFn,m=d.onAfterLoad||erajs.emptyFn,n=$(a);return n.length?void(0!=i.call(h,c,b)&&(f&&erajs.Extra.showMask(n,"framework.IN_INIT_DATA"),"string"==typeof b?erajs.Extra.executeRequest(b,c,function(a){if(!erajs.isObject(a)){var c=erajs.getMessage("framework.RESULT_IS_NOT_OBJECT");return void erajs.Extra.showWarnInfo(c)}b={};var d={};return e?b=h.getField(a,e):a.hasOwnProperty("data")&&(b=a.data),b?(d=b,b=erajs.toDataObjects(b,!0)):b={},erajs.isSuccess(a)?(h.isBindOriginalData&&h.setBindDatas(n,b,g),0==j.call(h,b,d)?!1:(n.setValues(b),m&&m(b,d),!1)):0==l.call(h,a)?!1:void 0},k):(e&&(b=h.getField(b,e)),n.setValues(b),erajs.Extra.hideMask(n),h.isBindOriginalData&&h.setBindDatas(n,b,g),m&&m(b)))):void(erajs.debug&&erajs.Extra.showWarnInfo(erajs.String.format(erajs.getMessage("framework.UNFIND_MATCH_FORM_BY_TARGET"),a)))},warpReqParams:a(b,"warpReqParams"),getField:a(b,"getField"),getComboInitDataSync:a(b,"getComboInitDataSync"),getComboInitData:a(b,"getComboInitData"),initComboboxData:a(b,"initComboboxData"),transDgColumnsByField:function(a,b){if(!erajs.isEmpty(b)){var c=erajs.getMessage(b,!1);return c?void erajs.Array.each(a,function(a){var b=a.field;c.hasOwnProperty(b)&&(a.title=c[b])}):void erajs.Extra.showWarnInfo(erajs.String.format("not find the node path ('{0}') define in 'erajs.Messager.message' object.",b))}}}),erajs.apply(erajs.Messager,{message:{},getMessage:function(a,b){var c=this.message,d=void 0!==b?b:!0,e=c[a];return e||(e=erajs.Extra.getField(c,a)),1==d?e||a:e}}),erajs.apply(erajs,{formUiXtypes:["textbox","numberbox","slider","timespinner","numberspinner","combobox","combotree","combogrid","datetimebox","datebox","combo"],isSuccess:function(a){return a.success},parserCustomOptions:a(b,"parserCustomOptions"),baseURL:a(c,"getBaseURL"),onReady:a(b,"onReady"),getMessage:a(erajs.Messager,"getMessage"),parseResultMessage:a(b,"parseResultMessage"),toDataObjects:a(c,"toDataObjects"),loadForm:a(c,"loadForm"),dateRenderer:a(c,"dateRenderer"),timeRenderer:a(c,"timeRenderer"),dateTimeRenderer:a(c,"dateTimeRenderer"),showEvents:function(a){var b=a||{};erajs.Extra.openNewWindow($.extend({},{height:330,width:830,title:erajs.getMessage("framework.WINDOW_TITLE_EVENT")},b))}})}(erajs.Function.alias),function(a){var b=erajs.framework.Events={taskGridId:"todoTaskDg",curEventHandleWinId:"",eventMessenger:null,projectName:"",taskWinOpenWith:"outside-iframe",eHandlePagePath:"templates/html/eventHandleDialog.html",warpReqJson:!1,needRestEvent:!0,eventsCfg:{defaultTimeout:300,barVisible:!0},Urls:{getEventCount:"../../getEventCount.action",getEvents:"../../getEvents.action",prepareEvent:"../../updatePrepare.action",resetEvent:"../../updateReset.action",bizObjByEvent:"../../getBizObj.action"},eventRefreshPeriod:5e5,eventKeys:["barVisible","buttons","extraParam","stateParam","readonly","remain","href","controlBtnShow","maxHeight","minHeight","maxWidth","minWidth"],parseEventWinOpts:function(a){var c=this,d=erajs.decode(a.expression),e=c.curEventHandleWinId=a.processId,f=erajs.String.urlAppend(d.open,"id="+a.id),g={winId:e,title:d.title||"",width:d.width||500,height:d.height||300,langid:d.langid||"",maximizable:d.maximizable||!1,controlBtnShow:d.controlBtnShow||!1,href:f,barVisible:void 0!=d.barVisible?d.barVisible:c.eventsCfg.barVisible,readonly:!1,buttons:[]};if(0==a.done){if(a.validSecond>0){g.barVisible=!0;var h=(new Date).getTime(),i=h-(a.date-a.startDate),j=Number(((h-i)/1e3).toFixed(0)),k=a.validSecond-j,l=a.openSecond,m=c.eventsCfg.defaultTimeout;k>(l?l:m)&&(k=l?l:m),g.remain=k}else g.remain=a.openSecond||c.eventsCfg.defaultTimeout;g.remain<0&&(g.barVisible=!1);var n=erajs.getMessage("framework.eventsCfg.eventHandleBtns");erajs.each(n,function(a){var b=!0;a.hasOwnProperty("skipValidate")&&(b=a.skipValidate);for(var c in d)if(a.type===c){a.url=d[c],a.skipValidate=b,a.eventType=a.type,g.buttons.push(a);break}})}else g.href=erajs.String.urlAppend(f,"domReadonly=true"),g.readonly=!0,b.needRestEvent=!1;var o=g.href.substring(g.href.indexOf("?")+1);return g.extraParam=o,g.stateParam=erajs.Object.toQueryString({controlBtnShow:g.controlBtnShow,readonly:g.readonly,barVisible:g.barVisible}),g},prepareEvent:function(a,b){var c=this;c.curEventRow=b,erajs.Extra.showMask("body","framework.IN_OPENG_WINDOWN"),erajs.Extra.executeRequest(c.Urls.prepareEvent,{id:b.id},function(a){if(erajs.isSuccess(a)){var b=a.data.event,d=c.parseEventWinOpts(b);return c.openEventHandleDialog(d),!1}erajs.Extra.hideMask("body")})},openEventHandleDialog:function(a){var b=this,c=b.eventKeys,d=erajs.Extra.getBaseURL(),e=erajs.Extra.findObjectBy(a,c,!0);$.extend(e,{tasksIframeId:window.name});var f=erajs.Object.toQueryString(e,!0),g=erajs.String.urlAppend(d+b.eHandlePagePath,f);erajs.Extra.openNewWindow($.extend(a,{openWith:b.taskWinOpenWith,href:g,onDestroy:function(){b.needRestEvent?b.resetEvent():b.needRestEvent=!0}}))},resetEvent:function(){var a=this,b=a.curEventRow;if(b){var c=b.id;c&&erajs.Extra.executeRequest(a.Urls.resetEvent,{id:c},function(a){return erajs.isSuccess(a)?!1:void 0})}},eventFormParamKey:"stateParam",loadEventHandleData:function(){var a=this,b=arguments[0],c=arguments[1],d=arguments.length,e={};3==d&&(e=erajs.urlDecode(arguments[2]));var f=$(b.target).find("form");if(f.length){f.data(a.eventFormParamKey,e);var g=erajs.urlDecode(c),h=a.getFormDataOptions(f),i=h.onLoadSuccess||erajs.emptyFn,j={onBeforeLoad:h.onBeforeLoad||erajs.emptyFn,onLoadSuccess:function(a,b){return erajs.Object.merge(a,g),i?i(a,b,e):void 0},onLoadError:h.onLoadError||erajs.emptyFn,onAfterLoad:h.onAfterLoad||erajs.emptyFn},k=void 0!=h.showMask?h.showMask:!0;erajs.loadForm(f,a.Urls.bizObjByEvent,g,j,h.dataNode,k),"true"==g.domReadonly&&erajs.Extra.enableForm(f,!1)}},reloadEeventList:function(){var a=b.taskGridId;a&&erajs.Extra.crudSearch(a,{})},formatDone:function(a){var b=erajs.getMessage("framework.eventsCfg.eventStates"),c=b[a];return c?c:"-"},formatEventDate:function(a,b){var c=b||"H:i:s";return erajs.isEmpty(a)?"":erajs.Date.format(new Date(parseInt(a)),c)},getFormDataOptions:function(a){var b={},c=a.attr("data-options");return c&&(b=erajs.decode(erajs.encodeToJsonStr(c))),b},loadEventDataFilter:function(a){var b=erajs.isSuccess(a);if(!b)return erajs.Extra.showErrorInfo(a.message),{total:0,rows:[]};var c=a.data;return{total:c.event.total,rows:c.event.datals}},getProjectName:function(){var a=this,b=a.projectName;if(!b){var c=erajs.Extra.getBaseURL(),d=c.split("/");b=d[d.length-2]}return b},showEvents:function(a){var b=a||{};erajs.Extra.openNewWindow($.extend({},{height:450,width:830,openWith:"inside-iframe",href:erajs.Extra.getBaseURL()+"templates/html/flowEvent.html",title:erajs.getMessage("framework.WINDOW_TITLE_EVENT")},b))}};erajs.override(erajs.framework.LogicWarpper,{parserEventBtn:function(a,c){var d=this,e=a.skipValidate,f=a.eventType,g=void 0!=a.showMask?a.showMask:!0,h=d.getFormElement(a,c);if(!h.length)return void d.showInfo(erajs.String.format(erajs.getMessage("framework.UNFIND_MATCH_FORM"),$(c).text()));if(erajs.isFormSetValue)return void erajs.Extra.showAutoSlideMsg(erajs.getMessage("framework.IN_INIT_DATA"));var i=$(c).closest("div.layout")||h;g&&erajs.Extra.showMask(i);var j=b.getFormDataOptions(h),k=erajs.emptyFn,l=erajs.emptyFn;if(j&&j.hasOwnProperty(f)){var m=j[f];m.hasOwnProperty("beforeValidate")&&(k=m.beforeValidate),m.hasOwnProperty("beforeExecute")&&(l=m.beforeExecute)}var n=d.needValidated,o=n&&"true"!==e;if(o){var p=d.executeExtraEvent(k,h,{hideMask:g,target:i});if(p===!1)return}!o||erajs.validateForm(h)?erajs.Messager.confirm(erajs.getMessage("framework.ALERT_TITLE_SHOW"),erajs.getMessage("framework.CONFIRM_IS_CONTINUE"),function(c){if(c){var e=a.url||h.attr("action"),f=erajs.Extra.getFormSerializeValues(h),j=erajs.clone(f);b.warpReqJson&&(j=erajs.Extra.warpReqParams(j));var k=d.executeExtraEvent(l,j,{hideMask:g,target:i});if(k===!1)return;erajs.Extra.executeRequest(e,j,function(b){if(erajs.isSuccess(b)){var c=a.callback||erajs.emptyFn;return d.executeExtraEvent(c,b,{hideMask:g,target:i}),!1}})}else g&&erajs.Extra.hideMask(i)}):g&&erajs.Extra.hideMask(i)}}),erajs.apply(erajs,{prepareEvent:a(b,"prepareEvent"),showEvents:a(b,"showEvents"),formatDone:a(b,"formatDone"),formatEventDate:a(b,"formatEventDate"),loadEventHandleData:a(b,"loadEventHandleData"),loadEventDataFilter:a(b,"loadEventDataFilter"),getProjectName:a(b,"getProjectName"),sendMessage:function(a,b,c){a.targets[b].send(c)}})}(erajs.Function.alias),function(a){erajs.apply(erajs.framework.LogicWarpper,{ztreeConfigs:{ztreeContent:function(a,b){var c='<div xtype="layout" fit="true">';return c+='<div region="center" style="padding-top:5px;">',c+='<ul id="'+a+'" class="ztree" style="margin-top:0;margin-left:10px;height:auto;"></ul>',c+="</div>",b&&(c+='<div region="south" border="false" class="form-foot-btns">',c+='<div id="'+a+'-submit" xtype="button" class="middleBtn" iconCls="icon-save"></div>',c+='<div xtype="button" class="middleBtn" iconCls="icon-cancel" style="margin-left:5px;" custom-options=" btnType:\'cancel\'"></div>',c+="</div>"),c+="</div>"},ztreePanelContent:function(a){var b='<ul id="'+a+'" class="ztree"  style="margin-top:0;height:auto;"></ul>';return b}},parseExtraOptions:function(a,b){var c={};if(a&&a.hasOwnProperty("filterFields")&&(c=a.filterFields,c.hasOwnProperty("id"))){var d="id="+c.id;erajs.merge(b,{async:{autoParam:[d]}})}return c},getZtreeNodes:function(a){var b={};if(a){var c=a.getSelectedNodes(),d=[],e=[];erajs.each(c,function(a){e.push(a.id),d.push(a.name)}),b={text:d.join(","),value:e.join(",")}}return b},initZtree:function(a,b,c){var d=this,e=null,f=(d.ztreeConfigs,{async:{enable:!0}}),g={rows:"data.result"},h=b.setting,i=b.extraOptions,j={};j=d.parseExtraOptions(i,f),i=erajs.merge(g,i),f=erajs.merge(f,{async:{dataFilter:function(a,b,c){function d(a){erajs.each(a,function(a){erajs.Object.each(j,function(b,c){a.hasOwnProperty(c)&&(a[b]=a[c],delete a[c])});var b=a.isParent;erajs.isBoolean(b)||(b="1"===b?!0:!1,a.isParent=b),a.hasOwnProperty("children")&&d(a.children)})}if(!c)return null;var e=null;if(erajs.isArray(c))e=c;else if(c.hasOwnProperty("success")){var f=erajs.isSuccess(c);if(!f)return null;var g=i.rows;e=erajs.framework.LogicWarpper.getField(c,g)}return d(e),e}}}),erajs.merge(f,h),e=$.fn.zTree.init($(a),f),c&&c(e)},showZtreeWindow:function(a,b){var c=this,d="ztree",e=c.ztreeConfigs,f={height:350,width:300,showButtons:!0},g=a.window,h=a.setting,i=a.extraOptions,j=a.submitFnc;erajs.merge(f,g);var k=f.showButtons,l=erajs.id(null,d),m=e.ztreeContent(l,k),n=erajs.id(null,erajs.windowId);$("body").append('<div id="'+n+'"></div>'),erajs.create("window",erajs.merge(f,{contentEl:"#"+n,content:m})),c.initZtree("#"+l,{setting:h,extraOptions:i},function(a){if(b&&b(a),k){var d=l+"-submit";$("#"+d).click(function(){if(i.hasOwnProperty("valueField")){var b=c.getZtreeNodes(a);$(i.valueField).val(b.value),i.hasOwnProperty("textField")&&$(i.textField).val(b.text)}j&&j(a),erajs.Extra.closeSelfWindow(n)})}})}}),erajs.apply(erajs,{showZtreeWindow:a(erajs.framework.LogicWarpper,"showZtreeWindow"),initZtree:a(erajs.framework.LogicWarpper,"initZtree")})}(erajs.Function.alias),function(){erajs.apply(erajs.Extra,{spanFormatters:{currency:{name:"currency",options:{sign:erajs.util.Format.currencySign,decimals:erajs.util.Format.currencyPrecision,end:erajs.util.Format.currencyAtEnd},handle:function(a){var b=this,c=a,d=erajs.clone(b.options);return erajs.isObject(a)&&(d=$.extend(!0,d,a),c=d.value),erajs.util.Format.currency(c,d.sign,d.decimals,d.end)}},combobox:{name:"combobox",options:{textField:"text",valueField:"value",dataNode:"",data:[],separator:",",multiple:!1},handle:function(a){var b=this,c=a,d=erajs.clone(b.options),e=[],f=[],g=[];erajs.isObject(a)&&(d=$.extend(!0,d,a),c=d.value);var h=d.textField,i=d.valueField,j=d.multiple;if(j&&(erajs.isArray(c)||(c=String(c),c=c.indexOf(",")>-1?c.split(","):[c])),d.data&&(e="function"!=typeof d.data?d.data:d.data()),d.dataNode){var k=erajs.framework.LogicWarpper.comboDataNodes,l=erajs.Extra.getField(k,d.dataNode);l&&l.length&&(e=l)}return e.length&&(f=erajs.Array.filter(e,function(a){var b=String(a[i]);if(j){if(erajs.Array.contains(c,b))return!0}else if(b==c)return!0})),g=erajs.Array.map(f,function(a){return a[h]}),0==g.length?c:g.join(d.separator)}},datetime:{name:"datetime",options:{fromFormat:"Ymd",toFormat:erajs.Date.patterns.ISO8601Short},handle:function(a){var b=this,c=a,d=erajs.clone(b.options);return erajs.isObject(a)&&(d=$.extend(!0,d,a),c=d.value),erajs.Extra.formatDate(c,d.fromFormat,d.toFormat)}}},registerFormatter:function(a,b){var c=this,d=c.spanFormatters;return d[a]=b,d[a]},executeFormatter:function(a){var b=erajs.Array.slice(arguments,1),c=this.spanFormatters,d=c[a],e=d.handle,f=erajs.Function.pass(e,b,d);return f()}})}(erajs.Function.alias),function(a){var b=erajs.framework.Validator={validationPath:"../validation/validation.xml",cacheValidateFile:!0,showAllInvalidTip:!1,validateDefaultTipCfg:{},formValidationCfgs:[],formValidationOptions:new erajs.util.HashMap,ruleTypeList:{required:"boolean",email:"boolean",url:"boolean",date:"boolean",dateISO:"boolean",number:"boolean",digits:"boolean",creditcard:"boolean",idcard:"boolean",cellphone:"boolean",fax:"boolean",telephone:"boolean",zipcode:"boolean",time:"boolean",time12h:"boolean",maxlength:"number",minlength:"number",max:"number",min:"number",rangelength:"array",range:"array",byterangelength:"array"},loadValidationXml:function(a){var b=this,c=b.cacheValidateFile,a=a||b.validationPath;$.ajax({url:a,dataType:"xml",type:"GET",async:!1,cache:c,timeout:2e3,error:function(){erajs.Extra.showErrorInfo(erajs.String.format(erajs.getMessage("framework.ERROR_LOAD_XML"),a))},success:function(a){var c=$.xml2json(a),d=c.validation;d&&(b.formValidationCfgs=erajs.isArray(d)?d:new Array(d))}})},prepareValidateRules:function(a){function b(a,b){var d={};d=c.getFormValidateRules(a),b.validate(d)}var c=this,d="";erajs.isString(a)?(d=a,a=$("form[name='"+a+"']"),b(d,a)):erajs.each(a,function(a){var c=$(a);d=c.attr("name")||c.attr("id"),b(d,c)})},removeFieldRules:function(a,b){if(!erajs.isEmpty(a)){var c=this,d=c.getUiTargetDom(a);if(d){d.rules("remove",b);var e=erajs.getUiNameElement(d[0]);e&&(d=e.element),d.removeClass("validate-error"),erajs.hideTipsy(d);var f=d.closest("form");f.length&&f.valid()}}},removeFieldsRules:function(a){var b=this,c=a;erajs.isEmpty(a)||(erajs.isString(a)&&(c=a.split(",")),erajs.isArray(c)&&erajs.Array.each(c,function(a){b.removeFieldRules(a)}))},addFieldRules:function(a,b,c){if(!erajs.isEmpty(a)&&!erajs.isEmpty(b)&&erajs.isObject(b)){var d=this,e=d.getUiTargetDom(a);e&&(c&&e.rules("remove"),e.rules("add",b))}},addFieldsRules:function(a){var b=this;erajs.isEmpty(a)||erajs.Array.each(a,function(a){var c=a.fieldId,d=a.rules,e=a.remove;b.addFieldRules(c,d,e)})},getUiTargetDom:function(a){var b=null;if(!erajs.isEmpty(a))if(erajs.isString(a)){var c="#"+a+",[name='"+a+"']";b=$(c)}else b=a.hasOwnProperty("xtype")?$(a.target):a;return b},getFieldRules:function(a,b){var c=this,d=null,e=c.getFormValidateRules(a);if(!erajs.isEmpty(e)){var f=e.rules;f&&f.hasOwnProperty(b)&&(d=f[b])}return d},getFormValidateRules:function(a){if(erajs.isEmpty(a))return erajs.Extra.showErrorInfo("form name is not null,please check it !"),null;var b=this,c=null,d=b.formValidationOptions.get(a);if(erajs.isEmpty(d)||(c=d),null==c){var e=b.getSpecialFormCfg(a);e&&(c=b.transformValidation(e),c&&b.formValidationOptions.add(a,c))}return c},validateForm:function(a){var b=null;return b=erajs.isString(a)?$("form[name='"+a+"']"):a,b.valid()},getSpecialFormCfg:function(a){var b=this,c=b.formValidationCfgs;return erajs.Array.findBy(c,function(b){return b.name==a?!0:void 0})},transformValidation:function(a){function b(a){var b={},d={};return erajs.each(a,function(a){var e=a.name,f=a.value,g=a.code,h=a.message||"";g&&(h=erajs.getMessage(g,!1)||h);var i=c.ruleTypeList[e];f=void 0!==i?c.transformValue2(f,i):f,b[e]=f,erajs.isEmpty(h)||(d[e]=h)}),{rule:b,message:d}}var c=this,d={},e={},f=a.item;erajs.each(f,function(a){var c=a.name,f=a.rule,g=b(f);d[c]=g.rule,e[c]=g.message});var g={rules:d,messages:e};return erajs.Object.isEmpty(d)?null:g},transformValue2:function(a,b){switch(b){case"boolean":a=Boolean(a);break;case"number":a=Number(a);break;case"array":a=a.split(",")}return a}};erajs.apply(erajs,{showTooltip:function(a,b){erajs.create("tooltip",{target:a,position:"right",content:b,onShow:function(){this.getTip().css({color:"#000",borderColor:"#CC9933",backgroundColor:"#FFFFCC"})},onHide:function(){this.destroy(!1)}})},hideTipsy:function(a,b){b=void 0!=b?b:!1;var c=$(a).tipsy(!0);c&&(b?(c.hide(),c.disable()):c.clearTitle())},categoryUI:{defalut:{types:["default"],getNameElementMap:function(a,b){return{name:b.name,element:$(b)}}},text:{types:["textbox","filebox"],getNameElementMap:function(a,b,c){var d=b.getAttribute("textboxname");return b="textbox"==c?a.textbox.find(".textbox-text"):a.filebox.find(".textbox-text"),{name:d,element:b}}},combo:{types:["combobox","combotree","combogrid","datetimebox","datebox","combo"],getNameElementMap:function(a,b,c){var d=b.getAttribute("comboname"),e="datetimebox"===c?a.datebox.combo.combo[0]:a.combo.combo[0];return b=$(e).find(".textbox-text"),{name:d,element:b}}},numberbox:{types:["numberbox","numberspinner"],getNameElementMap:function(a,b){var c=b.getAttribute("numberboxname");return b=$(a.target),{name:c,element:b}}},other:{types:["slider"],getNameElementMap:function(a,b){var c=b.getAttribute("slidername");return b=a.slider.find(".slider-inner"),{name:c,element:b}}}},getUiNameElement:function(a){var b=this,c=b.categoryUI,d=null,e="default",f=null,g=a.id||a.name,h=erajs.isInstantiate(g);return h&&(f=erajs.getCmp(g),e=f.xtype),erajs.Object.each(c,function(b,c){var g=c.types;return erajs.Array.contains(g,e)?(d=c.getNameElementMap(f,a,e),!1):void 0}),d},loadValidationXml:a(b,"loadValidationXml"),prepareValidateRules:a(b,"prepareValidateRules"),validateForm:a(b,"validateForm"),getUiNameAttribute:function(a){var b=a.name||a.getAttribute("uiname");if(!b){var c=$(a),d=["textboxname","numberboxname"];$.each(d,function(a,d){var e=c.attr(d);return erajs.isEmpty(e)?void 0:(b=e,!1)})}return b}}),erajs.apply(erajs.Extra,{addFieldRules:a(b,"addFieldRules"),addFieldsRules:a(b,"addFieldsRules"),removeFieldRules:a(b,"removeFieldRules"),removeFieldsRules:a(b,"removeFieldsRules")}),$.validator.setDefaults({errorClass:"validate-error",onkeyup:!1,errorPlacement:function(a,c){var d=a.text();if(d){var e=c.tipsy(!0);e?(e.enable(),d!=e.getTitle()&&c.attr("title",d)):(c.attr("title",d),erajs.Extra.showTipsy(c,b.validateDefaultTipCfg)),b.showAllInvalidTip&&(e?e.show():c.tipsy("show"))}},success:function(a,b){erajs.hideTipsy(b)},invalidHandler:function(){return!1}})}(erajs.Function.alias),window.jQuery&&function(a){a.extend({xml2json:function(b,c){function d(b,g){if(!b)return null;{var h="",i=null,j=null;b.nodeType,e(b.localName||b.nodeName),b.text||b.nodeValue||""}b.childNodes&&b.childNodes.length>0&&a.each(b.childNodes,function(a,b){var c=b.nodeType,g=e(b.localName||b.nodeName),j=b.text||b.nodeValue||"";if(8!=c)if(3!=c&&4!=c&&g)i=i||{},i[g]?(i[g].length||(i[g]=f(i[g])),i[g]=f(i[g]),i[g][i[g].length]=d(b,!0),i[g].length=i[g].length):i[g]=d(b);else{if(j.match(/^\s+$/))return;h+=j.replace(/^\s+/,"").replace(/\s+$/,"")}}),b.attributes&&b.attributes.length>0&&(j={},i=i||{},a.each(b.attributes,function(a,b){var c=e(b.name),d=b.value;j[c]=d,i[c]?(i[cnn]=f(i[cnn]),i[c][i[c].length]=d,i[c].length=i[c].length):i[c]=d})),i&&(i=a.extend(""!=h?new String(h):{},i||{}),h=i.text?[i.text||""].concat([h]):h,h&&(i.text=h),h="");var k=i||h;return c&&(h&&(k={}),h=k.text||h||"",h&&(k.text=h),g||(k=f(k))),k}if(!b)return{};var e=function(a){return String(a||"").replace(/-/g,"_")},f=function(b){return a.isArray(b)||(b=[b]),b.length=b.length,b};if("string"==typeof b&&(b=a.text2xml(b)),b.nodeType){if(3==b.nodeType||4==b.nodeType)return b.nodeValue;var g=9==b.nodeType?b.documentElement:b,h=d(g,!0);return b=null,g=null,h}},text2xml:function(b){return a.parseXML(b)}})}(jQuery);